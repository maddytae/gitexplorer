<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
pre {
  font-family:Courier New;
  font-size:10pt;
}

.af_line {
  color: gray;
  text-decoration: none;
}

</style>
<title>Source file</title>
</head>
<body>
<pre>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> pytest</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> sys</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> os</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> tempfile</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> contextlib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> contextmanager</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> warnings </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> catch_warnings</span>

<span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> numpy </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> np</span>

<span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pd</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (Series, DataFrame, Panel, Panel4D, MultiIndex, Int64Index,</span>
<span style="color:#333333;">                    RangeIndex, Categorical, bdate_range,</span>
<span style="color:#333333;">                    date_range, timedelta_range, Index, DatetimeIndex,</span>
<span style="color:#333333;">                    isnull)</span>

<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.compat </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> is_platform_windows, </span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">PY35</span><span style="color:#333333;">, text_type</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.formats.printing </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pprint_thing</span>

<span style="color:#333333;">tables </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">importorskip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables&apos;</span><span style="color:#333333;">)</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.pytables </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> TableIterator</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.pytables </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (HDFStore, get_store, Term, read_hdf,</span>
<span style="color:#333333;">                                PossibleDataLossError, ClosedFileError)</span>

<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pytables </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pytables</span>
<span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas.util.testing </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tm</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.util.testing </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (assert_panel4d_equal,</span>
<span style="color:#333333;">                                 assert_panel_equal,</span>
<span style="color:#333333;">                                 assert_frame_equal,</span>
<span style="color:#333333;">                                 assert_series_equal,</span>
<span style="color:#333333;">                                 set_timezone)</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> concat, Timestamp</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> compat</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.compat </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">, lrange, u</span>
<span style="color:#a71d5d;">from</span><span style="color:#333333;"> distutils.version </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> LooseVersion</span>

<span style="color:#333333;">_default_compressor </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LooseVersion</span><span style="color:#333333;">(tables.__version__) </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;2.2&apos;</span>
<span style="color:#333333;">                       </span><span style="color:#a71d5d;">else</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>


<span style="color:#969896;"># testing on windows/py3 seems to fault</span>
<span style="color:#969896;"># for using compression</span>
<span style="color:#333333;">skip_compression </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">PY3</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> </span><span style="color:#0086b3;">is_platform_windows</span><span style="color:#333333;">()</span>

<span style="color:#969896;"># contextmanager to ensure the file cleanup</span>


<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">safe_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> path </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            os.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>


<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">safe_close</span><span style="color:#333333;">(</span><span style="color:#0086b3;">store</span><span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> store </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>


<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot; create an unopened named temporary file &quot;&quot;&quot;</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(tempfile.</span><span style="color:#0086b3;">gettempdir</span><span style="color:#333333;">(), path)</span>


<span style="color:#333333;">&#64;</span><span style="color:#0086b3;">contextmanager</span>
<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">fletcher32</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">):</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># put in the temporary path if we don&apos;t have one already</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(os.path.</span><span style="color:#0086b3;">dirname</span><span style="color:#333333;">(path)):</span>
<span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">        store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">complevel,</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">complib, </span><span style="color:#0086b3;">fletcher32</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">or</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>


<span style="color:#333333;">&#64;</span><span style="color:#0086b3;">contextmanager</span>
<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot;</span>
<span style="color:#969896;">    return essentially a named temporary file that is not opened</span>
<span style="color:#969896;">    and deleted on existing; if path is a list, then create and</span>
<span style="color:#969896;">    return list of filenames</span>
<span style="color:#969896;">    &quot;&quot;&quot;</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">list</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            filenames </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(p) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> p </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> path]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> filenames</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            filenames </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(path)]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> filenames[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> f </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> filenames:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(f)</span>


<span style="color:#969896;"># set these parameters so we don&apos;t have file sharing</span>
<span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_NUMEXPR_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_BLOSC_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>


<span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_maybe_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">store</span><span style="color:#333333;">, </span><span style="color:#0086b3;">key</span><span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot;For tests using tables, try removing the table to be sure there is</span>
<span style="color:#969896;">    no content from previous tests using the same table name.&quot;&quot;&quot;</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(key)</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>


<span style="color:#a71d5d;">class</span><span style="color:#333333;"> Base(</span>object<span style="color:#333333;">):</span>

<span style="color:#333333;">    &#64;</span><span style="color:#0086b3;">classmethod</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">setup_class</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cls</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Pytables 3.0.0 deprecates lots of things</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">reset_testing_mode</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    &#64;</span><span style="color:#0086b3;">classmethod</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">teardown_class</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cls</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Pytables 3.0.0 deprecates lots of things</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">set_testing_mode</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">setup_method</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">method</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;tmp.__</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">__.h5&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">rands</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">teardown_method</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">method</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>


<span style="color:#333333;">&#64;pytest.mark.</span><span style="color:#0086b3;">single</span>
<span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestHDFStore(</span>Base<span style="color:#333333;">):</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_factory_fun</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;blah&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                    tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(tbl) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> DataFrame</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_context</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;blah&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(tbl) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> DataFrame</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_conv_read_write</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, key, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, key)</span>

<span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">, o))</span>

<span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string_series&apos;</span><span style="color:#333333;">, o))</span>

<span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, o))</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, o))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;index&gt;2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], result)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_long_strings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH6166</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># unconversion of long strings was being chopped in earlier</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># versions of numpy &lt; 1.7.2</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">rands_array</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)},</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">tm.</span><span style="color:#0086b3;">rands_array</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_api</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH4584</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># API issue when to_hdf doesn&apos;t acdept append AND format args</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store._path</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># formats</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invalid</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># File path doesn&apos;t exist</span>
<span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;&quot;</span>
<span style="color:#333333;">        pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(compat.FileNotFoundError,</span>
<span style="color:#333333;">                      read_hdf, path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_api_default_format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># default_format option</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">).is_table</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_keys</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/foo/bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">()) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> expected</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> expected</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_iter_empty</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># GH 12221</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> []</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_repr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">, tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">())</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># make a random group in hdf space</span>
<span style="color:#333333;">            store._handle.</span><span style="color:#0086b3;">create_group</span><span style="color:#333333;">(store._handle.root, </span><span style="color:#183691;">&apos;bah&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># storers</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(s)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(s)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_contains</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/foo/bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/foo/b&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># gh-2694: tables.NaturalNameWarning</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;node())&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;node())&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_versioning</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.a._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.b._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.df1._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># write a file and wipe its versioning</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this is an error because its table_type is appendable, but no</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># version info</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">get_node</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)._v_attrs.pandas_version </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_mode</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">mode</span><span style="color:#333333;">):</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># constructor</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, HDFStore, path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._handle.mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> mode</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># context</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">                            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, f)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._handle.mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> mode</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># conv write</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, df.to_hdf,</span>
<span style="color:#333333;">                                  path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># conv read</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf,</span>
<span style="color:#333333;">                                  path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_default_mode</span><span style="color:#333333;">():</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># read_hdf uses default mode</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">check_default_mode</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_reopen_handle</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invalid mode change</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(PossibleDataLossError, store.open, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># truncation ok here</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># reopen as read</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;r&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># reopen as append</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># reopen as append (again)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_open_args</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># create an in memory store</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">driver</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H5FD_CORE&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">driver_core_backing_store</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># the file should not have actually been written</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">exists</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_flush</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">flush</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">flush</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fsync</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_get</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            left </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            right </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(left, right)</span>

<span style="color:#333333;">            left </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            right </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(left, right)</span>

<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.get, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># test attribute access</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.a</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.df</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># errors</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">, store, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;mode&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;path&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;handle&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">, store, x)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># not stores</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;mode&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;path&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;handle&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&quot;_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo/bar/bah&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># not OK, not a table</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># node does not currently exist, test _is_table_type returns False</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># in this case</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># _maybe_remove(store, &apos;f&apos;)</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># pytest.raises(ValueError, store.put, &apos;f&apos;, df[10:],</span>
<span style="color:#333333;">            </span><span style="color:#969896;">#                   append=True)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t put to a table (use append instead)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># overwrite table</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_string_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&quot;I am a very long string index: </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)])</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>

<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], s)</span>

<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># mixed length</span>
<span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;abcdefghijklmnopqrstuvwxyz1234567890&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span>
<span style="color:#333333;">                          [</span><span style="color:#183691;">&quot;I am a very long string index: </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i</span>
<span style="color:#333333;">                           </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)])</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">21</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], s)</span>

<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_compression</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t compress if format=&apos;fixed&apos;</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_compression_blosc</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">skip_if_no_package</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">min_version</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;2.2&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">app</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc support&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;skipping on windows/PY3&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t compress if format=&apos;fixed&apos;</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complibs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH14478</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Building list of all complibs and complevels tuples</span>
<span style="color:#333333;">        all_complibs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tables.filters.all_complibs</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Remove lzo if its not available on this platform</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> tables.</span><span style="color:#0086b3;">which_lib_version</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;lzo&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            all_complibs.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;lzo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        all_levels </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        all_tests </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(lib, lvl) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> lib </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_complibs </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> lvl </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_levels]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> (lib, lvl) </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_tests:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tmpfile:</span>
<span style="color:#333333;">                gname </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># Write and read file to see if data is consistent</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(tmpfile, gname, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">lib, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">lvl)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(tmpfile, gname)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># Open file and check metadata</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># for correct amount of compression</span>
<span style="color:#333333;">                h5table </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tables.</span><span style="color:#0086b3;">open_file</span><span style="color:#333333;">(tmpfile, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> node </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> h5table.</span><span style="color:#0086b3;">walk_nodes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;/&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> gname,</span>
<span style="color:#333333;">                                               </span><span style="color:#0086b3;">classname</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;Leaf&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> lvl</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> lvl </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complib </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complib </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> lib</span>
<span style="color:#333333;">                h5table.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_integer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># non-date, non-string index</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">50</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_mixed_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this is allowed by almost always don&apos;t want to do it</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># tables.NaturalNameWarning):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># this is allowed by almost always don&apos;t want to do it</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># tables.NaturalNameWarning</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3 foo&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp.iloc[:, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">], wp)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># ndim</span>
<span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># test using axis labels</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># test using differnt number of items on each axis</span>
<span style="color:#333333;">                p4d2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                p4d2[</span><span style="color:#183691;">&apos;l4&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                p4d2[</span><span style="color:#183691;">&apos;l5&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">, p4d2, </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">], p4d2)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># test using differt order of items on the non-index axes</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                wp_append1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp_append1)</span>
<span style="color:#333333;">                wp_append2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.items[::</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp_append2)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">], wp)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># dtype issues - mizxed type in a single object column</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]])</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;mixed_column&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;testing&apos;</span>
<span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;mixed_column&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># uints - test storage of uints</span>
<span style="color:#333333;">                uint_data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u08&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">255</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint8),</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u16&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">65535</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint16),</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint32),</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">58</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">59</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">60</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">61</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">62</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint64)}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">, uint_data)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">], uint_data)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># uints - test storage of uints in indexable columns</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># 64-bit indices not yet supported</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">, uint_data, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                             </span><span style="color:#183691;">&apos;u08&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;u16&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;u32&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">], uint_data)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># basic</span>
<span style="color:#333333;">            ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            ns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">, ss)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ss)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, ts)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ts)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>

<span style="color:#333333;">            ns.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, ns)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ns)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ns.name</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select on the values</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ns[ns </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">60</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&gt;60&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select on the index and values</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ns[(ns </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">70</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (ns.index </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">90</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&gt;70 and index&lt;90&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># multi-index</span>
<span style="color:#333333;">            mi </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            mi[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(mi))</span>
<span style="color:#333333;">            mi[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            mi.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            mi.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> mi.</span><span style="color:#0086b3;">stack</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            s.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.index.</span><span style="color:#0086b3;">droplevel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">], s)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_types</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH5386</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># test storing various index types</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">format</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df))</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">format</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [tm.makeFloatIndex, tm.makeStringIndex,</span>
<span style="color:#333333;">                          tm.makeIntIndex, tm.makeDateIndex]:</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># period index currently broken for table</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># seee GH7796 FIXME</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, tm.makePeriodIndex)</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># check(&apos;table&apos;,tm.makePeriodIndex)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># unicode</span>
<span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.makeUnicodeIndex</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># only support for fixed types (and they have a perf warning)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, check, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_encoding</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> sys.byteorder </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;little&apos;</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;system byteorder is not little&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ascii&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">Term</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ascii&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_latin_encoding</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY2</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">r</span><span style="color:#183691;">&apos;\[</span><span style="color:#333333;">unicode</span><span style="color:#183691;">\]</span><span style="color:#333333;"> is not implemented as a table column</span><span style="color:#183691;">&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">return</span>

<span style="color:#333333;">        values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;EE, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;A\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [np.nan, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;A\xf8\xfc&apos;</span><span style="color:#333333;">, np.nan, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">]]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_try_decode</span><span style="color:#333333;">(</span><span style="color:#0086b3;">x</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;latin-1&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> x.</span><span style="color:#0086b3;">decode</span><span style="color:#333333;">(encoding)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> x</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># not sure how to remove latin-1 from code in python 2 and 3</span>
<span style="color:#333333;">        values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#0086b3;">_try_decode</span><span style="color:#333333;">(x) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> y] </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> y </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> values]</span>

<span style="color:#333333;">        examples </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> []</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> dtype </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">object</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> val </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> values:</span>
<span style="color:#333333;">                examples.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(pandas.</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(val, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dtype))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">s</span><span style="color:#333333;">, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;latin-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">nan_rep</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                s.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, key, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">encoding,</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">nan_rep</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">nan_rep)</span>
<span style="color:#333333;">                retr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, key)</span>
<span style="color:#333333;">                s_nan </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">replace</span><span style="color:#333333;">(nan_rep, np.nan)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s_nan, retr, </span><span style="color:#0086b3;">check_categorical</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> examples:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(s)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># fails:</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># for x in examples:</span>
<span style="color:#333333;">        </span><span style="color:#969896;">#     roundtrip(s, nan_rep=b&apos;\xf8\xfc&apos;)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_some_nans</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;20010101&quot;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)},</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># some nans</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># first column</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df1.loc[:, </span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df1)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># 2nd column</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df2.loc[:, </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df2)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># datetimes</span>
<span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df3.loc[:, </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df3)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_all_nans</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)},</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (dropna=True)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (dropna=False)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># tests the option io.hdf.dropna_table</span>
<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.dropna_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.dropna_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">], df[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (string are still written!)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">},</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (but since we have dates they are still</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># written!)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;20010101&quot;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)},</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Test to make sure defaults are to not drop.</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Corresponding to Issue 9382</span>
<span style="color:#333333;">        df_with_missing </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            {</span><span style="color:#183691;">&apos;col1&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, np.nan, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;col2&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, np.nan]})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df_with_missing.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_with_missing&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reloaded </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_with_missing&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df_with_missing, reloaded)</span>

<span style="color:#333333;">        matrix </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[[np.nan, np.nan, np.nan], [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, np.nan]],</span>
<span style="color:#333333;">                  [[np.nan, np.nan, np.nan], [np.nan, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                  [[np.nan, np.nan, np.nan], [np.nan, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, np.nan]]]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            panel_with_missing </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(matrix,</span>
<span style="color:#333333;">                                       </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item3&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                       </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                       </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                panel_with_missing.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    path, </span><span style="color:#183691;">&apos;panel_with_missing&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                reloaded_panel </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;panel_with_missing&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(panel_with_missing, reloaded_panel)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_frame_column_oriented</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># column oriented</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df.iloc[:, :</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;columns&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df.iloc[:, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># selection on the non-indexable</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, (</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index=df.index[0:4]&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this isn&apos;t supported</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                             </span><span style="color:#183691;">&apos;columns=A and index&gt;df.index[4]&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_different_block_ordering</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 4096; using same frames, but different block orderings</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+=</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                    df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">3</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    a </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">pop</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> a</span>

<span style="color:#333333;">                df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># test a different ordering but with more fields (like invalid</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># combinate)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># store additonal fields in different blocks</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int16_2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># store multile additonal fields in different blocks</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;float_3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_ndim_indexables</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># test using ndim tables in new ways</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">indexers</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i, idx </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">enumerate</span><span style="color:#333333;">(indexers):</span>
<span style="color:#333333;">                        descr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.root, key).table.description</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(descr, idx)._v_pos </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> i</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># append then change (will take existing schema)</span>
<span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">), p4d)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># same as above, but try to append with differnt axes</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">), p4d)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># pass incorrect number of axes</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[</span>
<span style="color:#333333;">                    :, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># different than default indexables #1</span>
<span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># different than default indexables #2</span>
<span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># partial selection</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;labels=l1&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># partial selection2</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;labels=&apos;l1&apos; and items=&apos;ItemA&apos; and minor_axis=&apos;B&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># non-existant partial selection</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;labels=&apos;l1&apos; and items=&apos;Item1&apos; and minor_axis=&apos;B&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[],</span>
<span style="color:#333333;">                                       </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_strings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                wp2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">rename_axis</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">([(x, </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_extra&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> wp.minor_axis]), </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#333333;">                                   .table.description, name).itemsize </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> size</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([wp, wp2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">sorted</span><span style="color:#333333;">(expected.minor_axis))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">], expected)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># test dict format</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([wp, wp2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">sorted</span><span style="color:#333333;">(expected.minor_axis))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">], expected)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># apply the wrong field (similar to #1)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;s3&apos;</span><span style="color:#333333;">, wp2)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># test truncation of bigger strings</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s4&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;s4&apos;</span><span style="color:#333333;">, wp2)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># avoid truncation on elements</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">123</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqwerty&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">345</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhebbsdfbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">15</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># appending smaller string ok</span>
<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">124</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqy&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">346</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhefbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">), expected)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">15</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># avoid truncation on elements</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">123</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqwerty&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">345</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhebbsdfbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">50</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">50</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># bigger string on next append</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_new&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    [[</span><span style="color:#0086b3;">124</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;abcdefqhij&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">346</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;abcdefghijklmnopqrtsuvwxyz&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_new&apos;</span><span style="color:#333333;">, df_new)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># min_itemsize on Series index (GH 11412)</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeMixedDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">4</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">), df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># same as above, with data_columns=True</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">4</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss2&apos;</span><span style="color:#333333;">), df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># min_itemsize in index without appending (GH 10381)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># just make sure there is a longer string:</span>
<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">().</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">().</span><span style="color:#0086b3;">assign</span><span style="color:#333333;">(</span><span style="color:#0086b3;">C</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;longer&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                      pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2]))</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># same as above, with a Series</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                       pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]))</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># with nans</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bah&apos;</span>
<span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:, </span><span style="color:#183691;">&apos;string3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#333333;">                               .table.description, name).itemsize, size</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column2</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column2</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                         </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_0&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># infer the .typ on subsequent appends</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invalid min_itemsize keys</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foobar&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_to_hdf_with_min_itemsize</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># min_itemsize in index with to_hdf (GH 10381)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeMixedDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># just make sure there is a longer string:</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">().</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">().</span><span style="color:#0086b3;">assign</span><span style="color:#333333;">(</span><span style="color:#0086b3;">C</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;longer&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                  pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2]))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># same as above, with a Series</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                   pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]))</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_data_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># check that we have indicies created</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(store._handle.root.df.table.cols.index.is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(store._handle.root.df.table.cols.B.is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># data column searching</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># data column searching (with an indexable and a data_columns)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0 and index&gt;df.index[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[df_new.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># data column selection with a string data_column</span>
<span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df_new.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df_new.loc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;string=&apos;foo&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># using min_itemsize and a data column</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#333333;">                               .table.description, name).itemsize </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> size</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah&apos;</span>
<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string_block1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah1&apos;</span>
<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string_block2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah2&apos;</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">40</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                       </span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">50</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">50</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># multiple data columns</span>
<span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1.</span>
<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>

<span style="color:#333333;">            sl </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>

<span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            sl </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#183691;">&quot;string=&apos;foo&apos; and string2=&apos;foo&apos;&quot;</span>
<span style="color:#333333;">                                  </span><span style="color:#183691;">&quot; and A&gt;0 and B&lt;0&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[(df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#333333;">                df_new.string2 </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_new.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_new.B </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># yield an empty frame</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;string=&apos;foo&apos; and string2=&apos;cool&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[(df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#333333;">                df_new.string2 </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># doc example</span>
<span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span>
<span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc.</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, df_dc,</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                       </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;B &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string == foo&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[(df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_dc.C </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#333333;">                df_dc.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># doc example part 2</span>
<span style="color:#333333;">            np.random.</span><span style="color:#0086b3;">seed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1234</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">8</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            df_dc.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">]].</span><span style="color:#0086b3;">abs</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># on-disk operations</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, df_dc, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                         </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;B &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string == &quot;foo&quot;&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[(df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_dc.C </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#333333;">                             (df_dc.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># GH5717 not handling data_columns</span>
<span style="color:#333333;">                np.random.</span><span style="color:#0086b3;">seed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1234</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1&apos;</span><span style="color:#333333;">, p)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1&apos;</span><span style="color:#333333;">), p)</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, p, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">), p)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ItemA&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), expected)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ItemA&gt;0 &amp; minor_axis=[&quot;A&quot;,&quot;B&quot;]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">level</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major&apos;</span><span style="color:#333333;">]).index.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_create_table_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">t</span><span style="color:#333333;">, </span><span style="color:#0086b3;">column</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(t).table.cols, column)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># index=False</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># index=True</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># default optlevels</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">create_index</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">6</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># let&apos;s change the indexing scheme</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">6</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">optlevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;full&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;full&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">optlevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;light&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;light&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># data columns</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># specify index=columns</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># try to index a non-table</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.create_table_index, </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_diff_item_order</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            wp1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            wp2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[wp.items.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;ItemC&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">]),</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :]</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp1, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp2,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_hierarchical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># GH 3748</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test.hdf&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_column_multiindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 4710</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># recreate multi-indexes properly</span>

<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">([(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">), (</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                        (</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">), (</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)],</span>
<span style="color:#333333;">                                       </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;first&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;second&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(expected.index, RangeIndex):</span>
<span style="color:#333333;">            expected.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Int64Index</span><span style="color:#333333;">(expected.index)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># appending multi-column on existing table (see GH 6167)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">((df, df)))</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># non_index_axes name</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(expected.index, RangeIndex):</span>
<span style="color:#333333;">            expected.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Int64Index</span><span style="color:#333333;">(expected.index)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_multiindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># validate multi-index names</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 5527</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">make_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">([(datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">12</span><span style="color:#333333;">, d),</span>
<span style="color:#333333;">                                                s, t)</span>
<span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> d </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">)],</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">names)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># no names</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">())</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># partial names</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># series</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            xp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;level_1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;level_2&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">), xp)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># dup with column</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># dup within level</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># fully names</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_columns_in_where</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 6169</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># recreate multi-indexes when columns is passed</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># in the `where` argument</span>
<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo_name&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar_name&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># With a DataFrame</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]), expected)</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">), expected)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># With a Series</span>
<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                   </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">), s)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_mi_data_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 14435</span>
<span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.MultiIndex.</span><span style="color:#0086b3;">from_arrays</span><span style="color:#333333;">([</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                         </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)], </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;id&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.5</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;id == 1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(actual, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pass_spec_to_storer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[(</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_misc</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># unsuported data types for non-tables</span>
<span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># unsuported data types</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;123&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">123</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>

<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">expectedrows</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># more chunksize in append tests</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1000</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, obj, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(result, obj)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;time1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;time2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(p, assert_panel_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(p4d, assert_panel4d_equal)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># empty frame, GH4273</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># 0 len</span>
<span style="color:#333333;">            df_empty </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_empty)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># repeated append of 0/non-zero frames</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_empty)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># store</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># 0 len</span>
<span style="color:#333333;">                p_empty </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># repeated append of 0/non-zero frames</span>
<span style="color:#333333;">                p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">), p)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">), p)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># store</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">), p_empty)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_raise</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># test append with invalid input to get good error messages</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># list in column</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.dtypes[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.object_</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># multiple invalid columns</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># datetime with embedded nans as object</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index)</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#0086b3;">object</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            s[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.dtypes[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.object_</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># directy ndarray</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># series directly</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># appending an incompatible table</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_index_incompatible_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]},</span>
<span style="color:#333333;">                        </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df2,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_values_dtypes_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_f8&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df1.dtypes, store[</span><span style="color:#183691;">&apos;df_f8&apos;</span><span style="color:#333333;">].dtypes)</span>

<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;i8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df2.dtypes, store[</span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">].dtypes)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># incompatible dtype</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">, df1)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># check creation/storage/retrieval of float32 (a bit hacky to</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># actually create them thought)</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f4&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_f4&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df1.dtypes, store[</span><span style="color:#183691;">&apos;df_f4&apos;</span><span style="color:#333333;">].dtypes)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df1.dtypes[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;float32&apos;</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># check with mixed dtypes</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">([(c, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c))</span>
<span style="color:#333333;">                                  </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int8&apos;</span><span style="color:#333333;">]]))</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1[</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;time1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;time2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_mixed_dtypes1&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_mixed_dtypes1&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">get_dtype_counts</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                               </span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int8&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                               </span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime64[ns]&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">2</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.</span><span style="color:#0086b3;">sort_index</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">sort_index</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_mixed_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># frame</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1_mixed&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1_mixed&apos;</span><span style="color:#333333;">), df)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># panel</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1_mixed&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1_mixed&apos;</span><span style="color:#333333;">), wp)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># ndim</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;l2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d_mixed&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d_mixed&apos;</span><span style="color:#333333;">), wp)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unimplemented_dtypes_table_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            l </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">))]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># py3 ok for unicode</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                l.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">((</span><span style="color:#183691;">&apos;unicode&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\\u03c3&apos;</span><span style="color:#333333;">)))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># currently not supported dtypes ####</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> n, f </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> l:</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                df[n] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> f</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df1_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> n, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># frame</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># this fails because we have a date in the object block......</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_unimplemented&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_calendar_roundtrip_issue</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># 8591</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># doc example from tseries holiday section</span>
<span style="color:#333333;">        weekmask_egypt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;Sun Mon Tue Wed Thu&apos;</span>
<span style="color:#333333;">        holidays </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;2012-05-01&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                    datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), np.</span><span style="color:#0086b3;">datetime64</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-05-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">        bday_egypt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pandas.offsets.</span><span style="color:#0086b3;">CustomBusinessDay</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">holidays</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">holidays, </span><span style="color:#0086b3;">weekmask</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">weekmask_egypt)</span>
<span style="color:#333333;">        dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        dts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(dt, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">bday_egypt)</span>

<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(dts.weekday, dts).</span><span style="color:#0086b3;">map</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;Mon Tue Wed Thu Fri Sat Sun&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">split</span><span style="color:#333333;">())))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 3577</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># append timedelta</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">days</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">i, </span><span style="color:#0086b3;">seconds</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)]))</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;C&lt;100000&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;C&lt;pd.Timedelta(&apos;-3D&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-3D&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a bit hacky here as we don&apos;t really deal with the NaT properly</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-500000s&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.</span><span style="color:#0086b3;">dropna</span><span style="color:#333333;">(</span><span style="color:#0086b3;">subset</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">6</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-3.5D&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># fixed</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># nonexistence</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.remove, </span><span style="color:#183691;">&apos;a_nonexistent_store&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># pathing</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>

<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># __delitem__</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_where</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># non-existance</span>
<span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;index&gt;foo&apos;</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.remove, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, [crit1])</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># try to remove non-table (with crit)</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># non-table ok (where = None)</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                rs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(rs, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># empty where</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># deleted number (entire table)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># non - empty where</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.remove,</span>
<span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_startstop</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH #4835 and #6177</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># start</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[:</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># stop</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># start n stop</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">16</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(wp.major_axis[:</span><span style="color:#0086b3;">16</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                                .</span><span style="color:#0086b3;">union</span><span style="color:#333333;">(wp.major_axis[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">16</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># with where</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># TODO: unused?</span>
<span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis.</span><span style="color:#0086b3;">take</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">))  </span><span style="color:#969896;"># noqa</span>

<span style="color:#333333;">                crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit], </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">80</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">28</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    wp.major_axis[np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">)]))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_crit</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># group row removal</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                date4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis.</span><span style="color:#0086b3;">take</span><span style="color:#333333;">([</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                crit4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date4&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit4])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">36</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date4))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># upper half</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(wp.major_axis) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>

<span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis&gt;date&apos;</span>
<span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit1])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">56</span>

<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit2])</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">date).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># individual row elements</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                date1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date1&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit1])</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                date2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date2&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit2])</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(wp.major_axis</span>
<span style="color:#333333;">                                .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1)</span>
<span style="color:#333333;">                                .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([date2]))</span>
<span style="color:#333333;">                                ))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                date3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [wp.major_axis[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">], wp.major_axis[</span><span style="color:#0086b3;">9</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">                crit3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date3&apos;</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit3])</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis</span>
<span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1)</span>
<span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([date2]))</span>
<span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(date3)))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># corners</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;major_axis&gt;wp.major_axis[-1]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, wp)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_terms</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># some invalid terms</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;minor=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&quot;index=[&apos;20121114&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&quot;index=[&apos;20121114&apos;, &apos;20121114&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, Term)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># more invalid</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df.index[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">SyntaxError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; &amp; minor_axis[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># from the docs</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            dfq </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            dfq.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># check ok</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                     </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;index&gt;Timestamp(&apos;20130104&apos;) &amp; columns=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;A&gt;0 or C&gt;0&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># catch the invalid reference</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            dfq </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            dfq.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;A&gt;0 or C&gt;0&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_terms</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                wpneg </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> Panel.</span><span style="color:#0086b3;">fromDict</span><span style="color:#333333;">({</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">(),</span>
<span style="color:#333333;">                                        </span><span style="color:#0086b3;">0</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">(),</span>
<span style="color:#333333;">                                        </span><span style="color:#0086b3;">1</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()})</span>
<span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, wpneg, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># with deprecation</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; &quot;</span>
<span style="color:#333333;">                                 </span><span style="color:#183691;">&quot;and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># p4d</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                      (</span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; and &quot;</span>
<span style="color:#333333;">                                       </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;] and &quot;</span>
<span style="color:#333333;">                                       </span><span style="color:#183691;">&quot;items=[&apos;ItemA&apos;, &apos;ItemB&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># valid terms</span>
<span style="color:#333333;">                terms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#183691;">&apos;major_axis=20121114&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;major_axis&gt;20121114&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;major_axis=[&apos;20121114&apos;, &apos;20121114&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;major_axis=datetime.datetime(2012, 11, 14)&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis&gt; 20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis &gt;20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis &gt; 20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#333333;">                         (((</span><span style="color:#183691;">&quot;minor_axis==[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),),</span>
<span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;items=[&apos;ItemA&apos;, &apos;ItemB&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;items=ItemA&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         ]</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> terms:</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, t)</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, t)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># valid for p4d only</span>
<span style="color:#333333;">                terms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&quot;labels=[&apos;l1&apos;, &apos;l2&apos;]&quot;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> terms:</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, t)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Only named functions are supported&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;major_axis == (lambda x: x)(&quot;20130101&quot;)&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># check USub node parsing</span>
<span style="color:#333333;">                res </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items == -1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">: wpneg[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(res, expected)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;Unary addition &apos;</span>
<span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;not supported&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items == +1&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_term_compat</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;major_axis&gt;20000102 &quot;</span>
<span style="color:#333333;">                                 </span><span style="color:#183691;">&quot;and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">), [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;20000103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000103&apos;</span><span style="color:#333333;">), :]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># stringified datetimes</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;datetime.datetime(2000, 1, 2)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;datetime.datetime(2000, 1, 2)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis=[datetime.datetime(2000, 1, 2, 0, 0), &quot;</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&quot;datetime.datetime(2000, 1, 3, 0, 0)]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, [</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                      </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000103&apos;</span><span style="color:#333333;">)]]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, :, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_same_name_scoping</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pd</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130105&apos;</span><span style="color:#333333;">)]</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime.datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime  </span><span style="color:#969896;"># noqa</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># technically an error, but allow it</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime.datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>

<span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts, tm.assert_series_equal)</span>

<span style="color:#333333;">        ts2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts2, tm.assert_series_equal)</span>

<span style="color:#333333;">        ts3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(ts.values, </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">asarray</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                      </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts3, tm.assert_series_equal,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss, tm.assert_series_equal,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        ss2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;integer&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss2, tm.assert_series_equal,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        ss3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss3, tm.assert_series_equal,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">8</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        ss2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;integer&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss2, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        ss3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss3, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_float_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH #454</span>
<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tuple_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH #492</span>
<span style="color:#333333;">        col </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#0086b3;">0.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.</span><span style="color:#333333;">), (</span><span style="color:#0086b3;">2.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">), (</span><span style="color:#0086b3;">4.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5.</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">        data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">((</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#0086b3;">DF</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(data, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">DF</span><span style="color:#333333;">, tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_index_types</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            func </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">l</span><span style="color:#333333;">, </span><span style="color:#0086b3;">r</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(l, r,</span>
<span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.datetime.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.date.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.datetime.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.date.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1.23</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.53</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)])</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_timeseries_preepoch</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> sys.version_info[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> sys.version_info[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;won&apos;t work on Python &lt; 2.7&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        dr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/1940&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/1/1960&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(dr)), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dr)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts, tm.assert_series_equal)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">OverflowError</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;known failer on some windows platforms&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># put in some random NAs</span>
<span style="color:#333333;">        df.values[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        df.values[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip_table</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip_table</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                        </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        tdf </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(tdf, tm.assert_frame_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(tdf, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># not consolidated</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df))</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> recons._data.</span><span style="color:#0086b3;">is_consolidated</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># empty</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df[:</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_empty_series_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        s0 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        s1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;myseries&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df0 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s0, tm.assert_series_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s1, tm.assert_series_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df0, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df2, tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_empty_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> dtype </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [np.int64, np.float64, np.object, </span><span style="color:#183691;">&apos;m8[ns]&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;M8[ns]&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dtype)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_can_serialize_dates</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [x.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">() </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame, tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_hierarchical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame.T, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># check that the names are stored</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> frame</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, frame)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name_with_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 13884</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1234567890123456787</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1234567890123456788</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index.</span><span style="color:#0086b3;">tz_localize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, df)</span>

<span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">parametrize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table_format&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name_numpy_str</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">table_format</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH #13492</span>
<span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">to_datetime</span><span style="color:#333333;">([datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                       datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)]),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;cols\u05d2&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        idx1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">to_datetime</span><span style="color:#333333;">([datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2010</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                        datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2010</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)]),</span>
<span style="color:#333333;">                        </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;rows\u05d0&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx1)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># This used to fail, returning numpy strings instead of python strings.</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">table_format)</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, df2, </span><span style="color:#0086b3;">check_names</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(df2.index.name) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> text_type</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(df2.columns.name) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> text_type</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_series_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> series</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(recons, series)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_mixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_make_one</span><span style="color:#333333;">():</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">_make_one</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">_make_one</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df2, tm.assert_frame_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">], df1)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">], df2)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># check that can store Series of all of these types</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_wide</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(wp, assert_panel_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_with_dups</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># single dtypes</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101 9:30&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;T&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.columns)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># dups accross dtypes</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                               </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]),</span>
<span style="color:#333333;">                     </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                               .</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                               </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])],</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101 9:30&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;T&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.columns)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># duplicates on both index and columns</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([expected, expected])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_wide_table_dups</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(recons, wp)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_long</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">left</span><span style="color:#333333;">, </span><span style="color:#0086b3;">right</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(left.</span><span style="color:#0086b3;">to_panel</span><span style="color:#333333;">(), right.</span><span style="color:#0086b3;">to_panel</span><span style="color:#333333;">())</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(wp.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), _check)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_longpanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_overwrite_node</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], ts)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_with_compression</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 2931</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># make sparse dataframe</span>
<span style="color:#333333;">        arr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">binomial</span><span style="color:#333333;">(</span><span style="color:#0086b3;">n</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">p</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">.01</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(arr).</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># case 1: store uncompressed</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># case 2: store compressed (works)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># set one series to be completely sparse</span>
<span style="color:#333333;">        df[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># case 3: store df with completely sparse series uncompressed</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># case 4: try storing df with completely sparse series compressed</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># (fails)</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># put/select ok</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># non-table ok (where = None)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># selection on the non-indexable with a large number of columns</span>
<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;E</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)])</span>

<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#333333;">                items </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;Item</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">80</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items=items&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">items)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># selectin non-table with a where</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># pytest.raises(ValueError, store.select,</span>
<span style="color:#333333;">                </span><span style="color:#969896;">#                  &apos;wp2&apos;, (&apos;column&apos;, [&apos;A&apos;, &apos;D&apos;]))</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># select with columns=</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># equivalentsly</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [(</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># with a data column</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># all a data columns</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># with a data column, but different columns</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># with a Timestamp data column (GH #2637)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">ts</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># bool columns (GH #2849)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[df.boolv </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">]  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">                        .</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;true&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv == </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(v),</span>
<span style="color:#333333;">                                      </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[df.boolv </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">]  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">                        .</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;false&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv == </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(v), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># integer index</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&lt;10 and columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(df.index)[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># float index</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f8&apos;</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&lt;10.0 and columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(df.index)[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># floats w/o NaN</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># floats with NaN</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># https://github.com/PyTables/PyTables/issues/282</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># bug in selection when 0th row has a np.nan and an index</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># store.append(&apos;df3&apos;,df,data_columns=True)</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># result = store.select(</span>
<span style="color:#333333;">            </span><span style="color:#969896;">#    &apos;df3&apos;, where=&apos;values&gt;2.0&apos;)</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># tm.assert_frame_equal(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># not in first position float with NaN ok too</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># test selection with comparison against numpy scalar</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 11283</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            np_zero </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">float64</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&quot;A&gt;np_zero&quot;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_with_many_inputs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ts</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">users</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">50</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">50</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span>
<span style="color:#333333;">                                [</span><span style="color:#183691;">&apos;a</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]))</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;users&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># regular select</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># small selector</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;) &amp; users=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#333333;">                          df.users.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># big selector along the columns</span>
<span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;a</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">60</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;) and users=selector&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#333333;">                          df.users.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B=selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.B.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># big selector along the index</span>
<span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(df.ts[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">100</span><span style="color:#333333;">].values)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ts=selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector.values)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># single table</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">150</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># multiple</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">).</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># full selection</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">150</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_complete_8014</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause</span>
<span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1e4</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># no iterator</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>

<span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iteration and no where clause works</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, single term, begin</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># of range, works</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, single term, end</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># of range, works</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, inclusive range,</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># works</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, full range</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>

<span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and no where clause works</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_non_complete_8014</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause</span>
<span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1e4</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, non complete range</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>

<span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#333333;">                                 (expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, empty where</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>

<span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt; &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_many_empty_frames</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause can return many empty</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># frames.</span>
<span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">int</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1e4</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, range limited to the first chunk</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100000</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>

<span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[chunksize </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># should be 1, is 10</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#333333;">                                 (expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause which selects</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># *nothing*.</span>
<span style="color:#333333;">            </span><span style="color:#969896;">#</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># To be consistent with Python idiom I suggest this should</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># return [] e.g. `for e in []: print True` never prints</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># True.</span>

<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># should be []</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_retain_index_attributes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 3499, losing frequency info on index recreation</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                     </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">))))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> attr </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;freq&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;tz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;name&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> idx </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;columns&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> (</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(df, idx), attr, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">==</span>
<span style="color:#333333;">                            </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(result, idx), attr, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">))</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># try to append a table with a different frequency</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, df2)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).info[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">][</span><span style="color:#183691;">&apos;freq&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010101&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20020101&apos;</span><span style="color:#333333;">)])))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                          </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df3)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_retain_index_attributes2</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#333333;">                df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                idx.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)))</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).index.name </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                idx2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2001-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                idx2.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx2)))</span>
<span style="color:#333333;">                df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).index.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_panel_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(wp.major_axis) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>

<span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;major_axis&gt;=date&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [crit1, crit2])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">before</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">date).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;major_axis&gt;=&quot;20000124&quot;&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                           (</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)])</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">before</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000124&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Term</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;index&gt;=date&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> crit1.env.scope[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> date</span>

<span style="color:#333333;">            crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            crit3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit1, crit2])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[date:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit3])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invalid terms</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_time&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df_time&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&gt;0&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t select if not written as table</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># store[&apos;frame&apos;] = df</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># pytest.raises(ValueError, store.select,</span>
<span style="color:#333333;">            </span><span style="color:#969896;">#                  &apos;frame&apos;, [crit1, crit2])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select_complex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># select via complex criteria</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">        df.loc[df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># empty</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] &amp; string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] &amp; string=&quot;foo&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># or</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] | string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">|</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;(index&gt;df.index[3] &amp; &apos;</span>
<span style="color:#333333;">                                  </span><span style="color:#183691;">&apos;index&lt;=df.index[6]) | string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[((df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#333333;">                df.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">6</span><span style="color:#333333;">])) </span><span style="color:#a71d5d;">|</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invert</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string!=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[df.string </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invert not implemented in numexpr :(</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;~(string=&quot;bar&quot;)&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invert ok for filters</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;~(columns=[&apos;A&apos;,&apos;B&apos;])&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, df.columns.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># in</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&gt;df.index[3] &amp; columns in [&apos;A&apos;,&apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                                                              </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select_complex2</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;parms.hdf&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;hist.hdf&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> paths:</span>

<span style="color:#333333;">            pp, hh </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> paths</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># use non-trivial selection criteria</span>
<span style="color:#333333;">            parms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">            parms.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(pp, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                         </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            selection </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(pp, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A=[2,3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            hist </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">25</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                                 [(i, j) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                                  </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> j </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)],</span>
<span style="color:#333333;">                                 </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;l2&apos;</span><span style="color:#333333;">]))</span>

<span style="color:#333333;">            hist.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=[2, 3, 4]&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># sccope with list like</span>
<span style="color:#333333;">            l </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> selection.index.</span><span style="color:#0086b3;">tolist</span><span style="color:#333333;">()  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(hh)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=l&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=l&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># index</span>
<span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> selection.index  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index.tolist()&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=list(selection.index)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># sccope with index</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(hh)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index.tolist()&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=list(selection.index)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_filtering</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># can&apos;t use more than one filter (atm)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># not implemented</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;] | columns=[&apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># in theory we could deal with this</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;,&apos;B&apos;] &amp; columns=[&apos;C&apos;]&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_string_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 2973</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># test string ==/!=</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&apos;</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.x </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x!=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.x </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Exception</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> detail:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;[{</span><span style="color:#0086b3;">0</span><span style="color:#183691;">}]&quot;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(detail))</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(expected)</span>

<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df2.loc[df2.x </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x!=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2[</span><span style="color:#0086b3;">isnull</span><span style="color:#333333;">(df2.x)]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># int ==/!=</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int=2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.int </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int!=2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.int </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_column</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># error</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_column, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;index&gt;5&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, f)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># valid</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(df.index).values)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(result, Series)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># not a data indexable column</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select_column, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_0&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a data column</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df2[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># a data column with NaNs, result excludes the NaNs</span>
<span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#333333;">            df3.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># start/stop</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># GH 10392 - make sure column name is preserved</span>
<span style="color:#333333;">            df4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">})</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df4, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df4[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_coordinates</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># all</span>
<span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df.index))).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># get coordinates back &amp; test vs frame</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;index&lt;3&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;index&gt;=3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&lt;=4&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">3</span><span style="color:#333333;">).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(c, Index)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># multiple tables</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>

<span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            df1_result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, c)</span>
<span style="color:#333333;">            df2_result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, c)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1_result, df2_result], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (expected.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># pass array/mask as the coordinates</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> c[</span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">(c).month </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span><span style="color:#333333;">].index</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[where]</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># locations</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># boolean</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># invalid</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)), </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)), </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># selection with filter</span>
<span style="color:#333333;">            selection </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;index in selection&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.index.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selection)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># list</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># boolean</span>
<span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">True</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span>
<span style="color:#333333;">            where[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[where]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># start/stop</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">        df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># exceptions</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple,</span>
<span style="color:#333333;">                          {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple,</span>
<span style="color:#333333;">                          {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># regular operation</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple_dropna</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">        df1.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, df1.columns.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># dropna=True should guarantee rows are synchronized</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">dropna</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_index_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">).index,</span>
<span style="color:#333333;">                                  store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">).index)</span>

<span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">run</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;append_to_multiple_dropna_false &quot;</span>
<span style="color:#333333;">                       </span><span style="color:#183691;">&quot;is not raising as failed&quot;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple_dropna_false</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">        df1.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, df1.columns.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># dropna=False shouldn&apos;t synchronize row indexes</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">).index.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">).index)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_as_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#333333;">        df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># no tables stored</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># exceptions</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          [</span><span style="color:#0086b3;">None</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># default select</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># multiple</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (expected.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># multiple (diff selector)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;index&gt;df2.index[4]&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># test excpection for diff rows</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">nper</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">50</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_nan_selection_bug_4858</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 4858; nan selection bug, only works for pytables &gt;= 3.1</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LooseVersion</span><span style="color:#333333;">(tables.__version__) </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;3.1.0&apos;</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables version does not support fix for nan &apos;</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;selection bug: GH 4858&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">6</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">6</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;13.0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;14.0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;15.0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                                 </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5.</span><span style="color:#333333;">]), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># write w/o the index on that particular column</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># out of range</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">30</span><span style="color:#333333;">:</span><span style="color:#0086b3;">40</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH 16209</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;foo&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&quot;bar&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]})</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df,</span>
<span style="color:#333333;">                                     </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                              </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># fixed, GH 8287</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># out of range</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">30</span><span style="color:#333333;">:</span><span style="color:#0086b3;">40</span><span style="color:#333333;">, :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># series</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.A</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># sparse; not implemented</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">8</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#333333;">            dfs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dfs&apos;</span><span style="color:#333333;">, dfs)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dfs&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_filter_corner</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">50</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;</span><span style="color:#0086b3;">%.3d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> df.index]</span>
<span style="color:#333333;">        df.columns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;</span><span style="color:#0086b3;">%.3d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> df.columns]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;columns=df.columns[:75]&apos;</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.loc[:, df.columns[:</span><span style="color:#0086b3;">75</span><span style="color:#333333;">]])</span>

<span style="color:#333333;">            crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;columns=df.columns[:75:2]&apos;</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.loc[:, df.columns[:</span><span style="color:#0086b3;">75</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_pathlib</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;pathlib currently doesnt work with HDFStore&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_pathlib_hdfstore</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">writer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">reader</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(writer, reader)</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pickle_path_localpath</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;localpath currently doesnt work with HDFStore&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_localpath_hdfstore</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">writer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">reader</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_localpath</span><span style="color:#333333;">(writer, reader)</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> _default_compressor</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> obj</span>
<span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_double_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> compression </span><span style="color:#a71d5d;">or</span><span style="color:#333333;"> _default_compressor</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> obj</span>
<span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> retrieved</span>
<span style="color:#333333;">            again </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(again, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_roundtrip_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> _default_compressor</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, obj, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_multiple_open_close</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># gh-4409: open &amp; close multiple times</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># single</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> pytables._table_file_open_policy_is_strict:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># multiples</span>
<span style="color:#333333;">                store1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, f)</span>
<span style="color:#333333;">                store1.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># multiples</span>
<span style="color:#333333;">                store1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store2.is_open</span>

<span style="color:#333333;">                store1.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store2.is_open</span>

<span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># nested close</span>
<span style="color:#333333;">                store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">                store2.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>

<span style="color:#333333;">                store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># double closing</span>
<span style="color:#333333;">                store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>

<span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># ops on a closed store</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.keys)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: store.df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.get, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.append, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.put, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.get_storer, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.remove, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#183691;">&apos;file is not open&apos;</span><span style="color:#333333;">, f)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pytables_native_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/pytables_native.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            d2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;detector/readout&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(d2, DataFrame)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pytables_native2_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># fails on win/3.5 oddly</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">PY35</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> </span><span style="color:#0086b3;">is_platform_windows</span><span style="color:#333333;">():</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;native2 read fails oddly on windows / 3.5&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/pytables_native2.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            d1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;detector&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(d1, DataFrame)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_table_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># legacy table types</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/legacy_table.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># force the frame</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">typ</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;legacy_frame&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># old version warning</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis=B&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df2.index[2]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2[df2.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df2.index[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_0_10_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># legacy from 0.10</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/legacy_0.10.h5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> k </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(k)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_0_11_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># legacy from 0.11</span>
<span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;legacy_table_0.11.h5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(path), </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            mi </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(df, DataFrame)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(df1, DataFrame)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(mi, DataFrame)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">new_f</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                        </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> f </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        f </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                                          </span><span style="color:#183691;">&apos;legacy_0.10.h5&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">                    store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(f, </span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> new_f </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> tempfile</span>
<span style="color:#333333;">                        fd, new_f </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tempfile.</span><span style="color:#0086b3;">mkstemp</span><span style="color:#333333;">()</span>

<span style="color:#333333;">                    tstore </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        new_f, </span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">keys, </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">propindexes, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>

<span style="color:#333333;">                    </span><span style="color:#969896;"># check keys</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> keys </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        keys </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(keys) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(tstore.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">())</span>

<span style="color:#333333;">                    </span><span style="color:#969896;"># check indicies &amp; nrows</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> k </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">():</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k).is_table:</span>
<span style="color:#333333;">                            new_t </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k)</span>
<span style="color:#333333;">                            orig_t </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k)</span>

<span style="color:#333333;">                            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> orig_t.nrows </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> new_t.nrows</span>

<span style="color:#333333;">                            </span><span style="color:#969896;"># check propindixes</span>
<span style="color:#333333;">                            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> propindexes:</span>
<span style="color:#333333;">                                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> a </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> orig_t.axes:</span>
<span style="color:#333333;">                                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> a.is_indexed:</span>
<span style="color:#333333;">                                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> new_t[a.name].is_indexed</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(tstore)</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        os.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">(fd)</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(new_f)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/df1_mixed&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># new table</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#333333;">                st </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">                st.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">                st.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">path)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">path, </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_table_write</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;cannot write legacy tables&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#183691;">&apos;legacy_hdf/legacy_table_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">.h5&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> pandas.__version__), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>

<span style="color:#333333;">        store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_datetime_fractional_secs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">123456</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], [dt])</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> series</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">].index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> dt</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_indices_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDateIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx)), idx)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ser</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ser)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ser.index.freq</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, ser.index, </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;series index&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePeriodIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx)), idx)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ser</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ser)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ser.index.freq</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, ser.index, </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;series index&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_indices_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDateIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx), </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> df.index.freq</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, df.index,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;dataframe index&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePeriodIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx), </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), idx)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> df.index.freq</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, df.index,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;dataframe index&quot;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unicode_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        unicode_values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\u03c3&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\u03c3\u03c3&apos;</span><span style="color:#333333;">)]</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(unicode_values)), unicode_values)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unicode_longer_encoded</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 11234</span>
<span style="color:#333333;">        char </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;\u0394&apos;</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [char]})</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;utf-8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, char], </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;utf-8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_datetime_mixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            {</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts.index[:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]</span>
<span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>

<span style="color:#333333;">    </span><span style="color:#969896;"># def test_cant_write_multiindex_table(self):</span>
<span style="color:#333333;">    </span><span style="color:#969896;">#    # for now, #1848</span>
<span style="color:#333333;">    </span><span style="color:#969896;">#    df = DataFrame(np.random.randn(10, 4),</span>
<span style="color:#333333;">    </span><span style="color:#969896;">#                   index=[np.arange(5).repeat(2),</span>
<span style="color:#333333;">    </span><span style="color:#969896;">#                          np.tile(np.arange(2), 5)])</span>

<span style="color:#333333;">    </span><span style="color:#969896;">#    pytest.raises(Exception, store.put, &apos;foo&apos;, df, format=&apos;table&apos;)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_diff_col_name_types_raises_value_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#333333;">        df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#333333;">        df4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#333333;">        df5 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">object</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">rands</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(name, df)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> d </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> (df2, df3, df4, df5):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(name, d)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_with_nested_special_character</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                              </span><span style="color:#183691;">&apos;test &amp; test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#0086b3;">8</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.a </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;test &amp; test&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a = &quot;test &amp; test&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_categorical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Basic</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, result)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, result)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;s&quot;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&quot;vals&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]})</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Dtypes</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si2&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Multiple</span>
<span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcdefg&apos;</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df2)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Make sure the metadata is OK</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2   &apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2/meta/values_block_0/meta&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2/meta/values_block_1/meta&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># unordered</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Query</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s = [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;d&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;f&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Appending with same categories is ok</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df])</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Appending must have the same categories</span>
<span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            df3[</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">].cat.</span><span style="color:#0086b3;">remove_unused_categories</span><span style="color:#333333;">(</span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># Remove, and make sure meta data is removed (its a recursive</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># removal so should be).</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3/meta/s/meta&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3/meta/s/meta&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_categorical_conversion</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH13322</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Check that read_hdf with categorical columns doesn&apos;t return rows if</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># where criteria isn&apos;t met.</span>
<span style="color:#333333;">        obsids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;ESP_012345_6789&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ESP_987654_3210&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">        imgids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;APF00006np&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;APF0001imm&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">        data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">4.3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9.8</span><span style="color:#333333;">]</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Test without categories</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">obsids</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">obsids, </span><span style="color:#0086b3;">imgids</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">imgids, </span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">data))</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># We are expecting an empty DataFrame matching types of df</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[], :]</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;obsids=B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Test with categories</span>
<span style="color:#333333;">        df.obsids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.obsids.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        df.imgids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.imgids.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># We are expecting an empty DataFrame matching types of df</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[], :]</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;obsids=B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_duplicate_column_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&quot;a&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;a&quot;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]])</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf,</span>
<span style="color:#333333;">                          path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            other </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, other)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(other)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> other.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_round_trip_equals</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 9330</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;B&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&quot;A&quot;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&quot;x&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;y&quot;</span><span style="color:#333333;">]})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            other </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, other)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(other)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> other.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_preserve_timedeltaindex_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH9635</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Storing TimedeltaIndexed DataFrames in fixed stores did not preserve</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># the type of the index.</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">normal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta_range</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;0s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;1s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;example&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_colums_multiindex_modified</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># BUG: 7212</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># read_hdf store.select modified the passed columns parameters</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># when multi-indexed.</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        data_columns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index.names </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> df.columns.</span><span style="color:#0086b3;">tolist</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                      </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                      </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                      </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">data_columns,</span>
<span style="color:#333333;">                      </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            cols2load </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;BCD&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            cols2load_original </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(cols2load)</span>
<span style="color:#333333;">            df_loaded </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">cols2load)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> cols2load_original </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> cols2load</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_to_hdf_with_object_column_names</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH9057</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Writing HDF5 table format should only work for string-like</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># column types</span>

<span style="color:#333333;">        types_should_fail </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.makeIntIndex, tm.makeFloatIndex,</span>
<span style="color:#333333;">                             tm.makeDateIndex, tm.makeTimedeltaIndex,</span>
<span style="color:#333333;">                             tm.makePeriodIndex]</span>
<span style="color:#333333;">        types_should_run </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.makeStringIndex, tm.makeCategoricalIndex]</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            types_should_run.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(tm.makeUnicodeIndex)</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">            types_should_fail.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(tm.makeUnicodeIndex)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> types_should_fail:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">msg</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;cannot have non-object label &quot;</span>
<span style="color:#333333;">                                         </span><span style="color:#183691;">&quot;DataIndexableCol&quot;</span><span style="color:#333333;">)):</span>
<span style="color:#333333;">                        df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> types_should_run:</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;index = [{</span><span style="color:#0086b3;">0</span><span style="color:#183691;">}]&quot;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]))</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result))</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_open_store</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH10330</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># No check for non-string path_or-buf, and no test of open store</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            direct </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            indirect </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(direct, indirect)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_iterator</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            direct </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            iterator </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(iterator, TableIterator)</span>
<span style="color:#333333;">            indirect </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">next</span><span style="color:#333333;">(iterator.</span><span style="color:#0086b3;">__iter__</span><span style="color:#333333;">())</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(direct, indirect)</span>
<span style="color:#333333;">            iterator.store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_errors</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, read_hdf, path, </span><span style="color:#183691;">&apos;key&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, read_hdf, store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">open</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, read_hdf, store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_complib</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foolib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">    </span><span style="color:#969896;"># GH10443</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># Categorical dtype not supported for &quot;fixed&quot; format. So no need</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># to test with that dtype in the dataframe here.</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH13231</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;i&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abacd&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey_empty</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_from_pathlib_path</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH11773</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_pathlib</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pathlib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> Path</span>

<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> filename:</span>
<span style="color:#333333;">            path_obj </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Path</span><span style="color:#333333;">(filename)</span>

<span style="color:#333333;">            expected.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, actual)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_from_py_localpath</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># GH11773</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_localpath</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> py.path </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> local </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> LocalPath</span>

<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> filename:</span>
<span style="color:#333333;">            path_obj </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LocalPath</span><span style="color:#333333;">(filename)</span>

<span style="color:#333333;">            expected.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, actual)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_long_float_literal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 14241</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1000000000.0009</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                 </span><span style="color:#0086b3;">1000000000.0011</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                 </span><span style="color:#0086b3;">1000000000.0015</span><span style="color:#333333;">]})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            cutoff </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0006</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;A &lt; </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> cutoff)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.empty</span>

<span style="color:#333333;">            cutoff </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0010</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;A &gt; </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> cutoff)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            exact </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0011</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A == </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> exact)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_compare_column_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 15492</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2014-01-02&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.2</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                           </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]},</span>
<span style="color:#333333;">                          </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;real_date &gt; ts&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;&lt;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;&gt;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;==&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                </span><span style="color:#969896;"># non strings to string column always fail</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">2.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">True</span><span style="color:#333333;">, pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                          pd.</span><span style="color:#0086b3;">Timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)]:</span>
<span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;date {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op)</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>

<span style="color:#333333;">                </span><span style="color:#969896;"># strings to other columns must be convertible to type</span>
<span style="color:#333333;">                v </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> col </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;{</span><span style="color:#0086b3;">col</span><span style="color:#183691;">} {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op, </span><span style="color:#0086b3;">col</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>

<span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v, col </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1.1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                                  [</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">]):</span>
<span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;{</span><span style="color:#0086b3;">col</span><span style="color:#183691;">} {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op, </span><span style="color:#0086b3;">col</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>
<span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>

<span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;==&apos;</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">elif</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&gt;&apos;</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[], :]</span>
<span style="color:#333333;">                    tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>

<span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">parametrize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;format&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_series_mode_r</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 16583</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># Tests that reading a Series saved to an HDF file</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># still works if a mode=&apos;r&apos; argument is supplied</span>
<span style="color:#333333;">        series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeFloatSeries</span><span style="color:#333333;">()</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            series.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">format</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, series)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_py2_hdf_file_in_py3</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH 16781</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># tests reading a PeriodIndex DataFrame written in Python2 in Python3</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># the file was generated in Python 2.7 like so:</span>
<span style="color:#333333;">        </span><span style="color:#969896;">#</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># df = pd.DataFrame([1.,2,3], index=pd.PeriodIndex(</span>
<span style="color:#333333;">        </span><span style="color:#969896;">#              [&apos;2015-01-01&apos;, &apos;2015-01-02&apos;, &apos;2015-01-05&apos;], freq=&apos;B&apos;))</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># df.to_hdf(&apos;periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;, &apos;p&apos;)</span>

<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">PeriodIndex</span><span style="color:#333333;">(</span>
<span style="color:#333333;">            [</span><span style="color:#183691;">&apos;2015-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2015-01-02&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2015-01-05&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="background-color:#ffe0e0;">                tm.get_data_path(</span><span style="background-color:#ffc0c0;">&apos;periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;),</span><span style="background-color:#ffe0e0;"></span>
<span style="color:#333333;background-color:#d0ffd0;">                tm.</span><span style="color:#0086b3;background-color:#d0ffd0;">get_data_path</span><span style="color:#333333;background-color:#d0ffd0;">(</span><span style="background-color:#d0ffd0;"></span>
<span style="color:#333333;background-color:#d0ffd0;">                    </span><span style="color:#183691;background-color:#d0ffd0;">&apos;legacy_hdf/periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;</span><span style="color:#333333;background-color:#d0ffd0;">),</span><span style="background-color:#d0ffd0;"></span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>


<span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestHDFComplexValues(</span>Base<span style="color:#333333;">):</span>
<span style="color:#333333;">    </span><span style="color:#969896;"># GH10447</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex64),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex64),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_mixed_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        complex64 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex64)</span>
<span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex64,</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: complex128,</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.0</span><span style="color:#333333;">]},</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_mixed_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        complex64 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex64)</span>
<span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex64,</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: complex128,</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.0</span><span style="color:#333333;">]},</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df.loc[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], result)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_across_dimensions_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;One&apos;</span><span style="color:#333333;">: df, </span><span style="color:#183691;">&apos;Two&apos;</span><span style="color:#333333;">: df})</span>

<span style="color:#333333;">            objs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s, df, p]</span>
<span style="color:#333333;">            comps </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.assert_series_equal, tm.assert_frame_equal,</span>
<span style="color:#333333;">                     tm.assert_panel_equal]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> obj, comp </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">(objs, comps):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                    obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">comp</span><span style="color:#333333;">(obj, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_across_dimensions</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;One&apos;</span><span style="color:#333333;">: df, </span><span style="color:#183691;">&apos;Two&apos;</span><span style="color:#333333;">: df})</span>
<span style="color:#333333;">            p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel4D</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;i&apos;</span><span style="color:#333333;">: p, </span><span style="color:#183691;">&apos;ii&apos;</span><span style="color:#333333;">: p})</span>

<span style="color:#333333;">            objs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [df, p, p4d]</span>
<span style="color:#333333;">            comps </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.assert_frame_equal, tm.assert_panel_equal,</span>
<span style="color:#333333;">                     tm.assert_panel4d_equal]</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> obj, comp </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">(objs, comps):</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">                    obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                    </span><span style="color:#0086b3;">comp</span><span style="color:#333333;">(obj, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_indexing_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex128},</span>
<span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append,</span>
<span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_series_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, s.to_hdf, path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#333333;">            s.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, reread)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_append</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)})</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df], </span><span style="color:#0086b3;">0</span><span style="color:#333333;">), result)</span>


<span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestTimezones(</span>Base<span style="color:#333333;">):</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_compare_with_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">a</span><span style="color:#333333;">, </span><span style="color:#0086b3;">b</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(a, b)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># compare the zones on each element</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> a.columns:</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> a.index:</span>
<span style="color:#333333;">                a_e </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> a.loc[i, c]</span>
<span style="color:#333333;">                b_e </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> b.loc[i, c]</span>
<span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> (a_e </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> b_e </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> a_e.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> b_e.tz):</span>
<span style="color:#333333;">                    </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">AssertionError</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                        </span><span style="color:#183691;">&quot;invalid tz comparsion [</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">] [</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">]&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (a_e, b_e))</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timezones_dateutil</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>
<span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_dateutil</span><span style="color:#333333;">()</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># use maybe_get_tz instead of dateutil.tz.gettz to handle the windows</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># filename issues.</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas._libs.tslib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> maybe_get_tz</span>
<span style="color:#333333;">        gettz </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#0086b3;">maybe_get_tz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dateutil/&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> x)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># as columns</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102 2:00:00&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">hours</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)]))</span>

<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select with tz aware</span>
<span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> df.A[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]]</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;=df.A[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># ensure we include dates in DST and STD time here.</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;EET&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t append with diff timezone</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># as index</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># GH 4098 example</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)))))</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timezones_pytz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># as columns</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102 2:00:00&apos;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                             </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span>
<span style="color:#333333;">                                   </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">hours</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> i</span>
<span style="color:#333333;">                                   </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)]))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># select with tz aware</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;=df.A[3]&apos;</span><span style="color:#333333;">), df[df.A </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> df.A[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]])</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># ensure we include dates in DST and STD time here.</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;EET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t append with diff timezone</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># as index</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># GH 4098 example</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                </span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">))))</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_select_index_column</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH7777</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># selecting a UTC datetimeindex column did</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># not preserve UTC tzinfo set before storing</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># check that no tz still works</span>
<span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">(result.values).tz</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># check utc</span>
<span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> result.dt.tz</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># double check non-utc</span>
<span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> result.dt.tz</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_timezones_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># index</span>
<span style="color:#333333;">            rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">            </span><span style="color:#969896;"># as data</span>
<span style="color:#333333;">            </span><span style="color:#969896;"># GH11411</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: rng,</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: rng.</span><span style="color:#0086b3;">tz_convert</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">tz_localize</span><span style="color:#333333;">(</span><span style="color:#0086b3;">None</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: rng.</span><span style="color:#0086b3;">tz_convert</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng))}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_fixed_offset_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000 00:00:00-07:00&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000 00:00:00-07:00&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>

<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> frame</span>
<span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_index_equal</span><span style="color:#333333;">(recons.index, rng)</span>
<span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> recons.index.tz</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_timezone</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># GH2852</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># issue storing datetime.date with a timezone as it resets when read</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># back in a new timezone</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># original method</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            today </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[today, today, today])</span>
<span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">        </span><span style="color:#969896;"># with tz setting</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set_timezone</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;EST5EDT&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                today </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[today, today, today])</span>
<span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set_timezone</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CST6CDT&apos;</span><span style="color:#333333;">):</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]</span>

<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_datetimetz_object</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># legacy from &lt; 0.17.0</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># 8260</span>
<span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/datetimetz_object.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>

<span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_dst_transitions</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#333333;">        </span><span style="color:#969896;"># make sure we are not failing on transaitions</span>
<span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#333333;">            times </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;2013-10-26 23:00&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;2013-10-27 01:00&quot;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;Europe/London&quot;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;H&quot;</span><span style="color:#333333;">,</span>
<span style="color:#333333;">                                  </span><span style="color:#0086b3;">ambiguous</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;infer&apos;</span><span style="color:#333333;">)</span>

<span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [times, times </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timedelta</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;10min&apos;</span><span style="color:#333333;">)]:</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(i)), </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: i}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">i)</span>
<span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
</pre>
</body>
</html>
<!--HTML generated by ansifilter 2.20, http://www.andre-simon.de/-->
