<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
pre {
  font-family:Courier New;
  font-size:10pt;
}

.af_line {
  color: gray;
  text-decoration: none;
}

</style>
<title>Source file</title>
</head>
<body>
<pre>
<span style="color:#0000ee;"></span><span style="color:#444444;">  1 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  1 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pytest</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  2 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  2 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> sys</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  3 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  3 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> os</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  4 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  4 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> tempfile</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  5 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  5 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> contextlib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> contextmanager</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  6 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  6 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> warnings </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> catch_warnings</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  7 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  7 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  8 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  8 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">  9 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">  9 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 10 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 10 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> numpy </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> np</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 11 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 11 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 12 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 12 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 13 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 13 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pd</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 14 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 14 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (Series, DataFrame, Panel, Panel4D, MultiIndex, Int64Index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 15 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 15 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    RangeIndex, Categorical, bdate_range,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 16 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 16 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    date_range, timedelta_range, Index, DatetimeIndex,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 17 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 17 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    isnull)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 18 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 18 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 19 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 19 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.compat </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> is_platform_windows, </span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">PY35</span><span style="color:#333333;">, text_type</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 20 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 20 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.formats.printing </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pprint_thing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 21 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 21 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 22 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 22 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">tables </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">importorskip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 23 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 23 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.pytables </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> TableIterator</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 24 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 24 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io.pytables </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (HDFStore, get_store, Term, read_hdf,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 25 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 25 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                PossibleDataLossError, ClosedFileError)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 26 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 26 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 27 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 27 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.io </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pytables </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pytables</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 28 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 28 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas.util.testing </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tm</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 29 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 29 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.util.testing </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> (assert_panel4d_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 30 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 30 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 assert_panel_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 31 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 31 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 32 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 32 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 33 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 33 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 set_timezone)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 34 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 34 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> concat, Timestamp</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 35 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 35 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> compat</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 36 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 36 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas.compat </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">, lrange, u</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 37 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 37 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> distutils.version </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> LooseVersion</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 38 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 38 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 39 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 39 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">_default_compressor </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LooseVersion</span><span style="color:#333333;">(tables.__version__) </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;2.2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 40 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 40 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#a71d5d;">else</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 41 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 41 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 42 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 42 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 43 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 43 </span><span style="color:#0000ee;">│</span><span style="color:#969896;"># testing on windows/py3 seems to fault</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 44 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 44 </span><span style="color:#0000ee;">│</span><span style="color:#969896;"># for using compression</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 45 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 45 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">skip_compression </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">PY3</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> </span><span style="color:#0086b3;">is_platform_windows</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 46 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 46 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 47 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 47 </span><span style="color:#0000ee;">│</span><span style="color:#969896;"># contextmanager to ensure the file cleanup</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 48 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 48 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 49 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 49 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 50 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 50 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">safe_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 51 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 51 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> path </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 52 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 52 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 53 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 53 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            os.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 54 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 54 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 55 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 55 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 56 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 56 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 57 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 57 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 58 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 58 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">safe_close</span><span style="color:#333333;">(</span><span style="color:#0086b3;">store</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 59 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 59 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 60 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 60 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> store </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 61 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 61 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 62 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 62 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 63 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 63 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 64 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 64 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 65 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 65 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 66 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 66 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 67 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 67 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot; create an unopened named temporary file &quot;&quot;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 68 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 68 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(tempfile.</span><span style="color:#0086b3;">gettempdir</span><span style="color:#333333;">(), path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 69 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 69 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 70 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 70 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 71 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 71 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">&#64;</span><span style="color:#0086b3;">contextmanager</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 72 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 72 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 73 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 73 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">fletcher32</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 74 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 74 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 75 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 75 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 76 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 76 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 77 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 77 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># put in the temporary path if we don&apos;t have one already</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 78 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 78 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(os.path.</span><span style="color:#0086b3;">dirname</span><span style="color:#333333;">(path)):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 79 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 79 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 80 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 80 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 81 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 81 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">complevel,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 82 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 82 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">complib, </span><span style="color:#0086b3;">fletcher32</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 83 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 83 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 84 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 84 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 85 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 85 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 86 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 86 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">or</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 87 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 87 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 88 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 88 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 89 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 89 </span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 90 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 90 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">&#64;</span><span style="color:#0086b3;">contextmanager</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 91 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 91 </span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 92 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 92 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 93 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 93 </span><span style="color:#0000ee;">│</span><span style="color:#969896;">    return essentially a named temporary file that is not opened</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 94 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 94 </span><span style="color:#0000ee;">│</span><span style="color:#969896;">    and deleted on existing; if path is a list, then create and</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 95 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 95 </span><span style="color:#0000ee;">│</span><span style="color:#969896;">    return list of filenames</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 96 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 96 </span><span style="color:#0000ee;">│</span><span style="color:#969896;">    &quot;&quot;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 97 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 97 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 98 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 98 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">list</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 99 </span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 99 </span><span style="color:#0000ee;">│</span><span style="color:#333333;">            filenames </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(p) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> p </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> path]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> filenames</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 101</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 102</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            filenames </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(path)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 103</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">yield</span><span style="color:#333333;"> filenames[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 105</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> f </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> filenames:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 106</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 107</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 108</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 109</span><span style="color:#0000ee;">│</span><span style="color:#969896;"># set these parameters so we don&apos;t have file sharing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 110</span><span style="color:#0000ee;">│</span><span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_NUMEXPR_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_BLOSC_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 112</span><span style="color:#0000ee;">│</span><span style="color:#333333;">tables.parameters.</span><span style="color:#0086b3;">MAX_THREADS</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 113</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 114</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 115</span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_maybe_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">store</span><span style="color:#333333;">, </span><span style="color:#0086b3;">key</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">&quot;&quot;&quot;For tests using tables, try removing the table to be sure there is</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 117</span><span style="color:#0000ee;">│</span><span style="color:#969896;">    no content from previous tests using the same table name.&quot;&quot;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 119</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 120</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 121</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 122</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 123</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 124</span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">class</span><span style="color:#333333;"> Base(</span>object<span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 125</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;</span><span style="color:#0086b3;">classmethod</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 127</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">setup_class</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cls</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 128</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 129</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Pytables 3.0.0 deprecates lots of things</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">reset_testing_mode</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 131</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 132</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;</span><span style="color:#0086b3;">classmethod</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">teardown_class</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cls</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 134</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 135</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Pytables 3.0.0 deprecates lots of things</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 136</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">set_testing_mode</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 137</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 138</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">setup_method</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">method</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 139</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;tmp.__</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">__.h5&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">rands</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 140</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 141</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">teardown_method</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">method</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 142</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 143</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 144</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">&#64;pytest.mark.</span><span style="color:#0086b3;">single</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 146</span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestHDFStore(</span>Base<span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 147</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 148</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_factory_fun</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 150</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 152</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;blah&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 154</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 155</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 156</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 157</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 158</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 159</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 160</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 162</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 163</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 164</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 165</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">get_store</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 166</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(tbl) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 167</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> DataFrame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 170</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 171</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_context</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 172</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 173</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 174</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;blah&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 179</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 180</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 181</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 184</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tbl:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 186</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(tbl) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 187</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(tbl[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> DataFrame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 188</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 190</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_conv_read_write</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 192</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 194</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, key, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 196</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 197</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 198</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 199</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">, o))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 200</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 201</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 202</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string_series&apos;</span><span style="color:#333333;">, o))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 203</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 205</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, o))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 206</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 207</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 208</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 209</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                o </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 210</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(o, </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, o))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 211</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 212</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 213</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 214</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;index&gt;2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 217</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 218</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 219</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 219</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 220</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_long_strings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 222</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH6166</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 224</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># unconversion of long strings was being chopped in earlier</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 225</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># versions of numpy &lt; 1.7.2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 226</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">rands_array</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">tm.</span><span style="color:#0086b3;">rands_array</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 228</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 229</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 230</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 231</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 232</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 233</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 234</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 235</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_api</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 236</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 237</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH4584</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 238</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># API issue when to_hdf doesn&apos;t acdept append AND format args</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 240</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 241</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 242</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 243</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 244</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 245</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 246</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 247</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 249</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 250</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 251</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 252</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 253</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 254</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 255</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 256</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 257</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 259</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 260</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 261</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 262</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 263</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 264</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 265</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 266</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 267</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 268</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 269</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 270</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 271</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 272</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 274</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 276</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 277</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 279</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 280</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store._path</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 281</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 282</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 283</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 284</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 285</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 287</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 288</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># append to False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 289</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 290</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 292</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 293</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 294</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># formats</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 297</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 298</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 299</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 301</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df.iloc[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 303</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 304</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 305</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 306</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 307</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invalid</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 309</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 310</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 311</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 312</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 313</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 314</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 315</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 316</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, df.to_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 317</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 318</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># File path doesn&apos;t exist</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 320</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 321</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(compat.FileNotFoundError,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 322</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                      read_hdf, path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 323</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 324</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_api_default_format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 325</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 326</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># default_format option</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 328</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 329</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 331</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 332</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 335</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 336</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 337</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 338</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 342</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 343</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 344</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 345</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 346</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 347</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 349</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 353</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf, path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 355</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 356</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 357</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 359</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 361</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">).is_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 363</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 364</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.default_format&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 365</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_keys</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 367</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 368</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 369</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 370</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 371</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 372</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 373</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 374</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/foo/bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 377</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">()) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> expected</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> expected</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 379</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 380</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_iter_empty</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 381</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 382</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH 12221</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> []</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 385</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 386</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_repr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 387</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 388</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 389</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 391</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 393</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 396</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 397</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">, tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 398</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 399</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 400</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 401</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 402</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 403</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 404</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 405</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 407</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 408</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 410</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 412</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 413</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 416</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 417</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 418</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># make a random group in hdf space</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 419</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store._handle.</span><span style="color:#0086b3;">create_group</span><span style="color:#333333;">(store._handle.root, </span><span style="color:#183691;">&apos;bah&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 420</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 422</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 423</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># storers</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 425</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 426</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 427</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 428</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 429</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 430</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 431</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">repr</span><span style="color:#333333;">(s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 433</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 434</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_contains</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 435</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 436</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 438</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 439</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 442</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo/bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/foo/bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 445</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/foo/b&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 446</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 447</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 448</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># gh-2694: tables.NaturalNameWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;node())&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 451</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;node())&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 452</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 453</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_versioning</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 454</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 455</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 457</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 458</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 459</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 461</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 462</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.a._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 463</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.b._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 464</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.root.df1._v_attrs.pandas_version </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;0.15.2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 465</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 466</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># write a file and wipe its versioning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 467</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 468</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 469</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 470</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this is an error because its table_type is appendable, but no</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># version info</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">get_node</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)._v_attrs.pandas_version </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 474</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 475</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_mode</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 476</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 477</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 478</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 479</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">mode</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 480</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 481</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 482</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 483</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># constructor</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 484</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, HDFStore, path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 486</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 487</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 488</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._handle.mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> mode</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 490</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 491</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 493</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># context</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 496</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 497</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 498</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 499</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 500</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._handle.mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> mode</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 503</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 505</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># conv write</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 508</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, df.to_hdf,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 511</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 512</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 513</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 514</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># conv read</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> mode </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 516</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 518</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 519</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">mode)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 521</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_default_mode</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 523</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># read_hdf uses default mode</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 525</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 528</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 529</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 530</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r+&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 532</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 533</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 534</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check_default_mode</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 535</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_reopen_handle</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 537</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 539</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 540</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 541</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 542</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 543</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invalid mode change</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(PossibleDataLossError, store.open, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 546</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 547</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># truncation ok here</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 550</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 551</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 554</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 555</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 557</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># reopen as read</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 559</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 560</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 561</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 562</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;r&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 563</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 565</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># reopen as append</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 570</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 572</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 573</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 574</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># reopen as append (again)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 575</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">open</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store._mode </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 579</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 580</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 581</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_open_args</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 583</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 585</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 587</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># create an in memory store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">driver</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H5FD_CORE&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 590</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">driver_core_backing_store</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 591</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 593</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 594</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 595</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 596</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 598</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 599</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># the file should not have actually been written</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">exists</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 601</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 602</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_flush</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 603</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 605</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">flush</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">flush</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fsync</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 608</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 609</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_get</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 610</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 611</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 612</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 613</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            left </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            right </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 615</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(left, right)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 616</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            left </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 618</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            right </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(left, right)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 620</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.get, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 622</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 623</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 624</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 625</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 626</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 627</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 628</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 629</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 630</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># test attribute access</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 631</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.a</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 634</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 635</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 636</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 637</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 638</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 640</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 641</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># errors</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">, store, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 643</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 644</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 644</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;mode&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;path&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;handle&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 645</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 645</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">, store, x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 646</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 646</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 647</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 647</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not stores</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 648</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 648</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;mode&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;path&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;handle&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 649</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 649</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&quot;_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 650</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 650</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 651</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 651</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 652</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 652</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 653</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 653</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 654</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 654</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 655</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 655</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 656</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 656</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 657</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 657</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 658</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 658</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 659</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 659</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo/bar/bah&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 660</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 660</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 661</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 661</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 662</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 662</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 663</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 663</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 664</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 664</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not OK, not a table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 665</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 665</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 666</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 666</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 667</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 667</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 668</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 668</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># node does not currently exist, test _is_table_type returns False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 669</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 669</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># in this case</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 670</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 670</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># _maybe_remove(store, &apos;f&apos;)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 671</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 671</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># pytest.raises(ValueError, store.put, &apos;f&apos;, df[10:],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 672</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 672</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;">#                   append=True)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 673</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 673</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 674</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 674</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t put to a table (use append instead)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 675</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 675</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 676</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 676</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 677</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 677</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># overwrite table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 678</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 678</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 679</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 679</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 680</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 680</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 681</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 681</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_string_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 682</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 682</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 683</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 683</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 684</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 684</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 685</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 685</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 686</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 686</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&quot;I am a very long string index: </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 687</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 687</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 688</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 688</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 689</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 689</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 690</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 690</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 691</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 691</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 692</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 692</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 693</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 693</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 694</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 694</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 695</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 695</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 696</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 696</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># mixed length</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 697</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 697</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;abcdefghijklmnopqrstuvwxyz1234567890&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 698</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 698</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#183691;">&quot;I am a very long string index: </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 699</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 699</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 700</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 700</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">21</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 701</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 701</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 702</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 702</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 703</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 703</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 704</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 704</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 705</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 705</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 706</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 706</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 707</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 707</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 708</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 708</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_compression</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 709</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 709</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 710</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 710</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 711</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 711</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 712</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 712</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 713</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 713</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 714</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 714</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 715</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 715</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 716</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 716</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t compress if format=&apos;fixed&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 717</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 717</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 718</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 718</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 719</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 719</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 720</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 720</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_compression_blosc</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 721</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 721</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">skip_if_no_package</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">min_version</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;2.2&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 722</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 722</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">app</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc support&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 723</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 723</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 724</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 724</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;skipping on windows/PY3&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 725</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 725</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 726</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 726</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 727</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 727</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 728</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 728</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 729</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 729</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 730</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 730</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t compress if format=&apos;fixed&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 731</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 731</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 732</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 732</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 733</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 733</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 734</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 734</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;blosc&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 735</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 735</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 736</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 736</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 737</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 737</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complibs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 738</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 738</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH14478</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 739</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 739</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 740</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 740</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 741</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 741</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Building list of all complibs and complevels tuples</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 742</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 742</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        all_complibs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tables.filters.all_complibs</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 743</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 743</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Remove lzo if its not available on this platform</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 744</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 744</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> tables.</span><span style="color:#0086b3;">which_lib_version</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;lzo&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 745</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 745</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            all_complibs.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;lzo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 746</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 746</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        all_levels </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 747</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 747</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        all_tests </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(lib, lvl) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> lib </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_complibs </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> lvl </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_levels]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 748</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 748</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 749</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 749</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> (lib, lvl) </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> all_tests:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 750</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 750</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> tmpfile:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 751</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 751</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                gname </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 752</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 752</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 753</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 753</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># Write and read file to see if data is consistent</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 754</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 754</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(tmpfile, gname, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">lib, </span><span style="color:#0086b3;">complevel</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">lvl)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 755</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 755</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(tmpfile, gname)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 756</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 756</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 757</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 757</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 758</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 758</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># Open file and check metadata</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 759</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 759</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># for correct amount of compression</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 760</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 760</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                h5table </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tables.</span><span style="color:#0086b3;">open_file</span><span style="color:#333333;">(tmpfile, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 761</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 761</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> node </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> h5table.</span><span style="color:#0086b3;">walk_nodes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;/&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> gname,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 762</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 762</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                               </span><span style="color:#0086b3;">classname</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;Leaf&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 763</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 763</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> lvl</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 764</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 764</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> lvl </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 765</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 765</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complib </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 766</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 766</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 767</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 767</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> node.filters.complib </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> lib</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 768</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 768</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                h5table.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 769</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 769</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 770</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 770</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_integer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 771</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 771</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># non-date, non-string index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 772</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 772</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">50</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 773</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 773</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 774</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 774</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 775</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 775</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_put_mixed_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 776</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 776</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 777</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 777</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 778</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 778</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 779</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 779</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 780</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 780</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 781</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 781</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 782</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 782</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 783</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 783</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 784</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 784</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 785</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 785</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 786</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 786</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 787</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 787</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 788</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 788</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 789</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 789</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 790</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 790</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 791</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 791</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 792</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 792</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 793</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 793</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 794</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 794</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 795</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 795</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 796</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 796</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 797</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 797</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 798</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 798</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 799</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 799</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 800</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 800</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 801</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 801</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 802</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 802</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 803</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 803</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 804</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 804</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 805</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 805</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this is allowed by almost always don&apos;t want to do it</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 806</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 806</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># tables.NaturalNameWarning):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 807</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 807</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 808</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 808</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 809</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 809</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 810</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 810</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 811</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 811</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 812</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 812</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 813</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 813</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 814</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 814</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 815</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 815</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 816</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 816</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 817</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 817</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 818</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 818</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 819</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 819</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 820</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 820</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 821</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 821</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 822</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 822</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 823</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 823</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 824</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 824</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 825</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 825</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># this is allowed by almost always don&apos;t want to do it</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 826</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 826</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># tables.NaturalNameWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 827</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 827</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 828</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 828</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 829</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 829</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;/df3 foo&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 830</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 830</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3 foo&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 831</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 831</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 832</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 832</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 833</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 833</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 834</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 834</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 835</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 835</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 836</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 836</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp.iloc[:, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 837</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 837</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">], wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 838</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 838</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 839</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 839</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># ndim</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 840</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 840</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 841</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 841</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 842</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 842</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 843</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 843</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 844</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 844</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 845</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 845</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 846</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 846</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># test using axis labels</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 847</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 847</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 848</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 848</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 849</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 849</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 850</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 850</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 851</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 851</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 852</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 852</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 853</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 853</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 854</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 854</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># test using differnt number of items on each axis</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 855</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 855</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 856</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 856</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d2[</span><span style="color:#183691;">&apos;l4&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 857</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 857</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d2[</span><span style="color:#183691;">&apos;l5&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 858</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 858</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 859</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 859</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 860</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 860</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">, p4d2, </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 861</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 861</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d2&apos;</span><span style="color:#333333;">], p4d2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 862</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 862</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 863</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 863</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># test using differt order of items on the non-index axes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 864</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 864</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 865</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 865</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp_append1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 866</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 866</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp_append1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 867</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 867</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp_append2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.items[::</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 868</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 868</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp_append2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 869</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 869</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">], wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 870</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 870</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 871</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 871</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># dtype issues - mizxed type in a single object column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 872</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 872</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 873</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 873</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;mixed_column&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;testing&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 874</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 874</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;mixed_column&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 875</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 875</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 876</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 876</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 877</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 877</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 878</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 878</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 879</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 879</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># uints - test storage of uints</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 880</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 880</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                uint_data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 881</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 881</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u08&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">255</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 882</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 882</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint8),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 883</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 883</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u16&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">65535</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 884</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 884</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint16),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 885</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 885</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">high</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 886</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 886</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint32),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 887</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 887</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;u64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">58</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">59</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">60</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">61</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">62</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 888</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 888</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.uint64)}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 889</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 889</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 890</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 890</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">, uint_data)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 891</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 891</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">], uint_data)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 892</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 892</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 893</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 893</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># uints - test storage of uints in indexable columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 894</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 894</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 895</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 895</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># 64-bit indices not yet supported</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 896</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 896</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">, uint_data, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 897</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 897</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#183691;">&apos;u08&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;u16&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;u32&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 898</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 898</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;uints&apos;</span><span style="color:#333333;">], uint_data)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 899</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 899</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 900</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 900</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 901</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 901</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 902</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 902</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 903</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 903</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 904</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 904</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># basic</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 905</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 905</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 906</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 906</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 907</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 907</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 908</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 908</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 909</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 909</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">, ss)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 910</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 910</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 911</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 911</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ss)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 912</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 912</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 913</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 913</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 914</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 914</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, ts)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 915</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 915</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 916</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 916</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ts)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 917</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 917</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 918</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 918</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 919</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 919</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ns.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 920</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 920</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, ns)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 921</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 921</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 922</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 922</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ns)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 923</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 923</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.name </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ns.name</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 924</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 924</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 925</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 925</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select on the values</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 926</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 926</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ns[ns </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">60</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 927</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 927</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&gt;60&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 928</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 928</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 929</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 929</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 930</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 930</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select on the index and values</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 931</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 931</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ns[(ns </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">70</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (ns.index </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">90</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 932</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 932</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ns&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&gt;70 and index&lt;90&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 933</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 933</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 934</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 934</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 935</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 935</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multi-index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 936</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 936</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 937</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 937</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(mi))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 938</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 938</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 939</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 939</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 940</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 940</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 941</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 941</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> mi.</span><span style="color:#0086b3;">stack</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 942</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 942</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.index.</span><span style="color:#0086b3;">droplevel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 943</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 943</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 944</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 944</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">], s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 945</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 945</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 946</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 946</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_types</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 947</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 947</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH5386</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 948</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 948</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># test storing various index types</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 949</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 949</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 950</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 950</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 951</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 951</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 952</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 952</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">format</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 953</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 953</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 954</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 954</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 955</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 955</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 956</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 956</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 957</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 957</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">format</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 958</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 958</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 959</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 959</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 960</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 960</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [tm.makeFloatIndex, tm.makeStringIndex,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 961</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 961</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          tm.makeIntIndex, tm.makeDateIndex]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 962</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 962</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 963</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 963</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 964</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 964</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 965</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 965</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 966</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 966</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># period index currently broken for table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 967</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 967</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># seee GH7796 FIXME</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 968</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 968</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, tm.makePeriodIndex)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 969</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 969</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># check(&apos;table&apos;,tm.makePeriodIndex)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 970</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 970</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 971</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 971</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># unicode</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 972</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 972</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.makeUnicodeIndex</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 973</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 973</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 974</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 974</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 975</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 975</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 976</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 976</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 977</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 977</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 978</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 978</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># only support for fixed types (and they have a perf warning)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 979</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 979</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, check, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 980</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 980</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 981</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 981</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 982</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 982</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 983</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 983</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 984</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 984</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 985</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 985</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_encoding</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 986</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 986</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 987</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 987</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> sys.byteorder </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;little&apos;</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 988</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 988</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;system byteorder is not little&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 989</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 989</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 990</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 990</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 991</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 991</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 992</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 992</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 993</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 993</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 994</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 994</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 995</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 995</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ascii&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 996</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 996</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 997</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 997</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 998</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 998</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;"> 999</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;"> 999</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">Term</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ascii&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1000</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1000</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1001</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1001</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1002</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1002</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_latin_encoding</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1003</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1003</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1004</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1004</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY2</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1005</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1005</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1006</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1006</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">r</span><span style="color:#183691;">&apos;\[</span><span style="color:#333333;">unicode</span><span style="color:#183691;">\]</span><span style="color:#333333;"> is not implemented as a table column</span><span style="color:#183691;">&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1007</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1007</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">return</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1008</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1008</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1009</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1009</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1010</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1010</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1011</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1011</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;EE, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1012</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1012</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;E\xc9, 17&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1013</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1013</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1014</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1014</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1015</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1015</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;A\xf8\xfc&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1016</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1016</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [np.nan, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1017</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1017</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [</span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;A\xf8\xfc&apos;</span><span style="color:#333333;">, np.nan, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">b</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1018</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1018</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1019</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1019</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_try_decode</span><span style="color:#333333;">(</span><span style="color:#0086b3;">x</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;latin-1&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1020</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1020</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1021</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1021</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> x.</span><span style="color:#0086b3;">decode</span><span style="color:#333333;">(encoding)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1022</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1022</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">AttributeError</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1023</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1023</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> x</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1024</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1024</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># not sure how to remove latin-1 from code in python 2 and 3</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1025</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1025</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#0086b3;">_try_decode</span><span style="color:#333333;">(x) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> y] </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> y </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> values]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1026</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1026</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1027</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1027</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        examples </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> []</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1028</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1028</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> dtype </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">object</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1029</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1029</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> val </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> values:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1030</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1030</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                examples.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(pandas.</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(val, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dtype))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1031</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1031</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1032</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1032</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">s</span><span style="color:#333333;">, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;latin-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">nan_rep</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1033</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1033</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1034</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1034</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                s.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, key, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">encoding,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1035</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1035</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">nan_rep</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">nan_rep)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1036</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1036</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                retr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1037</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1037</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                s_nan </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">replace</span><span style="color:#333333;">(nan_rep, np.nan)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1038</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1038</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s_nan, retr, </span><span style="color:#0086b3;">check_categorical</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1039</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1039</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1040</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1040</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> examples:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1041</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1041</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">roundtrip</span><span style="color:#333333;">(s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1042</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1042</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1043</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1043</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># fails:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1044</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1044</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># for x in examples:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1045</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1045</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;">#     roundtrip(s, nan_rep=b&apos;\xf8\xfc&apos;)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1046</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1046</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1047</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1047</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_some_nans</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1048</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1048</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1049</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1049</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1050</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1050</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1051</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1051</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1052</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1052</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1053</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1053</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1054</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1054</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;20010101&quot;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1055</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1055</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1056</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1056</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1057</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1057</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># some nans</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1058</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1058</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1059</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1059</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1060</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1060</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1061</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1061</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1062</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1062</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1063</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1063</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1064</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1064</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># first column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1065</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1065</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1066</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1066</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1.loc[:, </span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1067</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1067</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1068</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1068</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1069</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1069</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1070</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1070</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1071</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1071</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1072</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1072</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># 2nd column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1073</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1073</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1074</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1074</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2.loc[:, </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1075</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1075</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1076</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1076</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1077</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1077</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1078</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1078</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1079</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1079</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1080</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1080</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># datetimes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1081</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1081</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1082</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1082</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3.loc[:, </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1083</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1083</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1084</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1084</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1085</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1085</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1086</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1086</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df3)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1087</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1087</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1088</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1088</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_all_nans</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1089</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1089</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1090</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1090</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1091</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1091</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1092</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1092</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1093</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1093</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1094</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1094</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1095</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1095</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1096</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1096</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1097</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1097</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (dropna=True)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1098</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1098</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1099</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1099</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1101</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1102</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1103</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (dropna=False)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1105</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1106</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1107</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1108</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1109</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># tests the option io.hdf.dropna_table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1110</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.dropna_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1112</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1113</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1114</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1115</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pandas.</span><span style="color:#0086b3;">set_option</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;io.hdf.dropna_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1117</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1119</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1120</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">], df[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1121</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1122</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (string are still written!)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1123</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1124</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1125</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1127</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1128</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1129</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1131</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1132</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1134</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1135</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1136</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1137</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1138</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1139</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1140</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># nan some entire rows (but since we have dates they are still</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1141</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># written!)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1142</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A1&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1143</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;A2&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1144</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;20010101&quot;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1146</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1147</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1148</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">15</span><span style="color:#333333;">, :] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1150</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1152</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1154</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1155</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1156</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1157</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1158</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">10</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1159</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1160</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Test to make sure defaults are to not drop.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1162</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Corresponding to Issue 9382</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1163</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df_with_missing </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1164</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            {</span><span style="color:#183691;">&apos;col1&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, np.nan, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;col2&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, np.nan]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1165</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1166</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1167</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_with_missing.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_with_missing&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reloaded </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_with_missing&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df_with_missing, reloaded)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1170</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1171</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        matrix </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[[np.nan, np.nan, np.nan], [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, np.nan]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1172</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [[np.nan, np.nan, np.nan], [np.nan, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1173</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                  [[np.nan, np.nan, np.nan], [np.nan, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, np.nan]]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1174</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            panel_with_missing </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(matrix,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item3&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1179</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1180</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1181</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                panel_with_missing.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    path, </span><span style="color:#183691;">&apos;panel_with_missing&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1184</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                reloaded_panel </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;panel_with_missing&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(panel_with_missing, reloaded_panel)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1186</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1187</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_frame_column_oriented</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1188</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1190</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># column oriented</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1192</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1194</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df.iloc[:, :</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;columns&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df.iloc[:, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1196</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1197</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1198</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1199</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1200</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1201</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1202</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># selection on the non-indexable</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1203</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, (</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index=df.index[0:4]&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1205</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1206</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1207</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1208</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this isn&apos;t supported</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1209</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1210</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1211</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#183691;">&apos;columns=A and index&gt;df.index[4]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1212</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1213</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_different_block_ordering</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1214</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 4096; using same frames, but different block orderings</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1217</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1218</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1219</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1219</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1220</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1222</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+=</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1224</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1225</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1226</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1228</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1229</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">3</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1230</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    a </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">pop</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1231</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> a</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1232</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1233</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1234</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1235</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1236</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1237</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># test a different ordering but with more fields (like invalid</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1238</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># combinate)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1240</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1241</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1242</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;AB&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1243</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1244</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1245</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1246</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1247</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># store additonal fields in different blocks</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int16_2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1249</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1250</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1251</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># store multile additonal fields in different blocks</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1252</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;float_3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1253</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1254</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1255</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_ndim_indexables</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1256</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># test using ndim tables in new ways</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1257</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1259</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1260</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1261</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1262</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1263</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">indexers</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1264</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i, idx </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">enumerate</span><span style="color:#333333;">(indexers):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1265</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        descr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.root, key).table.description</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1266</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(descr, idx)._v_pos </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> i</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1267</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1268</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># append then change (will take existing schema)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1269</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1270</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1271</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1272</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1274</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">), p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1276</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1277</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># same as above, but try to append with differnt axes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1279</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1280</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1281</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1282</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">), p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1283</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1284</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1285</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># pass incorrect number of axes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1287</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1288</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    :, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1289</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1290</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># different than default indexables #1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1292</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1293</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1294</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1297</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1298</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># different than default indexables #2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1299</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                indexers </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;labels&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1301</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :], </span><span style="color:#0086b3;">axes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d.iloc[:, :, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1303</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">], p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1304</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_indexers</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, indexers)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1305</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1306</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># partial selection</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1307</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;labels=l1&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1309</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1310</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1311</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># partial selection2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1312</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1313</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;labels=&apos;l1&apos; and items=&apos;ItemA&apos; and minor_axis=&apos;B&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1314</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1315</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1316</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1317</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1318</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non-existant partial selection</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1320</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;labels=&apos;l1&apos; and items=&apos;Item1&apos; and minor_axis=&apos;B&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1321</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1322</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1323</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1324</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1325</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_strings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1326</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1328</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1329</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">rename_axis</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1331</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">([(x, </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_extra&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> wp.minor_axis]), </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1332</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1335</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   .table.description, name).itemsize </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> size</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1336</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1337</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1338</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([wp, wp2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">sorted</span><span style="color:#333333;">(expected.minor_axis))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1342</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">], expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1343</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1344</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1345</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># test dict format</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1346</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1347</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([wp, wp2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1349</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">sorted</span><span style="color:#333333;">(expected.minor_axis))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">], expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1353</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># apply the wrong field (similar to #1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1355</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1356</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;s3&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1357</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># test truncation of bigger strings</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1359</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s4&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;s4&apos;</span><span style="color:#333333;">, wp2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1361</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># avoid truncation on elements</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1363</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">123</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqwerty&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">345</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhebbsdfbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1364</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1365</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">15</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1367</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1368</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># appending smaller string ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1369</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">124</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqy&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">346</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhefbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1370</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1371</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1372</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">), expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1373</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">15</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1374</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># avoid truncation on elements</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">123</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;asdqwerty&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">345</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;dggnhebbsdfbdfb&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1377</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">50</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1379</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_big2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">50</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1380</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1381</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># bigger string on next append</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1382</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_new&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    [[</span><span style="color:#0086b3;">124</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;abcdefqhij&apos;</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">346</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;abcdefghijklmnopqrtsuvwxyz&apos;</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1385</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_new&apos;</span><span style="color:#333333;">, df_new)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1386</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1387</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># min_itemsize on Series index (GH 11412)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1388</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeMixedDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1389</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">4</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss&apos;</span><span style="color:#333333;">), df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1391</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># same as above, with data_columns=True</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1393</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss2&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">4</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss2&apos;</span><span style="color:#333333;">), df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1396</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1397</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># min_itemsize in index without appending (GH 10381)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1398</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1399</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1400</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># just make sure there is a longer string:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1401</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">().</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">().</span><span style="color:#0086b3;">assign</span><span style="color:#333333;">(</span><span style="color:#0086b3;">C</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;longer&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1402</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1403</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1404</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1405</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># same as above, with a Series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1407</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1408</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1410</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1412</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1413</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># with nans</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1416</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1417</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1418</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1419</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1420</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bah&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:, </span><span style="color:#183691;">&apos;string3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1422</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1423</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1425</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1426</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1427</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1428</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1429</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1430</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               .table.description, name).itemsize, size</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1431</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1433</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1434</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1435</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1436</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1438</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1439</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1442</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1445</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1446</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a min_itemsize that creates a data_column2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1447</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1448</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1451</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_0&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1452</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">).data_columns </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1453</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1454</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># infer the .typ on subsequent appends</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1455</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1457</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1458</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1459</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invalid min_itemsize keys</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1461</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1462</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;barh&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1463</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1464</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1465</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          df, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foobar&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">20</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1466</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1467</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_to_hdf_with_min_itemsize</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1468</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1469</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1470</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># min_itemsize in index with to_hdf (GH 10381)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeMixedDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1474</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># just make sure there is a longer string:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1475</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">().</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">().</span><span style="color:#0086b3;">assign</span><span style="color:#333333;">(</span><span style="color:#0086b3;">C</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;longer&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1476</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1477</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss3&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1478</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df2]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1479</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1480</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># same as above, with a Series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1481</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1482</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">6</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1483</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1484</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;ss4&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], df2[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1486</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1487</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_data_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1488</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1490</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1491</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1493</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1496</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1497</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># check that we have indicies created</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1498</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(store._handle.root.df.table.cols.index.is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1499</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(store._handle.root.df.table.cols.B.is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1500</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># data column searching</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1503</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1505</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># data column searching (with an indexable and a data_columns)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1508</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0 and index&gt;df.index[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[df_new.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1511</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1512</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1513</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># data column selection with a string data_column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1514</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1516</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.loc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.loc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1518</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1519</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;string=&apos;foo&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1521</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1523</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># using min_itemsize and a data column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1525</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check_col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">key</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(key)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               .table.description, name).itemsize </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> size</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1528</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1529</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1530</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1532</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1533</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1534</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1535</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1537</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1539</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1540</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1541</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1542</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1543</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string_block1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah1&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1546</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string_block2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foobarbah2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1547</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">40</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1550</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">50</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1551</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check_col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">50</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1554</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1555</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multiple data columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1557</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1559</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1560</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1561</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1562</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            sl </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1563</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1565</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            sl </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new.columns.</span><span style="color:#0086b3;">get_loc</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_new.iloc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, sl] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1570</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1572</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_new, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1573</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1574</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#183691;">&quot;string=&apos;foo&apos; and string2=&apos;foo&apos;&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1575</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#183691;">&quot; and A&gt;0 and B&lt;0&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[(df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df_new.string2 </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_new.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_new.B </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1579</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1580</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># yield an empty frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1581</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;string=&apos;foo&apos; and string2=&apos;cool&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_new[(df_new.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1583</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df_new.string2 </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1585</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1587</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># doc example</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1590</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1591</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1593</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1594</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc.</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1595</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1596</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1598</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, df_dc,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1599</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1601</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1602</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1603</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1605</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;B &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string == foo&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1608</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[(df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_dc.C </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1609</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df_dc.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1610</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1611</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1612</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1613</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># doc example part 2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            np.random.</span><span style="color:#0086b3;">seed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1234</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1615</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">8</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1616</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1618</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1620</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">]].</span><span style="color:#0086b3;">abs</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1622</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_dc[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;cool&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1623</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1624</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># on-disk operations</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1625</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, df_dc, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1626</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1627</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1628</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1629</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1630</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1631</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_dc&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;B &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C &gt; 0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string == &quot;foo&quot;&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1634</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df_dc[(df_dc.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df_dc.C </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1635</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             (df_dc.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1636</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1637</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1638</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1640</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1641</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># GH5717 not handling data_columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                np.random.</span><span style="color:#0086b3;">seed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1234</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1643</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1644</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1644</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1645</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1645</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1&apos;</span><span style="color:#333333;">, p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1646</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1646</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1&apos;</span><span style="color:#333333;">), p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1647</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1647</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1648</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1648</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, p, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1649</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1649</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">), p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1650</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1650</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1651</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1651</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ItemA&gt;0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1652</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1652</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1653</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1653</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1654</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1654</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1655</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1655</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1656</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1656</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1657</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1657</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;ItemA&gt;0 &amp; minor_axis=[&quot;A&quot;,&quot;B&quot;]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1658</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1658</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1659</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1659</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1660</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1660</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.</span><span style="color:#0086b3;">reset_index</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1661</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1661</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">level</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major&apos;</span><span style="color:#333333;">]).index.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1662</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1662</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1663</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1663</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1664</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1664</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_create_table_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1665</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1665</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1666</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1666</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1667</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1667</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1668</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1668</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1669</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1669</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">col</span><span style="color:#333333;">(</span><span style="color:#0086b3;">t</span><span style="color:#333333;">, </span><span style="color:#0086b3;">column</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1670</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1670</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(t).table.cols, column)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1671</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1671</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1672</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1672</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># index=False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1673</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1673</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1674</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1674</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1675</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1675</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1676</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1676</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1677</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1677</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1678</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1678</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1679</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1679</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># index=True</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1680</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1680</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1681</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1681</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1682</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1682</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5i&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1683</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1683</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1684</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1684</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># default optlevels</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1685</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1685</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">create_index</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1686</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1686</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">6</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1687</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1687</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1688</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1688</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1689</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1689</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># let&apos;s change the indexing scheme</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1690</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1690</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1691</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1691</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">6</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1692</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1692</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1693</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1693</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">optlevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1694</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1694</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1695</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1695</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;medium&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1696</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1696</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;full&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1697</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1697</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">9</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1698</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1698</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;full&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1699</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1699</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">create_table_index</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">optlevel</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;light&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1700</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1700</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&apos;</span><span style="color:#333333;">).index.optlevel </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1701</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1701</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p5&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis&apos;</span><span style="color:#333333;">).index.kind </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;light&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1702</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1702</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1703</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1703</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># data columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1704</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1704</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1705</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1705</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1706</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1706</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1707</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1707</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1708</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1708</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1709</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1709</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1710</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1710</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1711</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1711</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1712</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1712</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># specify index=columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1713</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1713</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1714</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1714</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1715</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1715</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1716</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1716</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1717</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1717</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1718</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1718</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">col</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string2&apos;</span><span style="color:#333333;">).is_indexed </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1719</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1719</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1720</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1720</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># try to index a non-table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1721</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1721</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1722</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1722</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1723</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1723</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.create_table_index, </span><span style="color:#183691;">&apos;f2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1724</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1724</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1725</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1725</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_diff_item_order</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1726</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1726</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1727</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1727</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1728</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1728</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1729</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1729</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[:, :</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1730</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1730</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.iloc[wp.items.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;ItemC&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">]),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1731</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1731</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">10</span><span style="color:#333333;">:, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1732</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1732</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1733</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1733</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1734</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1734</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp1, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1735</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1735</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp2,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1736</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1736</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1737</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1737</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1738</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1738</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_hierarchical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1739</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1739</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1740</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1740</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1741</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1741</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1742</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1742</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1743</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1743</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1744</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1744</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1745</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1745</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1746</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1746</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1747</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1747</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1748</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1748</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1749</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1749</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1750</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1750</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1751</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1751</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1752</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1752</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH 3748</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1753</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1753</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1754</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1754</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1755</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1755</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1756</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1756</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1757</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1757</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test.hdf&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1758</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1758</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1759</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1759</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1760</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1760</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1761</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1761</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1762</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1762</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1763</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1763</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_column_multiindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1764</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1764</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 4710</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1765</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1765</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># recreate multi-indexes properly</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1766</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1766</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1767</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1767</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">([(</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">), (</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1768</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1768</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        (</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">), (</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1769</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1769</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;first&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;second&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1770</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1770</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1771</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1771</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1772</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1772</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(expected.index, RangeIndex):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1773</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1773</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Int64Index</span><span style="color:#333333;">(expected.index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1774</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1774</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1775</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1775</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1776</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1776</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1777</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1777</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1778</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1778</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1779</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1779</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1780</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1780</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1781</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1781</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1782</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1782</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1783</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1783</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1784</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1784</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1785</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1785</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1786</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1786</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1787</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1787</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1788</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1788</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1789</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1789</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1790</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1790</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1791</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1791</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1792</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1792</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># appending multi-column on existing table (see GH 6167)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1793</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1793</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1794</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1794</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1795</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1795</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1796</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1796</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1797</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1797</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">((df, df)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1798</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1798</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1799</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1799</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># non_index_axes name</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1800</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1800</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1801</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1801</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1802</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1802</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1803</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1803</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(expected.index, RangeIndex):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1804</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1804</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Int64Index</span><span style="color:#333333;">(expected.index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1805</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1805</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1806</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1806</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1807</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1807</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1808</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1808</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1809</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1809</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], expected,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1810</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1810</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1811</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1811</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">check_column_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1812</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1812</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1813</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1813</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_multiindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1814</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1814</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1815</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1815</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># validate multi-index names</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1816</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1816</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 5527</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1817</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1817</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1818</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1818</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1819</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1819</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">make_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1820</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1820</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">([(datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">12</span><span style="color:#333333;">, d),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1821</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1821</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                s, t)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1822</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1822</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> d </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1823</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1823</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1824</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1824</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                               </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">)],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1825</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1825</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">names)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1826</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1826</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1827</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1827</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># no names</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1828</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1828</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1829</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1829</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1830</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1830</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1831</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1831</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1832</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1832</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1833</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1833</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1834</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1834</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># partial names</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1835</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1835</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1836</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1836</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1837</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1837</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1838</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1838</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1839</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1839</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1840</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1840</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1841</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1841</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1842</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1842</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1843</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1843</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1844</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1844</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1845</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1845</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            xp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">12</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1846</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1846</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;level_1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;level_2&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1847</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1847</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">), xp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1848</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1848</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1849</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1849</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># dup with column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1850</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1850</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1851</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1851</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1852</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1852</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1853</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1853</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1854</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1854</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1855</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1855</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># dup within level</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1856</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1856</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1857</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1857</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1858</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1858</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1859</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1859</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1860</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1860</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1861</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1861</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># fully names</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1862</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1862</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1863</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1863</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">((</span><span style="color:#0086b3;">12</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1864</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1864</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">make_index</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1865</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1865</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1866</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1866</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1867</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1867</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1868</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1868</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_columns_in_where</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1869</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1869</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1870</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1870</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 6169</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1871</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1871</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># recreate multi-indexes when columns is passed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1872</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1872</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># in the `where` argument</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1873</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1873</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1874</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1874</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1875</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1875</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1876</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1876</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1877</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1877</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo_name&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar_name&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1878</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1878</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1879</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1879</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># With a DataFrame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1880</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1880</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1881</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1881</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1882</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1882</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1883</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1883</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1884</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1884</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1885</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1885</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1886</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1886</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1887</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1887</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]), expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1888</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1888</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1889</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1889</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1890</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1890</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">), expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1891</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1891</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1892</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1892</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># With a Series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1893</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1893</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1894</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1894</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                   </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1895</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1895</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1896</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1896</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1897</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1897</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">), s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1898</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1898</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1899</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1899</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_mi_data_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1900</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1900</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 14435</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1901</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1901</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.MultiIndex.</span><span style="color:#0086b3;">from_arrays</span><span style="color:#333333;">([</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1902</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1902</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                         </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)], </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;id&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1903</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1903</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.5</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1904</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1904</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1905</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1905</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1906</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1906</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1907</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1907</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1908</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1908</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;id == 1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1909</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1909</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1910</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1910</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(actual, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1911</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1911</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1912</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1912</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pass_spec_to_storer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1913</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1913</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1914</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1914</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1915</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1915</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1916</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1916</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1917</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1917</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1918</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1918</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1919</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1919</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1920</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1920</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[(</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1921</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1921</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1922</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1922</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_misc</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1923</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1923</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1924</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1924</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1925</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1925</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1926</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1926</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1927</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1927</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1928</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1928</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># unsuported data types for non-tables</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1929</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1929</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1930</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1930</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1931</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1931</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1932</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1932</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># unsuported data types</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1933</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1933</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1934</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1934</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;123&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1935</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1935</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">123</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1936</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1936</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;abc&apos;</span><span style="color:#333333;">, np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1937</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1937</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1938</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1938</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1939</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1939</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1940</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1940</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1941</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1941</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1942</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1942</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1943</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1943</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">expectedrows</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1944</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1944</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1945</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1945</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1946</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1946</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1947</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1947</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># more chunksize in append tests</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1948</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1948</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1949</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1949</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1000</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1950</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1950</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1951</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1951</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, obj, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1952</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1952</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1953</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1953</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(result, obj)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1954</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1954</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1955</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1955</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1956</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1956</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1957</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1957</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1958</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1958</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1959</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1959</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1960</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1960</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;time1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1961</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1961</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;time2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1962</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1962</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1963</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1963</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1964</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1964</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1965</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1965</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1966</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1966</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(p, assert_panel_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1967</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1967</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1968</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1968</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1969</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1969</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1970</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1970</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">check</span><span style="color:#333333;">(p4d, assert_panel4d_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1971</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1971</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1972</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1972</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># empty frame, GH4273</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1973</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1973</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1974</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1974</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1975</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1975</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># 0 len</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1976</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1976</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_empty </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1977</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1977</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1978</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1978</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1979</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1979</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1980</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1980</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># repeated append of 0/non-zero frames</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1981</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1981</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1982</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1982</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1983</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1983</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1984</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1984</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1985</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1985</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1986</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1986</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1987</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1987</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1988</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1988</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1989</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1989</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1990</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1990</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1991</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1991</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1992</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1992</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1993</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1993</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1994</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1994</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># 0 len</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1995</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1995</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p_empty </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1996</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1996</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1997</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1997</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1998</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1998</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">1999</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">1999</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># repeated append of 0/non-zero frames</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2000</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2000</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABC&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2001</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2001</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2002</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2002</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">), p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2003</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2003</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2004</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2004</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">), p)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2005</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2005</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2006</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2006</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2007</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2007</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">, p_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2008</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2008</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p2&apos;</span><span style="color:#333333;">), p_empty)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2009</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2009</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2010</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2010</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_raise</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2011</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2011</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2012</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2012</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2013</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2013</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2014</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2014</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># test append with invalid input to get good error messages</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2015</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2015</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2016</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2016</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># list in column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2017</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2017</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2018</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2018</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2019</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2019</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.dtypes[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.object_</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2020</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2020</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2021</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2021</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2022</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2022</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multiple invalid columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2023</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2023</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2024</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2024</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2025</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2025</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2026</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2026</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2027</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2027</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># datetime with embedded nans as object</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2028</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2028</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2029</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2029</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2030</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2030</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#0086b3;">object</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2031</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2031</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2032</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2032</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2033</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2033</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.dtypes[</span><span style="color:#183691;">&apos;invalid&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.object_</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2034</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2034</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2035</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2035</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2036</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2036</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># directy ndarray</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2037</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2037</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2038</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2038</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2039</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2039</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># series directly</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2040</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2040</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2041</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2041</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2042</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2042</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2043</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2043</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># appending an incompatible table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2044</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2044</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2045</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2045</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2046</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2046</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2047</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2047</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2048</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2048</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2049</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2049</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2050</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2050</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_index_incompatible_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2051</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2051</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2052</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2052</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2053</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2053</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2054</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2054</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2055</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2055</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2056</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2056</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2057</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2057</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.put, </span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df2,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2058</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2058</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2059</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2059</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2060</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2060</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_values_dtypes_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2061</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2061</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2062</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2062</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2063</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2063</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2064</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2064</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_f8&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2065</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2065</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df1.dtypes, store[</span><span style="color:#183691;">&apos;df_f8&apos;</span><span style="color:#333333;">].dtypes)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2066</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2066</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2067</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2067</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]}, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;i8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2068</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2068</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2069</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2069</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df2.dtypes, store[</span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">].dtypes)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2070</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2070</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2071</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2071</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># incompatible dtype</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2072</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2072</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_i8&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2073</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2073</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2074</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2074</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># check creation/storage/retrieval of float32 (a bit hacky to</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2075</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2075</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># actually create them thought)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2076</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2076</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2077</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2077</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">2</span><span style="color:#333333;">], [</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f4&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2078</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2078</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_f4&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2079</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2079</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(df1.dtypes, store[</span><span style="color:#183691;">&apos;df_f4&apos;</span><span style="color:#333333;">].dtypes)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2080</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2080</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df1.dtypes[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;float32&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2081</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2081</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2082</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2082</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># check with mixed dtypes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2083</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2083</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">([(c, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2084</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2084</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2085</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2085</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int8&apos;</span><span style="color:#333333;">]]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2086</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2086</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2087</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2087</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2088</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2088</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1[</span><span style="color:#183691;">&apos;float322&apos;</span><span style="color:#333333;">].</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2089</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2089</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1[</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2090</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2090</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;time1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2091</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2091</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1[</span><span style="color:#183691;">&apos;time2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2092</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2092</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2093</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2093</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_mixed_dtypes1&apos;</span><span style="color:#333333;">, df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2094</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2094</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_mixed_dtypes1&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">get_dtype_counts</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2095</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2095</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;float32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int32&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2096</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2096</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               </span><span style="color:#183691;">&apos;bool&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int16&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int8&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2097</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2097</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               </span><span style="color:#183691;">&apos;int64&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;datetime64[ns]&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">2</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2098</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2098</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.</span><span style="color:#0086b3;">sort_index</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2099</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2099</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.</span><span style="color:#0086b3;">sort_index</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2101</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2102</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_table_mixed_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2103</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2105</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2106</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2107</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2108</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2109</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2110</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;bool3&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2112</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2113</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2114</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;timestamp2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2115</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2117</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2119</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2120</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2121</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1_mixed&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2122</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1_mixed&apos;</span><span style="color:#333333;">), df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2123</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2124</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2125</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># panel</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2127</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2128</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2129</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2131</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2132</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2134</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2135</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2136</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2137</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2138</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2139</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1_mixed&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2140</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p1_mixed&apos;</span><span style="color:#333333;">), wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2141</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2142</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2143</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># ndim</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2144</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2146</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2147</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2148</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp[</span><span style="color:#183691;">&apos;l2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2150</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2152</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2154</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d_mixed&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2155</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d_mixed&apos;</span><span style="color:#333333;">), wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2156</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2157</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unimplemented_dtypes_table_columns</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2158</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2159</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2160</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            l </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">))]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2162</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2163</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># py3 ok for unicode</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2164</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2165</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                l.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">((</span><span style="color:#183691;">&apos;unicode&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\\u03c3&apos;</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2166</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2167</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># currently not supported dtypes ####</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> n, f </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> l:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2170</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[n] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> f</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2171</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2172</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df1_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> n, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2173</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2174</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;datetime1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2001</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2179</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">().</span><span style="color:#0086b3;">_convert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">datetime</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2180</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2181</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this fails because we have a date in the object block......</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_unimplemented&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2184</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_calendar_roundtrip_issue</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2186</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2187</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># 8591</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2188</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># doc example from tseries holiday section</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        weekmask_egypt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;Sun Mon Tue Wed Thu&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2190</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        holidays </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;2012-05-01&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), np.</span><span style="color:#0086b3;">datetime64</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-05-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2192</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        bday_egypt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pandas.offsets.</span><span style="color:#0086b3;">CustomBusinessDay</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">holidays</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">holidays, </span><span style="color:#0086b3;">weekmask</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">weekmask_egypt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2194</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        dts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(dt, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">bday_egypt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2196</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2197</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(dts.weekday, dts).</span><span style="color:#0086b3;">map</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2198</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;Mon Tue Wed Thu Fri Sat Sun&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">split</span><span style="color:#333333;">())))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2199</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2200</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2201</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2202</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2203</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2205</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2206</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2207</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2208</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2209</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2210</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2211</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 3577</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2212</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># append timedelta</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2213</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2214</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">days</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">i, </span><span style="color:#0086b3;">seconds</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2217</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2218</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2219</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2219</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2220</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2222</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2224</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2225</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2226</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;C&lt;100000&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2228</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2229</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2230</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;C&lt;pd.Timedelta(&apos;-3D&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2231</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2232</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2233</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-3D&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2234</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2235</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2236</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a bit hacky here as we don&apos;t really deal with the NaT properly</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2237</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2238</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-500000s&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.</span><span style="color:#0086b3;">dropna</span><span style="color:#333333;">(</span><span style="color:#0086b3;">subset</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2240</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">6</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2241</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2242</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;C&lt;&apos;-3.5D&apos;&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2243</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> result.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2244</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.iloc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2245</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2246</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># fixed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2247</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2249</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2250</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2251</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2252</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2253</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2254</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2255</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2256</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2257</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2259</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2260</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2261</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2262</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2263</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2264</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2265</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2266</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2267</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># nonexistence</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2268</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.remove, </span><span style="color:#183691;">&apos;a_nonexistent_store&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2269</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2270</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># pathing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2271</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2272</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2274</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2276</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2277</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b/foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2279</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2280</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2281</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2282</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># __delitem__</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2283</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2284</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2285</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">del</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2287</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2288</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2289</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_where</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2290</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2292</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2293</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2294</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non-existance</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;index&gt;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2297</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.remove, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, [crit1])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2298</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2299</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># try to remove non-table (with crit)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non-table ok (where = None)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2301</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2303</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2304</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                rs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2305</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2306</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(rs, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2307</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># empty where</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2309</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2310</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2311</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2312</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># deleted number (entire table)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2313</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2314</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2315</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2316</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non - empty where</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2317</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2318</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.remove,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2320</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2321</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2322</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_startstop</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2323</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH #4835 and #6177</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2324</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2325</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2326</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2328</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2329</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># start</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2331</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2332</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2335</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2336</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[:</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2337</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2338</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2342</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2343</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2344</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2345</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2346</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2347</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># stop</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2349</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2353</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2355</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2356</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2357</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">32</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2359</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2361</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">32</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2363</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2364</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># start n stop</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2365</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2367</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">16</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2368</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">120</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2369</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2370</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2371</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(wp.major_axis[:</span><span style="color:#0086b3;">16</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2372</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                .</span><span style="color:#0086b3;">union</span><span style="color:#333333;">(wp.major_axis[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">16</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">4</span><span style="color:#333333;">:])))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2373</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2374</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2377</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">16</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2379</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp6&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2380</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2381</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2382</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># with where</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2385</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2386</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># TODO: unused?</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2387</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis.</span><span style="color:#0086b3;">take</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">))  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2388</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2389</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2391</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit], </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">80</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">28</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2393</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp7&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    wp.major_axis[np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">)]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2396</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2397</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2398</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_remove_crit</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2399</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2400</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2401</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2402</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2403</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2404</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2405</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># group row removal</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2407</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis.</span><span style="color:#0086b3;">take</span><span style="color:#333333;">([</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#0086b3;">8</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2408</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date4&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2410</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit4])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">36</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2412</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2413</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date4))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2416</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2417</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2418</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># upper half</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2419</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2420</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(wp.major_axis) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2422</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2423</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis&gt;date&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2425</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit1])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2426</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">56</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2427</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2428</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2429</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> n </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">32</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2430</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2431</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">date).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2433</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2434</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2435</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># individual row elements</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2436</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2438</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2439</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date1&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit1])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2442</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2445</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2446</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2447</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2448</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date2&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2451</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2452</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(wp.major_axis</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2453</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2454</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([date2]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2455</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                ))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2457</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2458</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [wp.major_axis[</span><span style="color:#0086b3;">7</span><span style="color:#333333;">], wp.major_axis[</span><span style="color:#0086b3;">9</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2459</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;major_axis=date3&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[crit3])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2461</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2462</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">wp.major_axis</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2463</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(date1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2464</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">([date2]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2465</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      .</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(date3)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2466</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2467</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2468</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># corners</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2469</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2470</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                n </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;major_axis&gt;wp.major_axis[-1]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2474</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2475</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2476</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_terms</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2477</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2478</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2479</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2480</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2481</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2482</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2483</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2484</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2486</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2487</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2488</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2490</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2491</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># some invalid terms</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2493</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;minor=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2496</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&quot;index=[&apos;20121114&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2497</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2498</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&quot;index=[&apos;20121114&apos;, &apos;20121114&apos;]&quot;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2499</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, Term)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2500</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># more invalid</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2503</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df.index[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">SyntaxError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2505</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; &amp; minor_axis[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2508</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># from the docs</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2511</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dfq </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2512</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2513</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dfq.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2514</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># check ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2516</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                     </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;index&gt;Timestamp(&apos;20130104&apos;) &amp; columns=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2518</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;A&gt;0 or C&gt;0&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2519</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># catch the invalid reference</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2521</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dfq </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2523</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;ABCD&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dfq.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2525</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;dfq&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;A&gt;0 or C&gt;0&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2528</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2529</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_terms</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2530</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2532</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2533</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2534</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2535</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wpneg </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> Panel.</span><span style="color:#0086b3;">fromDict</span><span style="color:#333333;">({</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">(),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2537</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        </span><span style="color:#0086b3;">0</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">(),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        </span><span style="color:#0086b3;">1</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2539</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel4D</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2540</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, p4d, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2541</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2542</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, wpneg, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2543</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># panel</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2546</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2547</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2550</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2551</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># with deprecation</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2554</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2555</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#183691;">&quot;and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2557</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2559</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2560</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># p4d</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2561</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2562</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2563</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      (</span><span style="color:#183691;">&quot;major_axis&lt;&apos;20000108&apos; and &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2565</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;] and &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       </span><span style="color:#183691;">&quot;items=[&apos;ItemA&apos;, &apos;ItemB&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> p4d.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">after</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000108&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ItemA&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ItemB&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel4d_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2570</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2572</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2573</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># valid terms</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2574</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                terms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#183691;">&apos;major_axis=20121114&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2575</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;major_axis&gt;20121114&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;major_axis=[&apos;20121114&apos;, &apos;20121114&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;major_axis=datetime.datetime(2012, 11, 14)&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis&gt; 20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2579</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis &gt;20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2580</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#183691;">&apos;major_axis &gt; 20121114&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2581</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2583</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         (((</span><span style="color:#183691;">&quot;minor_axis==[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">),),),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         ((</span><span style="color:#183691;">&quot;items=[&apos;ItemA&apos;, &apos;ItemB&apos;]&quot;</span><span style="color:#333333;">),),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2585</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         (</span><span style="color:#183691;">&apos;items=ItemA&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         ]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2587</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> terms:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, t)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2590</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, t)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2591</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># valid for p4d only</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2593</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                terms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&quot;labels=[&apos;l1&apos;, &apos;l2&apos;]&quot;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2594</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> t </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> terms:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2595</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;p4d&apos;</span><span style="color:#333333;">, t)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2596</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2598</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Only named functions are supported&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2599</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2601</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;major_axis == (lambda x: x)(&quot;20130101&quot;)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2602</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2603</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># check USub node parsing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2605</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                res </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items == -1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">: wpneg[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(res, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2608</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2609</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2610</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;Unary addition &apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2611</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#183691;">&apos;not supported&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2612</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wpneg&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items == +1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2613</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_term_compat</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2615</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2616</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2618</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2620</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2622</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2623</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2624</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;major_axis&gt;20000102 &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2625</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#183691;">&quot;and minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2626</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2627</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">), [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2628</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2629</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2630</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;20000103&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2631</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000103&apos;</span><span style="color:#333333;">), :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2634</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2635</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2636</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2637</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2638</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;Item2&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2640</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2641</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2643</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2644</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2644</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># stringified datetimes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2645</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2645</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2646</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2646</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;datetime.datetime(2000, 1, 2)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2647</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2647</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2648</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2648</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2649</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2649</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2650</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2650</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2651</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2651</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;major_axis&gt;datetime.datetime(2000, 1, 2)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2652</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2652</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, wp.major_axis </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2653</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2653</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2654</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2654</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2655</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2655</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2656</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2656</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2657</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2657</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&quot;major_axis=[datetime.datetime(2000, 1, 2, 0, 0), &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2658</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2658</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&quot;datetime.datetime(2000, 1, 3, 0, 0)]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2659</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2659</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, [</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000102&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2660</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2660</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000103&apos;</span><span style="color:#333333;">)]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2661</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2661</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2662</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2662</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2663</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2663</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2664</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2664</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2665</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2665</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.loc[:, :, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2666</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2666</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2667</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2667</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2668</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2668</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_same_name_scoping</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2669</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2669</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2670</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2670</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2671</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2671</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2672</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2672</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> pandas </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> pd</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2673</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2673</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2674</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2674</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2675</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2675</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2676</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2676</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130105&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2677</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2677</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2678</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2678</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2679</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2679</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime.datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2680</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2680</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2681</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2681</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2682</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2682</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> datetime  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2683</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2683</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2684</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2684</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># technically an error, but allow it</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2685</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2685</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime.datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2686</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2686</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2687</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2687</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2688</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2688</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;datetime(2013,1,5)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2689</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2689</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2690</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2690</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2691</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2691</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2692</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2692</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2693</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2693</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2694</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2694</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2695</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2695</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2696</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2696</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2697</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2697</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2698</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2698</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2699</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2699</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ts2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2700</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2700</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts2, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2701</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2701</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2702</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2702</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ts3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(ts.values, </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">asarray</span><span style="color:#333333;">(ts.index, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2703</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2703</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">object</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2704</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2704</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts3, tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2705</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2705</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2706</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2706</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2707</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2707</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2708</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2708</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2709</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2709</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeStringSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2710</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2710</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2711</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2711</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2712</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2712</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss, tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2713</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2713</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2714</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2714</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2715</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2715</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;integer&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2716</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2716</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss2, tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2717</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2717</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2718</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2718</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2719</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2719</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2720</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2720</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ss3, tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2721</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2721</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2722</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2722</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2723</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2723</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2724</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2724</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2725</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2725</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2726</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2726</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2727</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2727</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s.iloc[</span><span style="color:#0086b3;">8</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2728</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2728</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2729</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2729</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2730</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2730</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2731</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2731</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2732</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2732</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2733</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2733</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">kind</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;integer&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2734</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2734</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss2, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2735</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2735</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2736</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2736</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2737</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2737</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ss3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2738</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2738</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(ss3, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2739</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2739</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2740</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2740</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2741</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2741</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_float_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2742</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2742</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2743</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2743</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH #454</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2744</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2744</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2745</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2745</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2746</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2746</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2747</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2747</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2748</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2748</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tuple_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2749</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2749</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2750</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2750</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH #492</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2751</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2751</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        col </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2752</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2752</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [(</span><span style="color:#0086b3;">0.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.</span><span style="color:#333333;">), (</span><span style="color:#0086b3;">2.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">), (</span><span style="color:#0086b3;">4.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5.</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2753</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2753</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">30</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">((</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2754</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2754</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#0086b3;">DF</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(data, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2755</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2755</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2756</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2756</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2757</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2757</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">DF</span><span style="color:#333333;">, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2758</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2758</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2759</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2759</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_index_types</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2760</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2760</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2761</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2761</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2762</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2762</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2763</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2763</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2764</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2764</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            func </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">l</span><span style="color:#333333;">, </span><span style="color:#0086b3;">r</span><span style="color:#333333;">: tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(l, r,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2765</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2765</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_dtype</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2766</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2766</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_index_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2767</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2767</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                       </span><span style="color:#0086b3;">check_series_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2768</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2768</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2769</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2769</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2770</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2770</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2771</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2771</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2772</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2772</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2773</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2773</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2774</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2774</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.datetime.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2775</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2775</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2776</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2776</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2777</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2777</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2778</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2778</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2779</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2779</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2780</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2780</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2781</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2781</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2782</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2782</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.date.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2783</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2783</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2784</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2784</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2785</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2785</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2786</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2786</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2787</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2787</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2788</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2788</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2789</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2789</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2790</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2790</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.datetime.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2791</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2791</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2792</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2792</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2793</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2793</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#183691;">&apos;y&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2794</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2794</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2795</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2795</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2796</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2796</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.date.</span><span style="color:#0086b3;">today</span><span style="color:#333333;">(), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2797</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2797</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2798</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2798</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2799</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2799</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1.23</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2800</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2800</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2801</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2801</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2802</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2802</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.53</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2803</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2803</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2804</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2804</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2805</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2805</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2806</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2806</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2807</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2807</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2808</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2808</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(values, [datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2809</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2809</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">), datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2810</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2810</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ser, func)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2811</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2811</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2812</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2812</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_timeseries_preepoch</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2813</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2813</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2814</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2814</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> sys.version_info[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> sys.version_info[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">7</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2815</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2815</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;won&apos;t work on Python &lt; 2.7&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2816</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2816</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2817</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2817</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        dr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/1940&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/1/1960&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2818</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2818</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(dr)), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dr)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2819</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2819</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2820</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2820</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(ts, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2821</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2821</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">OverflowError</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2822</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2822</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;known failer on some windows platforms&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2823</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2823</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2824</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2824</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2825</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2825</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2826</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2826</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2827</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2827</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2828</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2828</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># put in some random NAs</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2829</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2829</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.values[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2830</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2830</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.values[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2831</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2831</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2832</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2832</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip_table</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2833</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2833</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2834</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2834</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2835</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2835</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2836</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2836</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip_table</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2837</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2837</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2838</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2838</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2839</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2839</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2840</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2840</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2841</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2841</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tdf </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2842</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2842</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(tdf, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2843</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2843</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2844</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2844</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2845</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2845</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(tdf, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2846</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2846</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2847</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2847</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2848</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2848</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2849</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2849</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not consolidated</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2850</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2850</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2851</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2851</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2852</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2852</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2853</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2853</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> recons._data.</span><span style="color:#0086b3;">is_consolidated</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2854</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2854</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2855</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2855</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># empty</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2856</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2856</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df[:</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2857</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2857</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2858</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2858</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_empty_series_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2859</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2859</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s0 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2860</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2860</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;myseries&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2861</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2861</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df0 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2862</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2862</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2863</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2863</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2864</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2864</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2865</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2865</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s0, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2866</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2866</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s1, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2867</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2867</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df0, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2868</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2868</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2869</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2869</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df2, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2870</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2870</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2871</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2871</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_empty_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2872</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2872</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> dtype </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [np.int64, np.float64, np.object, </span><span style="color:#183691;">&apos;m8[ns]&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;M8[ns]&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2873</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2873</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">dtype)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2874</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2874</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2875</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2875</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2876</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2876</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_can_serialize_dates</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2877</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2877</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2878</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2878</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [x.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">() </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> x </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2879</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2879</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2880</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2880</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2881</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2881</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2882</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2882</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2883</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2883</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_hierarchical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2884</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2884</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2885</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2885</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2886</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2886</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2887</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2887</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2888</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2888</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2889</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2889</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2890</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2890</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2891</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2891</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2892</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2892</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2893</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2893</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame.T, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2894</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2894</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(frame[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2895</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2895</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2896</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2896</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># check that the names are stored</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2897</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2897</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2898</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2898</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2899</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2899</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2900</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2900</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, frame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2901</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2901</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2902</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2902</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2903</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2903</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2904</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2904</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2905</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2905</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2906</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2906</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2907</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2907</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2908</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2908</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2909</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2909</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2910</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2910</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2911</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2911</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name_with_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2912</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2912</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 13884</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2913</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2913</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2914</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2914</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1234567890123456787</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1234567890123456788</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2915</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2915</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index.</span><span style="color:#0086b3;">tz_localize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2916</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2916</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2917</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2917</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2918</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2918</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2919</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2919</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2920</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2920</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2921</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2921</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(recons, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2922</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2922</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2923</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2923</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">parametrize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;table_format&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2924</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2924</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_index_name_numpy_str</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">table_format</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2925</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2925</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH #13492</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2926</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2926</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">to_datetime</span><span style="color:#333333;">([datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2927</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2927</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                       datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)]),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2928</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2928</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;cols\u05d2&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2929</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2929</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        idx1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">to_datetime</span><span style="color:#333333;">([datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2010</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2930</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2930</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2010</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">)]),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2931</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2931</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;rows\u05d0&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2932</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2932</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2933</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2933</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2934</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2934</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># This used to fail, returning numpy strings instead of python strings.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2935</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2935</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2936</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2936</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">table_format)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2937</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2937</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2938</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2938</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2939</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2939</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, df2, </span><span style="color:#0086b3;">check_names</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2940</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2940</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2941</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2941</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(df2.index.name) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> text_type</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2942</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2942</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">type</span><span style="color:#333333;">(df2.columns.name) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> text_type</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2943</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2943</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2944</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2944</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_series_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2945</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2945</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2946</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2946</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2947</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2947</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2948</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2948</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2949</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2949</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2950</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2950</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;series&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2951</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2951</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(recons, series)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2952</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2952</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2953</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2953</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_mixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2954</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2954</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2955</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2955</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_make_one</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2956</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2956</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2957</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2957</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2958</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2958</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;obj2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2959</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2959</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2960</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2960</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;bool2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2961</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2961</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2962</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2962</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2963</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2963</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">return</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">_consolidate</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2964</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2964</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2965</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2965</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">_make_one</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2966</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2966</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">_make_one</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2967</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2967</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2968</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2968</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2969</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2969</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df2, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2970</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2970</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2971</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2971</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2972</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2972</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2973</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2973</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">], df1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2974</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2974</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2975</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2975</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">], df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2976</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2976</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2977</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2977</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># check that can store Series of all of these types</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2978</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2978</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2979</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2979</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2980</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2980</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">], tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2981</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2981</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2982</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2982</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> skip_compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2983</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2983</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2984</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2984</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2985</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2985</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;bool1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2986</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2986</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2987</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2987</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1[</span><span style="color:#183691;">&apos;int1&apos;</span><span style="color:#333333;">], tm.assert_series_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2988</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2988</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2989</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2989</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df1, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2990</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2990</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2991</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2991</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2992</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2992</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_wide</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2993</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2993</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2994</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2994</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2995</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2995</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2996</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2996</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(wp, assert_panel_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2997</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2997</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2998</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2998</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_with_dups</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">2999</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">2999</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3000</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3000</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># single dtypes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3001</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3001</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3002</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3002</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101 9:30&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;T&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3003</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3003</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3004</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3004</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3005</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3005</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3006</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3006</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3007</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3007</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3008</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3008</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3009</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3009</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3010</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3010</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3011</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3011</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.columns)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3012</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3012</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3013</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3013</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3014</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3014</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3015</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3015</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3016</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3016</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3017</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3017</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3018</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3018</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3019</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3019</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># dups accross dtypes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3020</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3020</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3021</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3021</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3022</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3022</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                     </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randint</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3023</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3023</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               .</span><span style="color:#0086b3;">reshape</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3024</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3024</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                               </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3025</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3025</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3026</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3026</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101 9:30&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;T&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3027</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3027</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3028</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3028</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3029</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3029</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3030</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3030</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3031</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3031</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3032</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3032</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3033</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3033</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3034</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3034</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3035</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3035</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">df.columns)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3036</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3036</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3037</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3037</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3038</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3038</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3039</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3039</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3040</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3040</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3041</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3041</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3042</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3042</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3043</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3043</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3044</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3044</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3045</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3045</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3046</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3046</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3047</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3047</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># duplicates on both index and columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3048</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3048</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3049</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3049</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3050</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3050</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3051</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3051</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3052</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3052</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3053</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3053</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([expected, expected])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3054</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3054</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3055</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3055</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected, </span><span style="color:#0086b3;">by_blocks</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3056</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3056</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3057</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3057</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_wide_table_dups</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3058</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3058</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3059</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3059</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3060</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3060</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3061</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3061</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3062</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3062</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3063</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3063</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3064</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3064</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3065</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3065</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;panel&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3066</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3066</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3067</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3067</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(recons, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3068</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3068</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3069</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3069</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_long</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3070</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3070</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check</span><span style="color:#333333;">(</span><span style="color:#0086b3;">left</span><span style="color:#333333;">, </span><span style="color:#0086b3;">right</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3071</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3071</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(left.</span><span style="color:#0086b3;">to_panel</span><span style="color:#333333;">(), right.</span><span style="color:#0086b3;">to_panel</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3072</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3072</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3073</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3073</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3074</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3074</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3075</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3075</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(wp.</span><span style="color:#0086b3;">to_frame</span><span style="color:#333333;">(), _check)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3076</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3076</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3077</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3077</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_longpanel</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3078</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3078</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3079</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3079</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3080</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3080</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_overwrite_node</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3081</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3081</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3082</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3082</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3083</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3083</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3084</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3084</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3085</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3085</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3086</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3086</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3087</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3087</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">], ts)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3088</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3088</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3089</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3089</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_sparse_with_compression</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3090</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3090</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3091</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3091</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 2931</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3092</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3092</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3093</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3093</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># make sparse dataframe</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3094</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3094</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        arr </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.random.</span><span style="color:#0086b3;">binomial</span><span style="color:#333333;">(</span><span style="color:#0086b3;">n</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">p</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">.01</span><span style="color:#333333;">, </span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3095</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3095</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(arr).</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">(</span><span style="color:#0086b3;">fill_value</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3096</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3096</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3097</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3097</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># case 1: store uncompressed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3098</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3098</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3099</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3099</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3101</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3102</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># case 2: store compressed (works)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3103</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3105</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3106</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3107</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># set one series to be completely sparse</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3108</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">zeros</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3109</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3110</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># case 3: store df with completely sparse series uncompressed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3112</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3113</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3114</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3115</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># case 4: try storing df with completely sparse series compressed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># (fails)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3117</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_double_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;zlib&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3119</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">check_frame_type</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3120</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3121</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3122</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3123</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3124</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3125</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3127</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3128</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># put/select ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3129</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3131</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3132</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non-table ok (where = None)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3134</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3135</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3136</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3137</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3138</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># selection on the non-indexable with a large number of columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3139</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3140</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;Item</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3141</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">major_axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3142</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">minor_axis</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;E</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3143</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3144</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3146</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                items </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;Item</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">80</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3147</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;items=items&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3148</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">items</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">items)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3150</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># selectin non-table with a where</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3152</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># pytest.raises(ValueError, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;">#                  &apos;wp2&apos;, (&apos;column&apos;, [&apos;A&apos;, &apos;D&apos;]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3154</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3155</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># select with columns=</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3156</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3157</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3158</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3159</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3160</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3162</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3163</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># equivalentsly</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3164</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [(</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3165</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3166</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3167</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># with a data column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3170</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3171</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3172</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3173</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3174</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># all a data columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3179</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3180</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3181</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># with a data column, but different columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3184</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A &gt; 0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3186</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3187</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3188</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_dtypes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3190</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3192</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># with a Timestamp data column (GH #2637)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3194</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">ts</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3196</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3197</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3198</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3199</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3200</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3201</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3202</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3203</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># bool columns (GH #2849)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3205</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3206</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;object&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3207</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3208</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3209</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3210</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3211</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[df.boolv </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">True</span><span style="color:#333333;">]  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3212</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        .</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3213</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;true&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3214</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv == </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(v),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                      </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3217</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3218</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[df.boolv </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span><span style="color:#333333;">]  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3219</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3219</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        .</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3220</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;false&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3222</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv == </span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(v), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;boolv&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3224</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3225</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># integer index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3226</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3228</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3229</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3230</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&lt;10 and columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3231</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(df.index)[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3232</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3233</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3234</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># float index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3235</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3236</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">, </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;f8&apos;</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3237</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3238</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3240</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&lt;10.0 and columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3241</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(df.index)[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">], </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3242</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3243</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3244</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3245</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3246</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># floats w/o NaN</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3247</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3249</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3250</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3251</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3252</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3253</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3254</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3255</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3256</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3257</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># floats with NaN</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3259</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3260</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3261</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3262</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3263</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3264</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3265</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3266</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># https://github.com/PyTables/PyTables/issues/282</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3267</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># bug in selection when 0th row has a np.nan and an index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3268</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># store.append(&apos;df3&apos;,df,data_columns=True)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3269</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># result = store.select(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3270</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;">#    &apos;df3&apos;, where=&apos;values&gt;2.0&apos;)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3271</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># tm.assert_frame_equal(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3272</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not in first position float with NaN ok too</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3274</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">11</span><span style="color:#333333;">)), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3276</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3277</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3279</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;values&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3280</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3281</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3282</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3283</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3284</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3285</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># test selection with comparison against numpy scalar</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3287</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 11283</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3288</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3289</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3290</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3292</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3293</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3294</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            np_zero </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">float64</span><span style="color:#333333;">(</span><span style="color:#0086b3;">0</span><span style="color:#333333;">)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&quot;A&gt;np_zero&quot;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3297</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3298</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_with_many_inputs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3299</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3301</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ts</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">bdate_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3303</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3304</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">300</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3305</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">users</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">50</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">50</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3306</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                [</span><span style="color:#183691;">&apos;a</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3307</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;ts&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;users&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3309</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3310</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># regular select</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3311</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;)&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3312</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3313</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3314</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3315</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># small selector</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3316</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3317</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3318</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;) &amp; users=[&apos;a&apos;,&apos;b&apos;,&apos;c&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3320</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          df.users.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3321</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3322</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3323</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># big selector along the columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3324</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;a</span><span style="color:#0086b3;">%03d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">60</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3325</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3326</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&quot;ts&gt;=Timestamp(&apos;2012-02-01&apos;) and users=selector&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3328</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.ts </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2012-02-01&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3329</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          df.users.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3331</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3332</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">, </span><span style="color:#0086b3;">200</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B=selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.B.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3335</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3336</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3337</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3338</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># big selector along the index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            selector </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Index</span><span style="color:#333333;">(df.ts[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">100</span><span style="color:#333333;">].values)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ts=selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.ts.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selector.values)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3342</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3343</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">100</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3344</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3345</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3346</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3347</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># single table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3349</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3353</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3355</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3356</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3357</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3359</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3361</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3363</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3364</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3365</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">150</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3367</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3368</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3369</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3370</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3371</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3372</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3373</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3374</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, read_hdf, path,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df_non_table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3377</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3379</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3380</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3381</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3382</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3385</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3386</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3387</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3388</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3389</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># multiple</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3391</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3393</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3396</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">500</span><span style="color:#333333;">).</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3397</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3398</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3399</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3400</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3401</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3402</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3403</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># full selection</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3404</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3405</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3407</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">150</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3408</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3410</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_complete_8014</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3412</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3413</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1e4</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3416</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3417</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># no iterator</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3418</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3419</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3420</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3422</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3423</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3425</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3426</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3427</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iteration and no where clause works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3428</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3429</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3430</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3431</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, single term, begin</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># of range, works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3433</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3434</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3435</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3436</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, single term, end</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3438</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># of range, works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3439</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3442</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/o iterator and where clause, inclusive range,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3445</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3446</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3447</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3448</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, full range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3451</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3452</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3453</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3454</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3455</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3457</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3458</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3459</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and no where clause works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3461</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3462</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3463</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3464</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3465</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3466</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3467</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3468</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3469</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3470</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3474</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3475</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3476</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3477</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3478</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3479</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3480</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3481</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3482</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3483</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3484</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_non_complete_8014</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3486</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3487</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3488</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1e4</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3490</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3491</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, non complete range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3493</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3496</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3497</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3498</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3499</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3500</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3503</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3505</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3508</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3511</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3512</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3513</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3514</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3516</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3518</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3519</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3521</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3523</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 (expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3525</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, empty where</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3528</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3529</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100064</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3530</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3532</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3533</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3534</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3535</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt; &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3537</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3539</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3540</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3541</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_iterator_many_empty_frames</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3542</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3543</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 8014</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># using iterator and where clause can return many empty</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># frames.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3546</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        chunksize </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">int</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1e4</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3547</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># with iterator, range limited to the first chunk</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3550</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3551</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100000</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;S&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3554</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3555</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            beg_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            end_dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected.index[chunksize </span><span style="color:#a71d5d;">-</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3557</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, begin of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3559</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> beg_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3560</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3561</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3562</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3563</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3565</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, single term, end of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> end_dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3570</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3572</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3573</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3574</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3575</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause, inclusive range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3579</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3580</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3581</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># should be 1, is 10</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3583</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">(results)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rexpected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.index </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> beg_dt) </span><span style="color:#a71d5d;">&amp;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3585</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 (expected.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> end_dt)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(rexpected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3587</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select w/iterator and where clause which selects</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># *nothing*.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3590</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;">#</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3591</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># To be consistent with Python idiom I suggest this should</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># return [] e.g. `for e in []: print True` never prints</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3593</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># True.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3594</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3595</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&quot;index &lt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos; &amp; index &gt;= &apos;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (beg_dt, end_dt)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3596</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            results </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> s </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where, </span><span style="color:#0086b3;">chunksize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">chunksize)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3598</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3599</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># should be []</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(results) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3601</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3602</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_retain_index_attributes</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3603</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 3499, losing frequency info on index recreation</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3605</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                     </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3608</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3609</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3610</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3611</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3612</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3613</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3615</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3616</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> attr </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;freq&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;tz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;name&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> idx </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;columns&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3618</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> (</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(df, idx), attr, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">==</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(</span><span style="color:#0086b3;">getattr</span><span style="color:#333333;">(result, idx), attr, </span><span style="color:#0086b3;">None</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3620</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># try to append a table with a different frequency</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3622</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3623</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3624</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3625</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3626</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3627</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3628</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3629</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).info[</span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">][</span><span style="color:#183691;">&apos;freq&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3630</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3631</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3634</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3635</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010101&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20010102&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3636</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20020101&apos;</span><span style="color:#333333;">)])))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3637</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3638</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3640</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3641</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                          </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df3)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3643</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3644</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3644</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_retain_index_attributes2</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3645</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3645</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3646</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3646</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3647</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3647</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3648</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3648</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3649</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3649</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3650</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3650</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3651</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3651</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3652</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3652</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3653</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3653</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3654</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3654</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3655</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3655</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3656</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3656</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2002-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3657</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3657</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3658</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3658</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3659</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3659</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3660</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3660</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3661</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3661</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                idx.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3662</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3662</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3663</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3663</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3664</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3664</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3665</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3665</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).index.name </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3666</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3666</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3667</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3667</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3668</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3668</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3669</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3669</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                idx2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2001-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3670</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3670</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                idx2.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3671</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3671</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx2)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3672</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3672</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3673</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3673</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3674</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3674</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">).index.name </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3675</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3675</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3676</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3676</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_panel_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3677</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3677</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3678</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3678</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3679</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3679</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3680</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3680</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3681</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3681</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3682</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3682</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3683</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3683</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3684</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3684</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3685</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3685</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.major_axis[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(wp.major_axis) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3686</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3686</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3687</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3687</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;major_axis&gt;=date&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3688</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3688</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3689</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3689</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3690</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3690</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [crit1, crit2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3691</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3691</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span><span style="color:#0086b3;">before</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">date).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3692</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3692</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3693</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3693</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3694</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3694</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3695</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3695</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;major_axis&gt;=&quot;20000124&quot;&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3696</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3696</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           (</span><span style="color:#183691;">&quot;minor_axis=[&apos;A&apos;, &apos;B&apos;]&quot;</span><span style="color:#333333;">)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3697</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3697</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> wp.</span><span style="color:#0086b3;">truncate</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3698</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3698</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">before</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;20000124&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">minor</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3699</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3699</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_panel_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3700</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3700</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3701</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3701</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3702</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3702</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3703</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3703</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3704</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3704</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3705</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3705</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3706</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3706</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3707</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3707</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            date </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df) </span><span style="color:#a71d5d;">//</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3708</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3708</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3709</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3709</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            crit1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Term</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;index&gt;=date&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3710</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3710</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> crit1.env.scope[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> date</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3711</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3711</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3712</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3712</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            crit2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&quot;columns=[&apos;A&apos;, &apos;D&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3713</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3713</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            crit3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (</span><span style="color:#183691;">&apos;columns=A&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3714</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3714</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3715</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3715</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit1, crit2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3716</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3716</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[date:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3717</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3717</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3718</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3718</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3719</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3719</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit3])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3720</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3720</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3721</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3721</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3722</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3722</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3723</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3723</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invalid terms</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3724</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3724</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3725</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3725</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_time&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3726</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3726</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3727</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3727</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df_time&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&gt;0&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3728</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3728</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3729</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3729</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t select if not written as table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3730</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3730</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># store[&apos;frame&apos;] = df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3731</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3731</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># pytest.raises(ValueError, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3732</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3732</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;">#                  &apos;frame&apos;, [crit1, crit2])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3733</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3733</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3734</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3734</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select_complex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3735</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3735</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># select via complex criteria</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3736</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3736</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3737</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3737</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3738</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3738</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3739</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3739</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.loc[df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3740</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3740</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3741</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3741</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3742</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3742</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3743</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3743</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3744</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3744</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># empty</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3745</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3745</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] &amp; string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3746</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3746</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3747</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3747</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3748</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3748</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3749</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3749</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] &amp; string=&quot;foo&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3750</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3750</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3751</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3751</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3752</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3752</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3753</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3753</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># or</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3754</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3754</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df.index[3] | string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3755</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3755</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[(df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">|</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3756</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3756</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3757</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3757</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3758</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3758</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;(index&gt;df.index[3] &amp; &apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3759</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3759</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#183691;">&apos;index&lt;=df.index[6]) | string=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3760</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3760</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[((df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3761</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3761</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.index </span><span style="color:#a71d5d;">&lt;=</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">6</span><span style="color:#333333;">])) </span><span style="color:#a71d5d;">|</span><span style="color:#333333;"> (df.string </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3762</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3762</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3763</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3763</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3764</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3764</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invert</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3765</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3765</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string!=&quot;bar&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3766</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3766</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[df.string </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3767</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3767</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3768</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3768</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3769</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3769</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invert not implemented in numexpr :(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3770</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3770</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3771</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3771</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;~(string=&quot;bar&quot;)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3772</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3772</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3773</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3773</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invert ok for filters</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3774</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3774</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;~(columns=[&apos;A&apos;,&apos;B&apos;])&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3775</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3775</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[:, df.columns.</span><span style="color:#0086b3;">difference</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3776</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3776</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3777</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3777</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3778</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3778</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># in</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3779</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3779</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3780</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3780</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;index&gt;df.index[3] &amp; columns in [&apos;A&apos;,&apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3781</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3781</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[df.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df.index[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]].</span><span style="color:#0086b3;">reindex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3782</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3782</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                              </span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3783</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3783</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3784</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3784</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3785</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3785</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_frame_select_complex2</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3786</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3786</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3787</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3787</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;parms.hdf&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;hist.hdf&apos;</span><span style="color:#333333;">]) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> paths:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3788</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3788</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3789</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3789</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pp, hh </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> paths</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3790</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3790</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3791</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3791</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># use non-trivial selection criteria</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3792</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3792</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            parms </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3793</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3793</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            parms.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(pp, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3794</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3794</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                         </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3795</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3795</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3796</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3796</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            selection </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(pp, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A=[2,3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3797</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3797</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            hist </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">25</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3798</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3798</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3799</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3799</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">MultiIndex.</span><span style="color:#0086b3;">from_tuples</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3800</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3800</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 [(i, j) </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3801</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3801</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> j </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3802</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3802</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;l1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;l2&apos;</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3803</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3803</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3804</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3804</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            hist.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3805</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3805</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3806</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3806</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=[2, 3, 4]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3807</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3807</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3808</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3808</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># sccope with list like</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3809</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3809</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            l </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> selection.index.</span><span style="color:#0086b3;">tolist</span><span style="color:#333333;">()  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3810</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3810</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(hh)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3811</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3811</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=l&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3812</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3812</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3813</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3813</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3814</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3814</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3815</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3815</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=l&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3816</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3816</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3817</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3817</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3818</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3818</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3819</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3819</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> selection.index  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3820</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3820</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3821</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3821</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3822</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3822</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3823</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3823</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3824</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3824</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3825</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3825</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3826</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3826</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index.tolist()&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3827</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3827</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3828</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3828</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3829</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3829</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(hh, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=list(selection.index)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3830</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3830</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3831</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3831</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3832</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3832</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># sccope with index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3833</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3833</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(hh)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3834</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3834</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3835</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3835</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3836</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3836</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3837</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3837</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3838</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3838</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3839</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3839</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3840</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3840</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3841</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3841</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=selection.index.tolist()&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3842</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3842</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3843</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3843</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3844</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3844</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;l1=list(selection.index)&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3845</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3845</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3846</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3846</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3847</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3847</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3848</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3848</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3849</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3849</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_filtering</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3850</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3850</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3851</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3851</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># can&apos;t use more than one filter (atm)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3852</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3852</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3853</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3853</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3854</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3854</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3855</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3855</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3856</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3856</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3857</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3857</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3858</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3858</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not implemented</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3859</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3859</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3860</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3860</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;] | columns=[&apos;B&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3861</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3861</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3862</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3862</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># in theory we could deal with this</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3863</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3863</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, store.select,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3864</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3864</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;,&apos;B&apos;] &amp; columns=[&apos;C&apos;]&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3865</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3865</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3866</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3866</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_string_select</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3867</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3867</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 2973</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3868</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3868</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3869</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3869</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3870</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3870</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3871</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3871</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3872</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3872</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># test string ==/!=</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3873</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3873</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3874</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3874</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3875</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3875</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3876</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3876</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3877</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3877</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3878</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3878</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3879</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3879</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.x </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3880</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3880</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3881</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3881</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3882</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3882</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3883</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3883</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x!=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3884</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3884</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.x </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;none&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3885</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3885</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3886</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3886</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">except</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Exception</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> detail:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3887</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3887</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;[{</span><span style="color:#0086b3;">0</span><span style="color:#183691;">}]&quot;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(detail))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3888</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3888</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3889</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3889</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">pprint_thing</span><span style="color:#333333;">(expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3890</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3890</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3891</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3891</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3892</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3892</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2.loc[df2.x </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3893</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3893</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3894</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3894</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;x&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3895</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3895</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;x!=none&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3896</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3896</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2[</span><span style="color:#0086b3;">isnull</span><span style="color:#333333;">(df2.x)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3897</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3897</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3898</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3898</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3899</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3899</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># int ==/!=</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3900</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3900</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3901</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3901</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.loc[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3902</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3902</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3903</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3903</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3904</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3904</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3905</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3905</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int=2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3906</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3906</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.int </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3907</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3907</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3908</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3908</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3909</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3909</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int!=2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3910</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3910</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.int </span><span style="color:#a71d5d;">!=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3911</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3911</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3912</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3912</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3913</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3913</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_column</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3914</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3914</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3915</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3915</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3916</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3916</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3917</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3917</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3918</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3918</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3919</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3919</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3920</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3920</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3921</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3921</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># error</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3922</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3922</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_column, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3923</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3923</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3924</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3924</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3925</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3925</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;index&gt;5&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3926</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3926</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3927</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3927</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3928</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3928</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># valid</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3929</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3929</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3930</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3930</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(df.index).values)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3931</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3931</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(result, Series)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3932</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3932</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3933</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3933</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># not a data indexable column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3934</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3934</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3935</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3935</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select_column, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;values_block_0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3936</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3936</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3937</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3937</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a data column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3938</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3938</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3939</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3939</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3940</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3940</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3941</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3941</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3942</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3942</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df2[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3943</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3943</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3944</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3944</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># a data column with NaNs, result excludes the NaNs</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3945</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3945</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3946</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3946</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;foo&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3947</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3947</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3.loc[</span><span style="color:#0086b3;">4</span><span style="color:#333333;">:</span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3948</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3948</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3949</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3949</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3950</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3950</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3951</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3951</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3952</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3952</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># start/stop</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3953</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3953</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3954</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3954</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3955</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3955</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3956</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3956</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3957</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3957</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3958</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3958</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3959</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3959</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3960</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3960</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3961</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3961</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3962</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3962</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3963</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3963</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3964</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3964</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3965</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3965</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3966</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3966</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3967</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3967</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3968</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3968</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3969</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3969</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_almost_equal</span><span style="color:#333333;">(result.values, df3[</span><span style="color:#183691;">&apos;string&apos;</span><span style="color:#333333;">].values[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3970</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3970</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3971</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3971</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH 10392 - make sure column name is preserved</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3972</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3972</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">), </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3973</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3973</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, df4, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3974</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3974</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df4[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3975</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3975</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3976</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3976</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3977</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3977</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3978</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3978</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_coordinates</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3979</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3979</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3980</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3980</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3981</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3981</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3982</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3982</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3983</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3983</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3984</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3984</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3985</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3985</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3986</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3986</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># all</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3987</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3987</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3988</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3988</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df.index))).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3989</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3989</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3990</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3990</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># get coordinates back &amp; test vs frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3991</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3991</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3992</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3992</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3993</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3993</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3994</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3994</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3995</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3995</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;index&lt;3&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3996</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3996</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3997</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3997</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3998</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3998</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">3999</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">3999</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4000</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4000</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4001</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4001</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;index&gt;=3&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&lt;=4&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4002</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4002</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">((c.values </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">3</span><span style="color:#333333;">).</span><span style="color:#0086b3;">all</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4003</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4003</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">c)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4004</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4004</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4005</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4005</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4006</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4006</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(c, Index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4007</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4007</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4008</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4008</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multiple tables</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4009</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4009</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4010</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4010</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4011</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4011</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4012</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4012</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4013</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4013</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4014</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4014</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4015</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4015</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4016</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4016</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_coordinates</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4017</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4017</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1_result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, c)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4018</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4018</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2_result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, c)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4019</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4019</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1_result, df2_result], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4020</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4020</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4021</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4021</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4022</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4022</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (expected.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4023</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4023</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4024</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4024</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4025</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4025</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># pass array/mask as the coordinates</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4026</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4026</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4027</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4027</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4028</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4028</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4029</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4029</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1000</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4030</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4030</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4031</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4031</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            c </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4032</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4032</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> c[</span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">(c).month </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">5</span><span style="color:#333333;">].index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4033</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4033</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[where]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4034</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4034</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4035</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4035</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># locations</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4036</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4036</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4037</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4037</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4038</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4038</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4039</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4039</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># boolean</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4040</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4040</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4041</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4041</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4042</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4042</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4043</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4043</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># invalid</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4044</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4044</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4045</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4045</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4046</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4046</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4047</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4047</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4048</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4048</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4049</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4049</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)), </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4050</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4050</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4051</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4051</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.</span><span style="color:#0086b3;">arange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(df)), </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4052</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4052</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4053</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4053</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># selection with filter</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4054</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4054</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            selection </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20000101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">500</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4055</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4055</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;index in selection&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4056</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4056</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.index.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">(selection)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4057</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4057</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4058</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4058</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4059</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4059</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># list</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4060</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4060</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4061</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4061</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4062</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4062</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4063</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4063</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4064</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4064</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4065</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4065</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4066</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4066</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># boolean</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4067</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4067</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">True</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4068</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4068</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            where[</span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">False</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4069</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4069</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">where)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4070</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4070</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[where]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4071</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4071</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4072</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4072</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4073</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4073</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># start/stop</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4074</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4074</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4075</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4075</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4076</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4076</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4077</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4077</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4078</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4078</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4079</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4079</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4080</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4080</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4081</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4081</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4082</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4082</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4083</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4083</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4084</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4084</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4085</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4085</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4086</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4086</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># exceptions</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4087</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4087</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4088</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4088</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4089</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4089</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4090</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4090</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4091</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4091</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4092</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4092</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4093</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4093</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append_to_multiple, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df, </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4094</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4094</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4095</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4095</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># regular operation</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4096</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4096</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4097</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4097</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4098</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4098</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4099</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4099</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[(df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (df.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4101</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4102</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4103</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple_dropna</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4105</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4106</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, df1.columns.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4107</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4108</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4109</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4110</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># dropna=True should guarantee rows are synchronized</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4112</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4113</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4114</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4115</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">dropna</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4117</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_index_equal</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">).index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4119</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">).index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4120</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4121</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">run</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4122</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;append_to_multiple_dropna_false &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4123</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#183691;">&quot;is not raising as failed&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4124</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_to_multiple_dropna_false</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4125</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4127</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1.iloc[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, df1.columns.</span><span style="color:#0086b3;">get_indexer</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4128</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4129</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4131</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4132</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># dropna=False shouldn&apos;t synchronize row indexes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4134</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                {</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4135</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">dropna</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4136</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4137</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4138</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4139</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4140</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1a&apos;</span><span style="color:#333333;">).index.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4141</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2a&apos;</span><span style="color:#333333;">).index)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4142</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4143</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_as_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4144</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4146</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">().</span><span style="color:#0086b3;">rename</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">_2&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4147</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;bar&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4148</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4150</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># no tables stored</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4152</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4154</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4155</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, df1, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4156</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4157</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4158</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># exceptions</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4159</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4160</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4162</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#0086b3;">None</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4163</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4164</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4165</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4166</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4167</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4170</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df4&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4171</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4172</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># default select</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4173</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4174</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4179</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4180</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4181</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multiple</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4184</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[(expected.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">&amp;</span><span style="color:#333333;"> (expected.B </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4186</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4187</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4188</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># multiple (diff selector)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4190</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;index&gt;df2.index[4]&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df1, df2], </span><span style="color:#0086b3;">axis</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4192</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> expected[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4194</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># test excpection for diff rows</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4196</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, tm.</span><span style="color:#0086b3;">makeTimeDataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">nper</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">50</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4197</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.select_as_multiple,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4198</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          [</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&gt;0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&gt;0&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4199</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4200</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4201</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_nan_selection_bug_4858</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4202</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4203</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 4858; nan selection bug, only works for pytables &gt;= 3.1</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LooseVersion</span><span style="color:#333333;">(tables.__version__) </span><span style="color:#a71d5d;">&lt;</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;3.1.0&apos;</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4205</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;tables version does not support fix for nan &apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4206</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;selection bug: GH 4858&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4207</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4208</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4209</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4210</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">6</span><span style="color:#333333;">), </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">6</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4211</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;float64&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4212</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> (df[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">10</span><span style="color:#333333;">).</span><span style="color:#0086b3;">apply</span><span style="color:#333333;">(</span><span style="color:#0086b3;">str</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4213</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4214</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">cols</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;13.0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;14.0&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;15.0&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">values</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5.</span><span style="color:#333333;">]), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4217</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4218</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># write w/o the index on that particular column</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4219</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4219</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;cols&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4220</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;values&gt;2.0&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4222</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4224</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4225</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4226</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4228</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">), </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4229</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4230</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4231</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4232</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4233</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4234</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4235</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4236</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># out of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4237</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4238</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;columns=[&apos;A&apos;]&quot;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4240</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[</span><span style="color:#0086b3;">30</span><span style="color:#333333;">:</span><span style="color:#0086b3;">40</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4241</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4242</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4243</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_multiple</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4244</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4245</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 16209</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4246</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4247</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;foo&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&quot;bar&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4249</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4250</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append_to_multiple</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">None</span><span style="color:#333333;">}, df,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4251</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                     </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4252</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_as_multiple</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4253</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">selector</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;selector&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4254</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                              </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4255</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], [</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4256</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4257</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_start_stop_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4259</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4260</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4261</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4262</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># fixed, GH 8287</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4263</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4264</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">20</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4265</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130101&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">20</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4266</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4267</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4268</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4269</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4270</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4271</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4272</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4274</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4276</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4277</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># out of range</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4279</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4280</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">30</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">40</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4281</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[</span><span style="color:#0086b3;">30</span><span style="color:#333333;">:</span><span style="color:#0086b3;">40</span><span style="color:#333333;">, :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4282</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4283</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4284</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4285</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.A</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4287</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4288</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.iloc[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4289</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4290</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4292</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> s.iloc[</span><span style="color:#0086b3;">5</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4293</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4294</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># sparse; not implemented</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4297</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">:</span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4298</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.iloc[</span><span style="color:#0086b3;">8</span><span style="color:#333333;">:</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">-</span><span style="color:#0086b3;">2</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.nan</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4299</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dfs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">to_sparse</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dfs&apos;</span><span style="color:#333333;">, dfs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4301</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dfs&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">stop</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4303</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4304</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_select_filter_corner</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4305</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4306</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">50</span><span style="color:#333333;">, </span><span style="color:#0086b3;">100</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4307</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;</span><span style="color:#0086b3;">%.3d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> df.index]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.columns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;</span><span style="color:#0086b3;">%.3d</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> df.columns]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4309</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4310</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4311</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4312</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4313</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;columns=df.columns[:75]&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4314</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4315</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.loc[:, df.columns[:</span><span style="color:#0086b3;">75</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4316</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4317</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            crit </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;columns=df.columns[:75:2]&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4318</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, [crit])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df.loc[:, df.columns[:</span><span style="color:#0086b3;">75</span><span style="color:#333333;">:</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4320</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4321</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_pathlib</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4322</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4323</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4324</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4325</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4326</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4328</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4329</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;pathlib currently doesnt work with HDFStore&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_pathlib_hdfstore</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4331</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4332</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">writer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4335</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4336</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4337</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">reader</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4338</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(writer, reader)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4342</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4343</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pickle_path_localpath</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4344</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4345</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_pathlib</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4346</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4347</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">p</span><span style="color:#333333;">: pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(p, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4349</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">xfail</span><span style="color:#333333;">(</span><span style="color:#0086b3;">reason</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;localpath currently doesnt work with HDFStore&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_path_localpath_hdfstore</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4353</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">writer</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4355</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4356</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4357</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">reader</span><span style="color:#333333;">(</span><span style="color:#0086b3;">path</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4359</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4361</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">round_trip_localpath</span><span style="color:#333333;">(writer, reader)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4363</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4364</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4365</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4367</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4368</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> _default_compressor</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4369</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4370</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4371</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> obj</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4372</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4373</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4374</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_double_roundtrip</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4377</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4379</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> compression </span><span style="color:#a71d5d;">or</span><span style="color:#333333;"> _default_compressor</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4380</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4381</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4382</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> obj</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4385</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> retrieved</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4386</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            again </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4387</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(again, obj, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4388</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4389</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_check_roundtrip_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">obj</span><span style="color:#333333;">, </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">, </span><span style="color:#0086b3;">compression</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        options </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> {}</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4391</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compression:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            options[</span><span style="color:#183691;">&apos;complib&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> _default_compressor</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4393</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path, </span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">options) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, obj, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4396</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            retrieved </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4397</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4398</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">comparator</span><span style="color:#333333;">(retrieved, obj)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4399</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4400</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_multiple_open_close</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4401</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># gh-4409: open &amp; close multiple times</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4402</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4403</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4404</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4405</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4407</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4408</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># single</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4410</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4412</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4413</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4416</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4417</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4418</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4419</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> pytables._table_file_open_policy_is_strict:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4420</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># multiples</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4422</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4423</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4425</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4426</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4427</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store1.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4428</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4429</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4430</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4431</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># multiples</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4433</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4434</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4435</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4436</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4438</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store2.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4439</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store1.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4442</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store2.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4445</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4446</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4447</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store1)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4448</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store1.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4451</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4452</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># nested close</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4453</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4454</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4455</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4457</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4458</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4459</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4461</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4462</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4463</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4464</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4465</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4466</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># double closing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4467</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4468</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4469</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4470</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4474</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4475</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store2.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4476</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;CLOSED&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4477</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> store2.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4478</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4479</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># ops on a closed store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4480</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4481</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4482</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4483</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4484</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4486</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4487</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4488</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.keys)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4490</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: </span><span style="color:#0086b3;">len</span><span style="color:#333333;">(store))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4491</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;">: store.df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4493</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.select, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.get, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.append, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4496</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.put, </span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4497</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.get_storer, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4498</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(ClosedFileError, store.remove, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4499</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4500</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">f</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_raises_regex</span><span style="color:#333333;">(ClosedFileError, </span><span style="color:#183691;">&apos;file is not open&apos;</span><span style="color:#333333;">, f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4503</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pytables_native_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4505</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/pytables_native.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4508</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            d2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;detector/readout&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(d2, DataFrame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4511</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4512</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_pytables_native2_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4513</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># fails on win/3.5 oddly</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4514</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#0086b3;">PY35</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> </span><span style="color:#0086b3;">is_platform_windows</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;native2 read fails oddly on windows / 3.5&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4516</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4518</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/pytables_native2.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4519</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4521</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            d1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;detector&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(d1, DataFrame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4523</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_table_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4525</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># legacy table types</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/legacy_table.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4528</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4529</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4530</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4532</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4533</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4534</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4535</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># force the frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">typ</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;legacy_frame&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4537</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># old version warning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4539</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4540</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">Exception</span><span style="color:#333333;">, store.select, </span><span style="color:#183691;">&apos;wp1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;minor_axis=B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4541</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4542</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4543</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&gt;df2.index[2]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df2[df2.index </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> df2.index[</span><span style="color:#0086b3;">2</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4546</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4547</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_0_10_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># legacy from 0.10</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4550</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/legacy_0.10.h5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4551</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> k </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4554</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(k)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4555</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_0_11_read</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4557</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># legacy from 0.11</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;legacy_table_0.11.h5&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4559</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(path), </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4560</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4561</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4562</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4563</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4565</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df1 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df1&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            mi </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(df, DataFrame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(df1, DataFrame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(mi, DataFrame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4570</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4572</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4573</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4574</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4575</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">new_f</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">, </span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">None</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">, </span><span style="color:#a71d5d;">**</span><span style="color:#0086b3;">kwargs</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> f </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4579</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        f </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(os.path.</span><span style="color:#0086b3;">join</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4580</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                                          </span><span style="color:#183691;">&apos;legacy_0.10.h5&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4581</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(f, </span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4583</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> new_f </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4585</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> tempfile</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        fd, new_f </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tempfile.</span><span style="color:#0086b3;">mkstemp</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4587</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    tstore </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        new_f, </span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">keys, </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">propindexes, </span><span style="color:#a71d5d;">**</span><span style="color:#333333;">kwargs)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4590</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4591</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#969896;"># check keys</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> keys </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4593</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        keys </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4594</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(keys) </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set</span><span style="color:#333333;">(tstore.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4595</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4596</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#969896;"># check indicies &amp; nrows</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> k </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">keys</span><span style="color:#333333;">():</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4598</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k).is_table:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4599</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            new_t </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tstore.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            orig_t </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get_storer</span><span style="color:#333333;">(k)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4601</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4602</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> orig_t.nrows </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> new_t.nrows</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4603</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#969896;"># check propindixes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4605</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> propindexes:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> a </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> orig_t.axes:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> a.is_indexed:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4608</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                        </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> new_t[a.name].is_indexed</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4609</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4610</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4611</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4612</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_close</span><span style="color:#333333;">(tstore)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4613</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        os.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">(fd)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4615</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">except</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4616</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#a71d5d;">pass</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(new_f)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4618</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4620</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;/a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;/df1_mixed&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4622</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4623</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># new table</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4624</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4625</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4626</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">try</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4627</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                path </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">create_tempfile</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4628</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                st </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4629</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                st.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4630</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                st.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4631</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">do_copy</span><span style="color:#333333;">(</span><span style="color:#0086b3;">f</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">path, </span><span style="color:#0086b3;">propindexes</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">finally</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4634</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">safe_remove</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4635</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4636</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_table_write</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4637</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        pytest.</span><span style="color:#0086b3;">skip</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;cannot write legacy tables&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4638</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4640</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#183691;">&apos;legacy_hdf/legacy_table_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">.h5&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> pandas.__version__), </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4641</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDataFrame</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4643</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4644</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4644</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            wp </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePanel</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4645</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4645</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4646</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4646</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">MultiIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">levels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;baz&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;qux&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4647</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4647</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#183691;">&apos;one&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;two&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;three&apos;</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4648</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4648</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">labels</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4649</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4649</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   [</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4650</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4650</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">names</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4651</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4651</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4652</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4652</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4653</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4653</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;mi&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4654</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4654</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4655</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4655</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foo&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;bar&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4656</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4656</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">min_itemsize</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">{</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">200</span><span style="color:#333333;">})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4657</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4657</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;wp&apos;</span><span style="color:#333333;">, wp)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4658</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4658</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4659</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4659</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4660</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4660</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4661</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4661</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_datetime_fractional_secs</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4662</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4662</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4663</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4663</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4664</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4664</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            dt </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">datetime</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2012</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">123456</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4665</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4665</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], [dt])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4666</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4666</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> series</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4667</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4667</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">].index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> dt</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4668</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4668</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4669</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4669</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_indices_series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4670</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4670</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4671</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4671</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4672</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4672</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDateIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4673</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4673</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx)), idx)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4674</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4674</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ser</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4675</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4675</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4676</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4676</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4677</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4677</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ser)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4678</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4678</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ser.index.freq</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4679</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4679</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, ser.index, </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;series index&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4680</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4680</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4681</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4681</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePeriodIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4682</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4682</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ser </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx)), idx)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4683</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4683</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ser</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4684</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4684</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4685</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4685</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4686</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4686</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, ser)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4687</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4687</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> ser.index.freq</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4688</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4688</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, ser.index, </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;series index&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4689</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4689</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4690</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4690</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_indices_frame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4691</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4691</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4692</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4692</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4693</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4693</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeDateIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4694</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4694</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx), </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">idx)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4695</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4695</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4696</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4696</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4697</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4697</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4698</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4698</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4699</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4699</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> df.index.freq</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4700</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4700</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, df.index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4701</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4701</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;dataframe index&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4702</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4702</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4703</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4703</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            idx </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makePeriodIndex</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4704</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4704</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(idx), </span><span style="color:#0086b3;">3</span><span style="color:#333333;">), idx)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4705</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4705</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4706</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4706</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4707</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4707</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4708</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4708</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4709</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4709</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.index.freq </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> df.index.freq</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4710</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4710</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_class_equal</span><span style="color:#333333;">(result.index, df.index,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4711</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4711</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">obj</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;dataframe index&quot;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4712</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4712</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4713</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4713</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unicode_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4714</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4714</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4715</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4715</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        unicode_values </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\u03c3&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">u</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;\u03c3\u03c3&apos;</span><span style="color:#333333;">)]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4716</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4716</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4717</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4717</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># PerformanceWarning</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4718</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4718</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4719</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4719</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(unicode_values)), unicode_values)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4720</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4720</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(s, tm.assert_series_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4721</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4721</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4722</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4722</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_unicode_longer_encoded</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4723</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4723</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 11234</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4724</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4724</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        char </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;\u0394&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4725</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4725</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [char]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4726</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4726</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4727</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4727</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;utf-8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4728</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4728</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4729</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4729</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4730</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4730</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4731</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4731</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, char], </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4732</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4732</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4733</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4733</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">encoding</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;utf-8&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4734</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4734</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">get</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4735</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4735</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4736</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4736</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4737</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4737</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_datetime_mixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4738</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4738</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4739</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4739</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4740</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4740</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            {</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.</span><span style="color:#333333;">], </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4741</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4741</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeTimeSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4742</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4742</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df[</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> ts.index[:</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4743</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4743</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_check_roundtrip</span><span style="color:#333333;">(df, tm.assert_frame_equal)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4744</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4744</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4745</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4745</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;"># def test_cant_write_multiindex_table(self):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4746</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4746</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">#    # for now, #1848</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4747</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4747</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">#    df = DataFrame(np.random.randn(10, 4),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4748</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4748</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">#                   index=[np.arange(5).repeat(2),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4749</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4749</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">#                          np.tile(np.arange(2), 5)])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4750</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4750</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4751</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4751</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;">#    pytest.raises(Exception, store.put, &apos;foo&apos;, df, format=&apos;table&apos;)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4752</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4752</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4753</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4753</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_diff_col_name_types_raises_value_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4754</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4754</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4755</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4755</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4756</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4756</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4757</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4757</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df4 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4758</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4758</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df5 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({(</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">object</span><span style="color:#333333;">): np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4759</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4759</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4760</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4760</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4761</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4761</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;df_</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">rands</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4762</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4762</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(name, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4763</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4763</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4764</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4764</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> d </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> (df2, df3, df4, df5):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4765</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4765</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4766</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4766</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(name, d)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4767</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4767</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4768</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4768</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_with_nested_special_character</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4769</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4769</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4770</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4770</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#183691;">&apos;test &amp; test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;e&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4771</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4771</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">, </span><span style="color:#0086b3;">7</span><span style="color:#333333;">, </span><span style="color:#0086b3;">8</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4772</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4772</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.a </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;test &amp; test&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4773</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4773</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4774</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4774</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4775</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4775</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a = &quot;test &amp; test&quot;&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4776</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4776</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4777</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4777</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4778</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4778</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_categorical</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4779</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4779</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4780</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4780</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4781</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4781</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4782</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4782</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Basic</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4783</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4783</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4784</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4784</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4785</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4785</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4786</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4786</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4787</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4787</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4788</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4788</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4789</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4789</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4790</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4790</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4791</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4791</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4792</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4792</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4793</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4793</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4794</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4794</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s_ordered&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4795</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4795</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4796</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4796</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4797</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4797</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4798</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4798</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4799</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4799</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;s&quot;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&quot;vals&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">, </span><span style="color:#0086b3;">6</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4800</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4800</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4801</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4801</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4802</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4802</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4803</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4803</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4804</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4804</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Dtypes</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4805</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4805</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4806</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4806</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4807</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4807</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4808</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4808</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4809</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4809</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4810</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4810</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1</span><span style="color:#333333;">, np.nan, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">]).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4811</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4811</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si2&apos;</span><span style="color:#333333;">, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4812</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4812</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;si2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4813</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4813</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4814</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4814</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4815</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4815</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Multiple</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4816</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4816</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4817</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4817</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df2[</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcdefg&apos;</span><span style="color:#333333;">)).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4818</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4818</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4819</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4819</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4820</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4820</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df2)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4821</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4821</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4822</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4822</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Make sure the metadata is OK</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4823</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4823</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2   &apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4824</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4824</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2/meta/values_block_0/meta&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4825</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4825</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;/df2/meta/values_block_1/meta&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">str</span><span style="color:#333333;">(store)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4826</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4826</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4827</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4827</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># unordered</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4828</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4828</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">Categorical</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">categories</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4829</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4829</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">ordered</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4830</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4830</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">, s, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4831</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4831</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;s2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4832</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4832</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, s)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4833</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4833</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4834</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4834</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Query</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4835</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4835</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4836</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4836</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4837</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4837</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4838</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4838</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4839</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4839</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4840</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4840</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4841</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4841</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s = [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4842</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4842</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4843</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4843</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4844</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4844</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4845</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4845</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;d&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4846</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4846</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4847</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4847</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4848</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4848</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;f&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4849</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4849</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;f&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4850</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4850</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4851</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4851</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4852</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4852</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Appending with same categories is ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4853</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4853</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4854</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4854</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4855</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4855</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4856</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4856</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.s.</span><span style="color:#0086b3;">isin</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">])]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4857</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4857</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;s in [&quot;b&quot;,&quot;c&quot;]&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4858</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4858</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4859</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4859</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4860</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4860</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Appending must have the same categories</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4861</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4861</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">copy</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4862</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4862</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df3[</span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">].cat.</span><span style="color:#0086b3;">remove_unused_categories</span><span style="color:#333333;">(</span><span style="color:#0086b3;">inplace</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4863</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4863</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4864</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4864</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4865</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4865</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">, df3)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4866</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4866</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4867</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4867</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># Remove, and make sure meta data is removed (its a recursive</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4868</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4868</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># removal so should be).</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4869</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4869</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3/meta/s/meta&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4870</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4870</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result </span><span style="color:#a71d5d;">is</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> </span><span style="color:#0086b3;">None</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4871</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4871</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">remove</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4872</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4872</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4873</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4873</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">KeyError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4874</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4874</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df3/meta/s/meta&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4875</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4875</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4876</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4876</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_categorical_conversion</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4877</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4877</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4878</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4878</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH13322</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4879</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4879</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Check that read_hdf with categorical columns doesn&apos;t return rows if</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4880</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4880</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># where criteria isn&apos;t met.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4881</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4881</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        obsids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;ESP_012345_6789&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;ESP_987654_3210&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4882</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4882</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        imgids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;APF00006np&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;APF0001imm&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4883</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4883</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        data </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">4.3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9.8</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4884</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4884</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4885</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4885</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Test without categories</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4886</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4886</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">obsids</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">obsids, </span><span style="color:#0086b3;">imgids</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">imgids, </span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">data))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4887</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4887</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4888</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4888</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># We are expecting an empty DataFrame matching types of df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4889</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4889</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4890</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4890</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4891</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4891</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4892</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4892</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;obsids=B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4893</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4893</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4894</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4894</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4895</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4895</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Test with categories</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4896</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4896</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.obsids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.obsids.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4897</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4897</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.imgids </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.imgids.</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4898</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4898</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4899</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4899</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># We are expecting an empty DataFrame matching types of df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4900</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4900</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.iloc[[], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4901</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4901</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4902</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4902</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4903</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4903</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;obsids=B&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4904</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4904</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4905</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4905</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4906</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4906</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_duplicate_column_name</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4907</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4907</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&quot;a&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;a&quot;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">data</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">0</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4908</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4908</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4909</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4909</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4910</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4910</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, df.to_hdf,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4911</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4911</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4912</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4912</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4913</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4913</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4914</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4914</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            other </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4915</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4915</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4916</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4916</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, other)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4917</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4917</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(other)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4918</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4918</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> other.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4919</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4919</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4920</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4920</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_round_trip_equals</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4921</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4921</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 9330</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4922</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4922</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&quot;B&quot;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], </span><span style="color:#183691;">&quot;A&quot;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&quot;x&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;y&quot;</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4923</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4923</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4924</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4924</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4925</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4925</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4926</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4926</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            other </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4927</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4927</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, other)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4928</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4928</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(other)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4929</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4929</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> other.</span><span style="color:#0086b3;">equals</span><span style="color:#333333;">(df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4930</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4930</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4931</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4931</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_preserve_timedeltaindex_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4932</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4932</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH9635</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4933</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4933</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Storing TimedeltaIndexed DataFrames in fixed stores did not preserve</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4934</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4934</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># the type of the index.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4935</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4935</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">normal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">size</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">)))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4936</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4936</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta_range</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4937</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4937</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">start</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;0s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;1s&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">name</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;example&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4938</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4938</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4939</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4939</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4940</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4940</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4941</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4941</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4942</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4942</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">], df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4943</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4943</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4944</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4944</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_colums_multiindex_modified</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4945</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4945</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># BUG: 7212</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4946</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4946</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># read_hdf store.select modified the passed columns parameters</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4947</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4947</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># when multi-indexed.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4948</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4948</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4949</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4949</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4950</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4950</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4951</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4951</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4952</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4952</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4953</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4953</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4954</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4954</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4955</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4955</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        data_columns </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.index.names </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> df.columns.</span><span style="color:#0086b3;">tolist</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4956</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4956</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4957</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4957</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4958</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4958</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                      </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4959</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4959</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                      </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4960</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4960</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                      </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">data_columns,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4961</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4961</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                      </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4962</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4962</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            cols2load </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;BCD&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4963</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4963</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            cols2load_original </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">list</span><span style="color:#333333;">(cols2load)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4964</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4964</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df_loaded </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">cols2load)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4965</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4965</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> cols2load_original </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> cols2load</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4966</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4966</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4967</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4967</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_to_hdf_with_object_column_names</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4968</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4968</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH9057</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4969</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4969</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Writing HDF5 table format should only work for string-like</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4970</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4970</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># column types</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4971</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4971</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4972</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4972</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        types_should_fail </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.makeIntIndex, tm.makeFloatIndex,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4973</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4973</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             tm.makeDateIndex, tm.makeTimedeltaIndex,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4974</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4974</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             tm.makePeriodIndex]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4975</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4975</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        types_should_run </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.makeStringIndex, tm.makeCategoricalIndex]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4976</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4976</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4977</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4977</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> compat.</span><span style="color:#0086b3;">PY3</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4978</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4978</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            types_should_run.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(tm.makeUnicodeIndex)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4979</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4979</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4980</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4980</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            types_should_fail.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(tm.makeUnicodeIndex)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4981</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4981</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4982</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4982</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> types_should_fail:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4983</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4983</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4984</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4984</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4985</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4985</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4986</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4986</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4987</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4987</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, </span><span style="color:#0086b3;">msg</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;cannot have non-object label &quot;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4988</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4988</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                         </span><span style="color:#183691;">&quot;DataIndexableCol&quot;</span><span style="color:#333333;">)):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4989</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4989</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4990</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4990</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4991</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4991</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4992</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4992</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> index </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> types_should_run:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4993</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4993</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">10</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">), </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4994</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4994</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4995</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4995</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4996</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4996</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4997</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4997</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4998</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4998</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;index = [{</span><span style="color:#0086b3;">0</span><span style="color:#183691;">}]&quot;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(df.index[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">4999</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">4999</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(result))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5000</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5000</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5001</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5001</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_open_store</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5002</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5002</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH10330</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5003</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5003</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># No check for non-string path_or-buf, and no test of open store</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5004</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5004</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5005</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5005</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5006</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5006</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5007</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5007</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5008</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5008</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5009</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5009</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5010</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5010</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5011</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5011</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5012</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5012</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            direct </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5013</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5013</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5014</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5014</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            indirect </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5015</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5015</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(direct, indirect)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5016</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5016</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> store.is_open</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5017</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5017</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5018</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5018</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5019</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5019</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_iterator</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5020</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5020</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5021</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5021</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5022</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5022</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5023</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5023</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df.index.name </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;letters&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5024</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5024</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.</span><span style="color:#0086b3;">set_index</span><span style="color:#333333;">(</span><span style="color:#0086b3;">keys</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">append</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5025</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5025</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5026</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5026</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5027</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5027</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5028</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5028</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            direct </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5029</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5029</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            iterator </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">iterator</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5030</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5030</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> </span><span style="color:#0086b3;">isinstance</span><span style="color:#333333;">(iterator, TableIterator)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5031</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5031</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            indirect </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">next</span><span style="color:#333333;">(iterator.</span><span style="color:#0086b3;">__iter__</span><span style="color:#333333;">())</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5032</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5032</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(direct, indirect)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5033</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5033</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            iterator.store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5034</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5034</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5035</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5035</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_errors</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5036</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5036</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5037</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5037</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5038</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5038</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5039</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5039</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5040</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5040</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5041</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5041</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, read_hdf, path, </span><span style="color:#183691;">&apos;key&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5042</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5042</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5043</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5043</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5044</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5044</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5045</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5045</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">IOError</span><span style="color:#333333;">, read_hdf, store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5046</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5046</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">open</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5047</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5047</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">NotImplementedError</span><span style="color:#333333;">, read_hdf, store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5048</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5048</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5049</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5049</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_invalid_complib</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5050</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5050</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5051</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5051</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5052</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5052</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5053</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5053</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5054</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5054</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5055</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5055</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">complib</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;foolib&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5056</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5056</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;"># GH10443</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5057</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5057</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5058</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5058</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5059</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5059</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5060</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5060</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5061</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5061</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5062</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5062</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5063</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5063</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Categorical dtype not supported for &quot;fixed&quot; format. So no need</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5064</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5064</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># to test with that dtype in the dataframe here.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5065</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5065</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5066</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5066</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5067</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5067</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5068</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5068</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5069</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5069</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5070</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5070</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5071</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5071</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5072</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5072</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5073</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5073</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH13231</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5074</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5074</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;i&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5075</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5075</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abacd&apos;</span><span style="color:#333333;">), </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;category&apos;</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5076</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5076</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5077</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5077</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5078</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5078</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5079</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5079</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5080</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5080</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5081</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5081</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df2&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5082</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5082</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5083</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5083</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5084</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5084</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_nokey_empty</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5085</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5085</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5086</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5086</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">HDFStore</span><span style="color:#333333;">(path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5087</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5087</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">close</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5088</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5088</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, read_hdf, path)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5089</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5089</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5090</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5090</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_from_pathlib_path</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5091</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5091</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5092</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5092</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH11773</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5093</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5093</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_pathlib</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5094</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5094</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5095</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5095</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pathlib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> Path</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5096</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5096</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5097</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5097</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5098</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5098</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5099</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5099</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5100</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5100</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> filename:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5101</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5101</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            path_obj </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Path</span><span style="color:#333333;">(filename)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5102</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5102</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5103</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5103</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5104</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5104</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5105</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5105</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5106</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5106</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, actual)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5107</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5107</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5108</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5108</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_from_py_localpath</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5109</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5109</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5110</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5110</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH11773</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5111</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5111</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_localpath</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5112</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5112</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5113</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5113</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> py.path </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> local </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> LocalPath</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5114</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5114</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5115</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5115</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5116</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5116</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5117</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5117</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5118</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5118</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> filename:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5119</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5119</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            path_obj </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">LocalPath</span><span style="color:#333333;">(filename)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5120</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5120</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5121</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5121</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5122</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5122</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            actual </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path_obj, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5123</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5123</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5124</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5124</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, actual)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5125</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5125</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5126</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5126</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_long_float_literal</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5127</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5127</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 14241</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5128</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5128</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1000000000.0009</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5129</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5129</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#0086b3;">1000000000.0011</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5130</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5130</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                 </span><span style="color:#0086b3;">1000000000.0015</span><span style="color:#333333;">]})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5131</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5131</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5132</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5132</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5133</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5133</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5134</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5134</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5135</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5135</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            cutoff </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0006</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5136</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5136</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;A &lt; </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> cutoff)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5137</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5137</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> result.empty</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5138</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5138</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5139</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5139</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            cutoff </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0010</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5140</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5140</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;A &gt; </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> cutoff)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5141</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5141</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5142</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5142</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5143</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5143</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5144</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5144</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            exact </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1000000000.0011</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5145</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5145</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;A == </span><span style="color:#0086b3;">%.4f</span><span style="color:#183691;">&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> exact)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5146</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5146</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5147</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5147</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5148</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5148</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5149</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5149</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_query_compare_column_type</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5150</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5150</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 15492</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5151</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5151</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2014-01-02&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5152</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5152</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">2</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5153</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5153</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.2</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5154</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5154</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">]},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5155</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5155</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5156</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5156</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5157</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5157</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5158</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5158</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5159</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5159</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5160</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5160</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            ts </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">)  </span><span style="color:#969896;"># noqa</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5161</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5161</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;real_date &gt; ts&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5162</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5162</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5163</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5163</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5164</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5164</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5165</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5165</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;&lt;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;&gt;&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;==&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5166</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5166</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># non strings to string column always fail</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5167</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5167</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#0086b3;">2.1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">True</span><span style="color:#333333;">, pd.</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5168</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5168</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          pd.</span><span style="color:#0086b3;">Timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;s&apos;</span><span style="color:#333333;">)]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5169</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5169</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;date {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5170</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5170</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5171</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5171</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5172</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5172</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5173</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5173</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#969896;"># strings to other columns must be convertible to type</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5174</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5174</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                v </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;a&apos;</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5175</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5175</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> col </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5176</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5176</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;{</span><span style="color:#0086b3;">col</span><span style="color:#183691;">} {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op, </span><span style="color:#0086b3;">col</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5177</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5177</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5178</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5178</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5179</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5179</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5180</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5180</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> v, col </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">([</span><span style="color:#183691;">&apos;1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1.1&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2014-01-01&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5181</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5181</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  [</span><span style="color:#183691;">&apos;int&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;float&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;real_date&apos;</span><span style="color:#333333;">]):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5182</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5182</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    query </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;{</span><span style="color:#0086b3;">col</span><span style="color:#183691;">} {</span><span style="color:#0086b3;">op</span><span style="color:#183691;">} v&apos;</span><span style="color:#333333;">.</span><span style="color:#0086b3;">format</span><span style="color:#333333;">(</span><span style="color:#0086b3;">op</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">op, </span><span style="color:#0086b3;">col</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">col)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5183</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5183</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;test&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">query)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5184</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5184</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5185</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5185</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;==&apos;</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5186</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5186</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">0</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5187</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5187</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">elif</span><span style="color:#333333;"> op </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#183691;">&apos;&gt;&apos;</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5188</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5188</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[</span><span style="color:#0086b3;">1</span><span style="color:#333333;">], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5189</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5189</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">else</span><span style="color:#333333;">:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5190</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5190</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df.loc[[], :]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5191</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5191</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(expected, result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5192</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5192</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5193</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5193</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    &#64;pytest.mark.</span><span style="color:#0086b3;">parametrize</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;format&apos;</span><span style="color:#333333;">, [</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5194</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5194</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_hdf_series_mode_r</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5195</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5195</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 16583</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5196</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5196</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># Tests that reading a Series saved to an HDF file</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5197</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5197</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># still works if a mode=&apos;r&apos; argument is supplied</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5198</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5198</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        series </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> tm.</span><span style="color:#0086b3;">makeFloatSeries</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5199</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5199</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5200</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5200</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            series.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">format</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5201</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5201</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#0086b3;">key</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;data&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5202</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5202</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(result, series)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5203</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5203</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5204</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5204</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_read_py2_hdf_file_in_py3</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5205</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5205</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH 16781</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5206</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5206</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5207</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5207</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># tests reading a PeriodIndex DataFrame written in Python2 in Python3</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5208</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5208</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5209</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5209</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># the file was generated in Python 2.7 like so:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5210</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5210</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;">#</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5211</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5211</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># df = pd.DataFrame([1.,2,3], index=pd.PeriodIndex(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5212</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5212</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;">#              [&apos;2015-01-01&apos;, &apos;2015-01-02&apos;, &apos;2015-01-05&apos;], freq=&apos;B&apos;))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5213</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5213</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># df.to_hdf(&apos;periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;, &apos;p&apos;)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5214</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5214</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5215</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5215</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">pd.</span><span style="color:#0086b3;">PeriodIndex</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5216</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5216</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            [</span><span style="color:#183691;">&apos;2015-01-01&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2015-01-02&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;2015-01-05&apos;</span><span style="color:#333333;">], </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5217</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5217</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5218</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5218</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#870000;">5219</span><span style="color:#0000ee;">⋮</span><span style="color:#008700;">    </span><span style="color:#0000ee;">│</span><span style="background-color:#ffe0e0;">                tm.get_data_path(</span><span style="background-color:#ffc0c0;">&apos;periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;),</span><span style="background-color:#ffe0e0;"></span>
<span style="color:#0000ee;"></span><span style="color:#870000;">    </span><span style="color:#0000ee;">⋮</span><span style="color:#008700;">5219</span><span style="color:#0000ee;">│</span><span style="color:#333333;background-color:#d0ffd0;">                tm.</span><span style="color:#0086b3;background-color:#d0ffd0;">get_data_path</span><span style="color:#333333;background-color:#d0ffd0;">(</span><span style="background-color:#d0ffd0;"></span>
<span style="color:#0000ee;"></span><span style="color:#870000;">    </span><span style="color:#0000ee;">⋮</span><span style="color:#008700;">5220</span><span style="color:#0000ee;">│</span><span style="color:#333333;background-color:#d0ffd0;">                    </span><span style="color:#183691;background-color:#d0ffd0;">&apos;legacy_hdf/periodindex_0.20.1_x86_64_darwin_2.7.13.h5&apos;</span><span style="color:#333333;background-color:#d0ffd0;">),</span><span style="background-color:#d0ffd0;"></span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5220</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5221</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5221</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5222</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;p&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5222</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5223</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5223</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5224</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5224</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5225</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5225</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5226</span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestHDFComplexValues(</span>Base<span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5226</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5227</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#969896;"># GH10447</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5227</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5228</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5228</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5229</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5229</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5230</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex64),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5230</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5231</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5231</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5232</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5232</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5233</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5233</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5234</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5234</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5235</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5235</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5236</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5236</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5237</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5237</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5238</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5238</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5239</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5239</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5240</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5240</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5241</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5241</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5242</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5242</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5243</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5243</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5244</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5244</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5245</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5245</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5246</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5246</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5247</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5247</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5248</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex64),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5248</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5249</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5249</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5250</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5250</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5251</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5251</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5252</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5252</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5253</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5253</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5254</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5254</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5255</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5255</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5256</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5256</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5257</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">rand</span><span style="color:#333333;">(</span><span style="color:#0086b3;">4</span><span style="color:#333333;">, </span><span style="color:#0086b3;">5</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5257</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5258</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5258</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5259</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">columns</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;ABCDE&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5259</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5260</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5260</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5261</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5261</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5262</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;w&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5262</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5263</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5263</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5264</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5264</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5265</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5265</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5266</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_mixed_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5266</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5267</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex64 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5267</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5268</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex64)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5268</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5269</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5269</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5270</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5270</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5271</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5271</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5272</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5272</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5273</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex64,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5273</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5274</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: complex128,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5274</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5275</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.0</span><span style="color:#333333;">]},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5275</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5276</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5276</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5277</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5277</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5278</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5278</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5279</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5279</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5280</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5280</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5281</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5281</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5282</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_mixed_table</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5282</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5283</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex64 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5283</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5284</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">], </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex64)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5284</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5285</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5285</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5286</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5286</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5287</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5287</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5288</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5288</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5289</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex64,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5289</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5290</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: complex128,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5290</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5291</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;E&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3.0</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4.0</span><span style="color:#333333;">]},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5291</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5292</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5292</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5293</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5293</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5294</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5294</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5295</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5295</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5296</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;2&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5296</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5297</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df.loc[df.A </span><span style="color:#a71d5d;">&gt;</span><span style="color:#333333;"> </span><span style="color:#0086b3;">2</span><span style="color:#333333;">], result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5297</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5298</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5298</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5299</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5299</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5300</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5300</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5301</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5301</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5302</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(df, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5302</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5303</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5303</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5304</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_across_dimensions_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5304</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5305</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5305</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5306</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5306</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5307</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                [</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5307</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5308</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5308</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5309</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5309</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5310</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;One&apos;</span><span style="color:#333333;">: df, </span><span style="color:#183691;">&apos;Two&apos;</span><span style="color:#333333;">: df})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5310</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5311</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5311</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5312</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            objs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [s, df, p]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5312</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5313</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            comps </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.assert_series_equal, tm.assert_frame_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5313</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5314</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                     tm.assert_panel_equal]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5314</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5315</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> obj, comp </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">(objs, comps):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5315</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5316</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5316</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5317</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;fixed&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5317</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5318</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5318</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5319</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">comp</span><span style="color:#333333;">(obj, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5319</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5320</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5320</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5321</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_across_dimensions</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5321</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5322</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5322</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5323</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5323</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5324</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: s, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: s})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5324</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5325</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5325</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5326</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">catch_warnings</span><span style="color:#333333;">(</span><span style="color:#0086b3;">record</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">True</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5326</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5327</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            p </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;One&apos;</span><span style="color:#333333;">: df, </span><span style="color:#183691;">&apos;Two&apos;</span><span style="color:#333333;">: df})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5327</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5328</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            p4d </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Panel4D</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;i&apos;</span><span style="color:#333333;">: p, </span><span style="color:#183691;">&apos;ii&apos;</span><span style="color:#333333;">: p})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5328</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5329</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5329</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5330</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            objs </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [df, p, p4d]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5330</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5331</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            comps </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> [tm.assert_frame_equal, tm.assert_panel_equal,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5331</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5332</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                     tm.assert_panel4d_equal]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5332</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5333</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> obj, comp </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">zip</span><span style="color:#333333;">(objs, comps):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5333</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5334</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5334</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5335</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    obj.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;table&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5335</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5336</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5336</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5337</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#0086b3;">comp</span><span style="color:#333333;">(obj, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5337</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5338</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5338</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5339</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_indexing_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5339</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5340</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5340</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5341</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                              </span><span style="color:#0086b3;">dtype</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">np.complex128)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5341</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5342</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: [</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">4</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5342</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5343</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: [</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;c&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;d&apos;</span><span style="color:#333333;">],</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5343</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5344</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: complex128},</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5344</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5345</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                       </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5345</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5346</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5346</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5347</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, store.append,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5347</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5348</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                          </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5348</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5349</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5349</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5350</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_series_error</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5350</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5351</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        complex128 </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> np.</span><span style="color:#0086b3;">array</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">, </span><span style="color:#0086b3;">1.0</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">1.0</span><span style="color:#a71d5d;">j</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5351</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5352</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        s </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(complex128, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">list</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;abcd&apos;</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5352</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5353</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5353</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5354</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5354</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5355</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">TypeError</span><span style="color:#333333;">, s.to_hdf, path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5355</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5356</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5356</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5357</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_path</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> path:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5357</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5358</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            s.</span><span style="color:#0086b3;">to_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">format</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;t&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">False</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5358</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5359</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            reread </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">read_hdf</span><span style="color:#333333;">(path, </span><span style="color:#183691;">&apos;obj&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5359</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5360</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_series_equal</span><span style="color:#333333;">(s, reread)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5360</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5361</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5361</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5362</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_complex_append</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5362</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5363</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;a&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">).</span><span style="color:#0086b3;">astype</span><span style="color:#333333;">(np.complex128),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5363</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5364</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">: np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">100</span><span style="color:#333333;">)})</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5364</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5365</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5365</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5366</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5366</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5367</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;b&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5367</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5368</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5368</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5369</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5369</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5370</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(pd.</span><span style="color:#0086b3;">concat</span><span style="color:#333333;">([df, df], </span><span style="color:#0086b3;">0</span><span style="color:#333333;">), result)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5370</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5371</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5371</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5372</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5372</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5373</span><span style="color:#0000ee;">│</span><span style="color:#a71d5d;">class</span><span style="color:#333333;"> TestTimezones(</span>Base<span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5373</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5374</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5374</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5375</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">_compare_with_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">, </span><span style="color:#0086b3;">a</span><span style="color:#333333;">, </span><span style="color:#0086b3;">b</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5375</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5376</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(a, b)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5376</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5377</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5377</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5378</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># compare the zones on each element</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5378</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5379</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> c </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> a.columns:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5379</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5380</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> a.index:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5380</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5381</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                a_e </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> a.loc[i, c]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5381</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5382</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                b_e </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> b.loc[i, c]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5382</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5383</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#a71d5d;">if</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">not</span><span style="color:#333333;"> (a_e </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> b_e </span><span style="color:#a71d5d;">and</span><span style="color:#333333;"> a_e.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> b_e.tz):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5383</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5384</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                    </span><span style="color:#a71d5d;">raise</span><span style="color:#333333;"> </span><span style="color:#0086b3;">AssertionError</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5384</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5385</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                        </span><span style="color:#183691;">&quot;invalid tz comparsion [</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">] [</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">]&quot;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">%</span><span style="color:#333333;"> (a_e, b_e))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5385</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5386</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5386</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5387</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timezones_dateutil</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5387</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5388</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5388</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5389</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5389</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5390</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        tm.</span><span style="color:#0086b3;">_skip_if_no_dateutil</span><span style="color:#333333;">()</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5390</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5391</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5391</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5392</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># use maybe_get_tz instead of dateutil.tz.gettz to handle the windows</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5392</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5393</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># filename issues.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5393</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5394</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> pandas._libs.tslib </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> maybe_get_tz</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5394</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5395</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        gettz </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">lambda</span><span style="color:#333333;"> </span><span style="color:#0086b3;">x</span><span style="color:#333333;">: </span><span style="color:#0086b3;">maybe_get_tz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;dateutil/&apos;</span><span style="color:#333333;"> </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> x)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5395</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5396</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5396</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5397</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># as columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5397</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5398</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5398</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5399</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5399</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5400</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5400</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5401</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102 2:00:00&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5401</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5402</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)) </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">hours</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5402</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5403</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5403</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5404</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5404</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5405</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5405</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5406</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5406</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5407</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5407</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5408</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5408</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5409</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select with tz aware</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5409</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5410</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df[df.A </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> df.A[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5410</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5411</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;=df.A[3]&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5411</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5412</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5412</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5413</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5413</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5414</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># ensure we include dates in DST and STD time here.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5414</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5415</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5415</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5416</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5416</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5417</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5417</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5418</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5418</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5419</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5419</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5420</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5420</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5421</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5421</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5422</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5422</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5423</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5423</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5424</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5424</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5425</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5425</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5426</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5426</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5427</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5427</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5428</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;EET&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5428</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5429</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5429</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5430</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5430</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5431</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5431</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5432</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5432</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5433</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5433</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5434</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5434</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5435</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5435</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5436</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5436</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5437</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5437</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5438</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5438</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5439</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t append with diff timezone</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5439</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5440</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5440</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5441</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                            </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5441</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5442</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">))),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5442</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5443</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5443</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5444</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5444</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5445</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5445</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5446</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># as index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5446</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5447</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5447</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5448</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5448</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5449</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH 4098 example</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5449</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5450</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5450</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5451</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">gettz</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5451</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5452</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5452</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5453</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5453</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5454</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5454</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5455</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5455</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5456</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5456</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5457</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5457</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5458</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5458</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5459</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5459</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5460</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5460</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5461</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5461</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5462</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5462</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5463</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_append_with_timezones_pytz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5463</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5464</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5464</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5465</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">from</span><span style="color:#333333;"> datetime </span><span style="color:#a71d5d;">import</span><span style="color:#333333;"> timedelta</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5465</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5466</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5466</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5467</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># as columns</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5467</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5468</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5468</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5469</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5469</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5470</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5470</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5471</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102 2:00:00&apos;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5471</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5472</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                             </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">+</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5472</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5473</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   </span><span style="color:#0086b3;">timedelta</span><span style="color:#333333;">(</span><span style="color:#0086b3;">hours</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">1</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">*</span><span style="color:#333333;"> i</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5473</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5474</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                   </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">)]))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5474</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5475</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5475</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5476</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5476</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5477</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5477</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5478</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5478</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5479</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5479</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5480</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># select with tz aware</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5480</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5481</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5481</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5482</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">where</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;A&gt;=df.A[3]&apos;</span><span style="color:#333333;">), df[df.A </span><span style="color:#a71d5d;">&gt;=</span><span style="color:#333333;"> df.A[</span><span style="color:#0086b3;">3</span><span style="color:#333333;">]])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5482</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5483</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5483</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5484</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5484</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5485</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># ensure we include dates in DST and STD time here.</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5485</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5486</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5486</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5487</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5487</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5488</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5488</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5489</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5489</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5490</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5490</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5491</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5491</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5492</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5492</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5493</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5493</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5494</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5494</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5495</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;EET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5495</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5496</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5496</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5497</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5497</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5498</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5498</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5499</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># this is ok</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5499</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5500</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5500</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5501</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df, </span><span style="color:#0086b3;">data_columns</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5501</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5502</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5502</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5503</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#df5000;">self</span><span style="color:#333333;">.</span><span style="color:#0086b3;">_compare_with_tz</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5503</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5504</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5504</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5505</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5505</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5506</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># can&apos;t append with diff timezone</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5506</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5507</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5507</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5508</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5508</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5509</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                           </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5509</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5510</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            pytest.</span><span style="color:#0086b3;">raises</span><span style="color:#333333;">(</span><span style="color:#0086b3;">ValueError</span><span style="color:#333333;">, store.append, </span><span style="color:#183691;">&apos;df_tz&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5510</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5511</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5511</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5512</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># as index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5512</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5513</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5513</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5514</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5514</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5515</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH 4098 example</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5515</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5516</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Series</span><span style="color:#333333;">(</span><span style="color:#0086b3;">lrange</span><span style="color:#333333;">(</span><span style="color:#0086b3;">3</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5516</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5517</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#183691;">&apos;2000-1-1&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">periods</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">3</span><span style="color:#333333;">, </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;H&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">))))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5517</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5518</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5518</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5519</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5519</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5520</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">put</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5520</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5521</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5521</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5522</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5522</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5523</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5523</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5524</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5524</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5525</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5525</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5526</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5526</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5527</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5527</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5528</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5528</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5529</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_tseries_select_index_column</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5529</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5530</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH7777</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5530</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5531</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># selecting a UTC datetimeindex column did</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5531</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5532</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># not preserve UTC tzinfo set before storing</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5532</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5533</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5533</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5534</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># check that no tz still works</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5534</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5535</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5535</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5536</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5536</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5537</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5537</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5538</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5538</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5539</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5539</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5540</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5540</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5541</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DatetimeIndex</span><span style="color:#333333;">(result.values).tz</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5541</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5542</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5542</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5543</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># check utc</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5543</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5544</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5544</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5545</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5545</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5546</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5546</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5547</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5547</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5548</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5548</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5549</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5549</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5550</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> result.dt.tz</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5550</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5551</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5551</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5552</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># double check non-utc</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5552</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5553</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5553</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5554</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5554</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5555</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5555</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5556</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5556</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5557</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, frame)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5557</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5558</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select_column</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;index&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5558</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5559</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> result.dt.tz</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5559</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5560</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5560</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5561</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_timezones_fixed</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5561</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5562</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5562</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5563</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5563</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5564</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># index</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5564</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5565</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5565</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5566</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5566</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5567</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5567</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5568</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5568</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5569</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5569</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5570</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5570</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5571</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># as data</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5571</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5572</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#969896;"># GH11411</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5572</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5573</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5573</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5574</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: rng,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5574</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5575</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: rng.</span><span style="color:#0086b3;">tz_convert</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;UTC&apos;</span><span style="color:#333333;">).</span><span style="color:#0086b3;">tz_localize</span><span style="color:#333333;">(</span><span style="color:#0086b3;">None</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5575</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5576</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;C&apos;</span><span style="color:#333333;">: rng.</span><span style="color:#0086b3;">tz_convert</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5576</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5577</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                            </span><span style="color:#183691;">&apos;D&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng))}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5577</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5578</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5578</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5579</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5579</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5580</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5580</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5581</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5581</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5582</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_fixed_offset_tz</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5582</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5583</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        rng </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;1/1/2000 00:00:00-07:00&apos;</span><span style="color:#333333;">, </span><span style="color:#183691;">&apos;1/30/2000 00:00:00-07:00&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5583</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5584</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        frame </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(np.random.</span><span style="color:#0086b3;">randn</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(rng), </span><span style="color:#0086b3;">4</span><span style="color:#333333;">), </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5584</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5585</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5585</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5586</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5586</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5587</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> frame</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5587</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5588</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            recons </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;frame&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5588</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5589</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            tm.</span><span style="color:#0086b3;">assert_index_equal</span><span style="color:#333333;">(recons.index, rng)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5589</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5590</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">assert</span><span style="color:#333333;"> rng.tz </span><span style="color:#a71d5d;">==</span><span style="color:#333333;"> recons.index.tz</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5590</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5591</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5591</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5592</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_store_timezone</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5592</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5593</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># GH2852</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5593</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5594</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># issue storing datetime.date with a timezone as it resets when read</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5594</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5595</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># back in a new timezone</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5595</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5596</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5596</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5597</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># original method</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5597</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5598</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5598</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5599</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5599</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5600</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            today </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5600</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5601</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[today, today, today])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5601</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5602</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5602</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5603</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5603</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5604</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5604</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5605</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5605</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5606</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># with tz setting</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5606</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5607</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5607</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5608</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5608</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5609</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set_timezone</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;EST5EDT&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5609</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5610</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                today </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> datetime.</span><span style="color:#0086b3;">date</span><span style="color:#333333;">(</span><span style="color:#0086b3;">2013</span><span style="color:#333333;">, </span><span style="color:#0086b3;">9</span><span style="color:#333333;">, </span><span style="color:#0086b3;">10</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5610</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5611</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">([</span><span style="color:#0086b3;">1</span><span style="color:#333333;">, </span><span style="color:#0086b3;">2</span><span style="color:#333333;">, </span><span style="color:#0086b3;">3</span><span style="color:#333333;">], </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">[today, today, today])</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5611</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5612</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">] </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> df</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5612</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5613</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5613</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5614</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">set_timezone</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;CST6CDT&apos;</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5614</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5615</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;obj1&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5615</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5616</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5616</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5617</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5617</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5618</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5618</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5619</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_legacy_datetimetz_object</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5619</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5620</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># legacy from &lt; 0.17.0</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5620</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5621</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># 8260</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5621</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5622</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        expected </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">(</span><span style="color:#0086b3;">dict</span><span style="color:#333333;">(</span><span style="color:#0086b3;">A</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130102&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;US/Eastern&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5622</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5623</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">B</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">Timestamp</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;20130603&apos;</span><span style="color:#333333;">, </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;CET&apos;</span><span style="color:#333333;">)),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5623</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5624</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                             </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">5</span><span style="color:#333333;">))</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5624</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5625</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5625</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5626</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                tm.</span><span style="color:#0086b3;">get_data_path</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;legacy_hdf/datetimetz_object.h5&apos;</span><span style="color:#333333;">),</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5626</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5627</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">mode</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;r&apos;</span><span style="color:#333333;">) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5627</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5628</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store[</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">]</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5628</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5629</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, expected)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5629</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5630</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5630</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5631</span><span style="color:#0000ee;">│</span><span style="color:#333333;">    </span><span style="color:#a71d5d;">def</span><span style="color:#333333;"> </span><span style="color:#795da3;">test_dst_transitions</span><span style="color:#333333;">(</span><span style="color:#0086b3;">self</span><span style="color:#333333;">):</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5631</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5632</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#969896;"># make sure we are not failing on transaitions</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5632</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5633</span><span style="color:#0000ee;">│</span><span style="color:#333333;">        </span><span style="color:#a71d5d;">with</span><span style="color:#333333;"> </span><span style="color:#0086b3;">ensure_clean_store</span><span style="color:#333333;">(</span><span style="color:#df5000;">self</span><span style="color:#333333;">.path) </span><span style="color:#a71d5d;">as</span><span style="color:#333333;"> store:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5633</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5634</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            times </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">date_range</span><span style="color:#333333;">(</span><span style="color:#183691;">&quot;2013-10-26 23:00&quot;</span><span style="color:#333333;">, </span><span style="color:#183691;">&quot;2013-10-27 01:00&quot;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5634</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5635</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">tz</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;Europe/London&quot;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5635</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5636</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">freq</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&quot;H&quot;</span><span style="color:#333333;">,</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5636</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5637</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                                  </span><span style="color:#0086b3;">ambiguous</span><span style="color:#a71d5d;">=</span><span style="color:#183691;">&apos;infer&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5637</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5638</span><span style="color:#0000ee;">│</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5638</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5639</span><span style="color:#0000ee;">│</span><span style="color:#333333;">            </span><span style="color:#a71d5d;">for</span><span style="color:#333333;"> i </span><span style="color:#a71d5d;">in</span><span style="color:#333333;"> [times, times </span><span style="color:#a71d5d;">+</span><span style="color:#333333;"> pd.</span><span style="color:#0086b3;">Timedelta</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;10min&apos;</span><span style="color:#333333;">)]:</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5639</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5640</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">_maybe_remove</span><span style="color:#333333;">(store, </span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5640</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5641</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                df </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> </span><span style="color:#0086b3;">DataFrame</span><span style="color:#333333;">({</span><span style="color:#183691;">&apos;A&apos;</span><span style="color:#333333;">: </span><span style="color:#0086b3;">range</span><span style="color:#333333;">(</span><span style="color:#0086b3;">len</span><span style="color:#333333;">(i)), </span><span style="color:#183691;">&apos;B&apos;</span><span style="color:#333333;">: i}, </span><span style="color:#0086b3;">index</span><span style="color:#a71d5d;">=</span><span style="color:#333333;">i)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5641</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5642</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                store.</span><span style="color:#0086b3;">append</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">, df)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5642</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5643</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                result </span><span style="color:#a71d5d;">=</span><span style="color:#333333;"> store.</span><span style="color:#0086b3;">select</span><span style="color:#333333;">(</span><span style="color:#183691;">&apos;df&apos;</span><span style="color:#333333;">)</span>
<span style="color:#0000ee;"></span><span style="color:#444444;">5643</span><span style="color:#0000ee;">⋮</span><span style="color:#444444;">5644</span><span style="color:#0000ee;">│</span><span style="color:#333333;">                </span><span style="color:#0086b3;">assert_frame_equal</span><span style="color:#333333;">(result, df)</span>
</pre>
</body>
</html>
<!--HTML generated by ansifilter 2.20, http://www.andre-simon.de/-->
